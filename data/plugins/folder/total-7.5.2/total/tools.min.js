var bt_tools={table:function(config){var that=this;function ReaderTable(config){this.config=config,this.$load()}return ReaderTable.prototype={style_list:[],event_list:{},checkbox_list:[],batch_active:{},event_rows_model:{},data:[],page:"",column:[],batch_thread:[],random:bt.get_random(5),init:!1,checked:!1,$load:function(){var _that=this;this.config.init&&this.config.init(this),$(this.config.el).addClass("bt_table"),this.config.minWidth&&this.style_list.push({className:this.config.el+" table",css:"min-width:"+this.config.minWidth}),this.config.tootls?this.$reader_tootls(this.config.tootls):0===$(this.config.el+".divtable").length&&$(this.config.el).append('<div class="divtable mtb10" style="heigth:'+(this.config.height||"auto")+'"></div>'),this.$reader_content(),void 0!==this.config.url?this.$refresh_table_list(this.config.load||!1):void 0!==this.config.data?this.$reader_content(this.config.data):alert("缺少data或url参数"),this.config.methods&&$.extend(this,this.config.methods)},$refresh_table_list:function(load,callback){var _that=this,loadT;load&&(loadT=bt_tools.load("获取列表数据")),this.$http((function(data){loadT&&loadT.close(),callback&&callback(data),_that.$reader_content(data.data,void 0!==data.total?parseInt(data.total):data.page)}))},$reader_content:function(data,page){var _that=this,thead="",tbody="",i=0,column=this.config.column,event_list={},checkbox=$(this.config.el+" .checkbox_"+this.random);data=data||[],this.data=data,checkbox.length&&(checkbox.removeClass("active selected"),this.checkbox_list=[],this.$set_batch_view());do{var rows=data[i],completion=0;data.length>0&&(tbody+="<tr>");for(var j=0;j<column.length;j++){var item=column[j];if($.isEmptyObject(item))completion++;else{if(0===i&&!this.init){this.init||this.style_list.push(this.$dynamic_merge_style(item,j-completion));var sortName="sort_"+this.random,checkboxName="checkbox_"+this.random,sortValue=item.sortValue||"desc";thead+="<th><span "+(item.sort?'class="not-select '+sortName+(item.sortValue?" sort-active":"")+' cursor-pointer"':"")+' data-index="'+j+'" '+(item.sort?'data-sort="'+sortValue+'"':"")+">"+("checkbox"==item.type?'<label><i class="cust—checkbox cursor-pointer '+checkboxName+'" data-checkbox="all"></i><input type="checkbox" class="cust—checkbox-input"></label>':"<span>"+item.title+"</span>")+(item.sort?'<span class="glyphicon glyphicon-triangle-'+("desc"==sortValue?"bottom":"top")+' ml5"></span>':"")+"</span></th>",0===i&&(!event_list[sortName]&&item.sort&&(event_list[sortName]={event:this.config.sortEvent,eventType:"click",type:"sort"}),event_list[checkboxName]||(event_list[checkboxName]={event:item.checked,eventType:"click",type:"checkbox"}))}if(void 0!==rows){var template="",className="event_"+item.fid+"_"+this.random;item.template?template=this.$custom_template_render(item,rows,j):(template=this.$reader_column_type(item,rows),event_list=$.extend(event_list,template[1]),template=template[0]),tbody+="<td><span "+(item.class?'class="'+item.class+'"':"")+" "+(item.tips?'title="'+item.tips+'"':"")+">"+template+"</span></td>",0===i&&!event_list[className]&&item.event&&(event_list[className]={event:item.event,eventType:"click",type:"rows"})}}}data.length>0&&(tbody+="</tr>"),0==data.length&&(tbody+='<tr><td colspan="'+column.length+'" style="text-align:center;">'+(this.config.default||"数据为空")+"</td></tr>"),i++}while(i<data.length);this.init||this.$style_bind(this.style_list),this.$event_bind(event_list),this.init?($(this.config.el+" .divtable tbody").html(tbody),this.config.page&&$(this.config.el+" .page").replaceWith(this.$reader_page(this.config.page,page))):$(this.config.el+" .divtable").append('<table class="table table-hover"><thead>'+thead+"</thead><tbody>"+tbody+"</tbody></table></div></div>"),this.init=!0,this.config.success&&this.config.success(this)},$custom_template_render:function(item,rows,j){var className="event_"+item.fid+"_"+this.random,_template=item.template(rows,j),$template=$(_template);return $template.length>0?template=$template.addClass(className)[0].outerHTML:"text"===item.type?template='<span class="'+className+'">'+_template+"</span>":template='<a href="javascript:;" class="btlink '+className+'">'+_template+"</a>",template},$modify_row_data:function(newValue){this.event_rows_model.rows=$.extend(this.event_rows_model.rows,newValue);var row_model=this.event_rows_model,template=null;template=void 0!==row_model.model.template?$(this.$custom_template_render(row_model.model,row_model.rows,row_model.index)):$(this.$reader_column_type(row_model.model,row_model.rows)[0]),"group"==row_model.model.type?$(row_model.el).parent().empty().append(template):row_model.el.replaceWith(template),row_model.el=template},$batch_success_table:function(config){var _that=this,length=$(config.html).length;bt.open({type:1,title:config.title,area:config.area||["350px","350px"],shadeClose:!1,closeBtn:2,content:config.content||'<div class="batch_title"><span class><span class="batch_icon"></span><span class="batch_text">'+config.title+'操作完成！</span></span></div><div class="'+(length>4?"fiexd_thead":"")+' batch_tabel divtable" style="margin: 15px 30px 15px 30px;overflow: auto;height: 200px;"><table class="table table-hover"><thead><tr><th>'+config.th+'</th><th style="text-align:right;width:120px;">操作结果</th></tr></thead><tbody>'+config.html+"</tbody></table></div>",success:function(){length>4&&_that.$fixed_table_thead(".fiexd_thead")}})},$delete_table_row:function(index){this.data.splice(index,1),this.$reader_content(this.data)},$set_batch_view:function(){if(void 0!==this.config.batch){var bt_select_btn=$(this.config.el+" .set_batch_option");if(void 0!==this.config.batch.config)this.checkbox_list.length>0?bt_select_btn.removeClass("bt-disabled btn-default").addClass("btn-success").text("批量"+this.batch_active.title+"(已选中"+this.checkbox_list.length+")"):bt_select_btn.addClass("bt-disabled btn-default").removeClass("btn-success").text("批量"+this.batch_active.title);else{var bt_select_val=$(this.config.el+" .bt_table_select_group .bt_select_value");this.checkbox_list.length>0?(bt_select_btn.removeClass("bt-disabled btn-default").addClass("btn-success").prev().removeClass("bt-disabled"),bt_select_val.find("em").html("(已选中"+this.checkbox_list.length+")")):(bt_select_btn.addClass("bt-disabled btn-default").removeClass("btn-success").prev().addClass("bt-disabled"),bt_select_val.children().eq(0).html("请选择批量操作<em></em>"),bt_select_val.next().find("li").removeClass("active"),this.batch_active={})}}},$reader_column_type:function(item,rows){var value=rows[item.fid],event_list={},className="click_"+item.fid+"_"+this.random,config=[],_that=this;switch(item.type){case"text":config=[value,event_list];break;case"checkbox":config=['<label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'"></i><input type="checkbox" class="cust—checkbox-input"></label>',event_list];break;case"password":var _copy="",_eye_open="",className="ico_"+_that.random+"_",html='<span class="bt-table-password mr10"><i>**********</i></span>';item.eye_open&&(html+='<span class="glyphicon cursor pw-ico glyphicon-eye-open mr10 '+className+'eye_open" title="显示密码"></span>',event_list[className+"eye_open"]||(event_list[className+"eye_open"]={type:"eye_open_password"})),item.copy&&(html+='<span class="ico-copy cursor btcopy mr10 '+className+'copy" title="复制密码"></span>',event_list[className+"copy"]||(event_list[className+"copy"]={type:"copy_password"})),config=[html,event_list];break;case"link":!event_list[className]&&item.event&&(event_list[className]={event:item.event,type:"rows"}),config=['<a class="btlink '+className+'" href="'+(item.href?value:"javascript:;")+'" '+(item.href?'target="'+(item.target||"_blank")+'"':"")+' title="'+value+'">'+value+"</a>",event_list];break;case"input":blurName="blur_"+item.fid+"_"+this.random,keyupName="keyup_"+item.fid+"_"+this.random,!event_list[blurName]&&item.blur&&(event_list[blurName]={event:item.blur,eventType:"blur",type:"rows"}),!event_list[keyupName]&&item.keyup&&(event_list[keyupName]={event:item.keyup,eventType:"keyup",type:"rows"}),config=['<input type="text" title="点击编辑内容，按回车或失去焦点自动保存"  class="table-input '+blurName+" "+keyupName+'" data-value="'+value+'" value="'+value+'" />',event_list];break;case"status":var active="";$.each(item.config.list,(function(index,items){items[0]===value&&(active=items)})),!event_list[className]&&item.event&&(event_list[className]={event:item.event,type:"rows"}),config=['<a class="btlink '+className+" "+(active[2].indexOf("#")>-1?"":active[2])+'" style="'+(active[2].indexOf("#")>-1?"color:"+active[2]+";":"")+'" href="javascript:;"><span>'+active[1]+"</span>"+(item.config.icon?'<span class="glyphicon '+active[3]+'"></span>':"")+"</a>",event_list];break;case"switch":var active="",_random=bt.get_random(5);item.status.on==value&&(active="checked"),!event_list[className]&&item.event&&(event_list[className]={event:item.event,type:"rows"}),config=['<div class="switch_group"><input class="btswitch btswitch-ios '+className+'" id="'+_random+'" type="checkbox" '+active+'><label class="btswitch-btn" for="'+_random+'" data-index="0" bt-event-click="set_site_server_status"></label></div>',event_list];break;case"group":var _html="";$.each(item.group,(function(index,items){className=(item.fid?item.fid:"group")+"_"+index+"_"+_that.random;var _hide=!1;if(items.template){var _template=items.template(rows,_that),$template=$(_template);$template.length>0?_html+=$template.addClass(className)[0].outerHTML:_html+='<a href="javascript:;" class="btlink '+className+'" title="'+(items.title||"")+'">'+_template+"</a>"}else{if(void 0!==items.hide&&"boolean"!=typeof(_hide="boolean"==typeof items.hide?items.hide:items.hide(rows)))return!1;_html+='<a href="javascript:;" class="btlink '+className+'" '+(_hide?'style="display:none;"':"")+' title="'+(items.tips||items.title)+'">'+items.title+"</a>"}_hide||(_html+=item.group.length==index+1?"":"&nbsp;&nbsp;|&nbsp;&nbsp;"),!event_list[className]&&items.event&&(event_list[className]={event:items.event,type:"rows"})})),config=[_html,event_list];break;default:config=[value,event_list]}return config},$batch_success_table:function(config){that.$batch_success_table(config)},$reader_tootls:function(config){var _that=this,event_list={};function request(active,check_list){var loadT=bt.load("正在执行批量"+active.title+"，请稍候..."),batch_config={},list=_that.$get_data_batch_list(active.paramId,check_list);active.beforeRequest?batch_config[active.paramName]=active.beforeRequest(check_list):batch_config[active.paramName]=list.join(","),bt_tools.send({url:active.url||_that.config.batch.url,data:$.extend(active.param||{},batch_config)},(function(res){if(loadT.close(),!1===res.status&&void 0===res.success)return bt_tools.msg(res),!1;if(void 0===active.tips||active.tips){var html="";$.each(res.error,(function(key,item){html+='<tr><td><span class="text-overflow" title="'+key+'">'+key+'</span/></td><td><div style="float:right;" class="size_ellipsis"><span style="color:red">'+item+"</span></div></td></tr>"})),$.each(res.success,(function(index,item){html+='<tr><td><span class="text-overflow" title="'+item+'">'+item+'</span></td><td><div style="float:right;" class="size_ellipsis"><span style="color:#20a53a">操作成功</span></div></td></tr>'})),_that.$batch_success_table({title:"批量"+active.title,th:active.theadName,html:html}),active.refresh&&_that.$refresh_table_list(!0)}else if(!active.success){var html="";$.each(check_list,(function(index,item){html+='<tr><td><span class="text-overflow" title="'+item.name+'">'+item.name+'</span></td><td><div style="float:right;"><span style="color:'+(res.status?"#20a53a":"red")+'">'+((void 0!==active.theadValue?active.theadValue[res.status?0:1]:null)||res.msg)+"</span></div></td></tr>"})),_that.$batch_success_table({title:"批量"+active.title+"完成",th:active.theadName,html:html}),active.refresh&&_that.$refresh_table_list(!0)}active.success&&active.success(res,check_list,_that)}))}function execute_batch(active,check_list,success){var bacth={loadT:0,config:{},check_list:check_list,bacth_status:!0,start_batch:function(param,callback){var _this=this;void 0===param&&(param={}),"function"==typeof param&&(callback=param,param={}),active.load&&(this.loadT=layer.msg("正在执行批量"+active.title+'，<span class="batch_progress">进度:0/'+this.check_list.length+"</span>,请稍候...",{icon:16,skin:"batch_tips",shade:.3,time:0,area:"400px"})),this.config={param:param,url:active.url},this.bacth(callback)},bacth:function(index,callback){var _this=this,param={};if("function"!=typeof index&&void 0!==index||(callback=index,index=0),index<this.check_list.length){if(param="function"==typeof active.param?active.param(check_list[index]):active.param,this.config.param=$.extend(this.config.param,param),void 0!==active.paramId&&(_this.config.param[active.paramName||active.paramId]=_this.check_list[index][active.paramId]),void 0!==active.beforeBacth&&(this.config.param=$.extend(this.config.param,active.beforeBacth(_this.check_list[index]))),this.config.param.bacth&&index==this.check_list.length-1&&delete this.config.param.bacth,console.log(this.config.param),!_this.bacth_status)return!1;active.load&&$("#layui-layer"+_this.loadT).find(".layui-layer-content").html('<i class="layui-layer-ico layui-layer-ico16"></i>正在执行批量'+active.title+'，<span class="batch_progress">进度:'+index+"/"+_this.check_list.length+"</span>，请稍候..."+(active.clear?'<a href="javascript:;" class="btlink clear_batch" style="margin-left:20px;">取消</a>':"")),bt_tools.send({url:this.config.url,data:this.config.param,bacth:!0},(function(res){$.extend(_this.check_list[index],{request:{status:"boolean"==typeof res.status&&res.status,msg:res.msg||"请求网络错误"}}),index++,_this.bacth(index,callback)}))}else{if(success&&success(),callback&&callback(this.check_list),active.automatic){for(var html="",i=0;i<this.check_list.length;i++){var item=this.check_list[i];html+="<tr><td>"+(void 0!==item[active.paramThead]?item[active.paramThead]:item.name)+'</td><td><div style="float:right;"><span style="color:'+(item.request.status?"#20a53a":"red")+'">'+item.request.msg+"</span></div></td></tr>"}_that.$batch_success_table({title:"批量"+active.title,th:active.theadName,html:html}),active.refresh&&_that.$refresh_table_list(!0),_that.$clear_table_checkbox()}layer.close(this.loadT)}},clear_bacth:function(){this.bacth_status=!1,layer.close(this.loadT)}};active.callback?active.callback(bacth):!active.confirm||active.recursion?active.confirmVerify?bt.show_confirm("批量操作"+active.title+"已选中","批量"+active.title+"，该操作可能会存在风险，是否继续？",(function(index){layer.close(index),active.recursion?bacth.start_batch():request(active,check_list)})):bt.confirm({title:"批量"+active.title,msg:"批量"+active.title+"，该操作可能会存在风险，是否继续？"},(function(index){layer.close(index),active.recursion?bacth.start_batch():request(active,check_list)})):request(active,check_list)}for(var i=0;i<config.length;i++){var template="",item=config[i];switch(item.type){case"group":$.each(item.list,(function(index,items){var _btn=item.type+"_"+_that.random+"_"+index,html="";"division"==items.type?template+='<span class="mlr5"></span>':items.group?(template+='<div class="btn-group" style="vertical-align: top;">                                        <button type="button" class="btn btn-default '+_btn+' btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span style="margin-right:2px;">分类管理</span><span class="caret" style="position: relative;top: -1px;"></span></button>                                        <ul class="dropdown-menu"></ul>                                    </div>',item.list&&$.each(item.list,(function(index,items){html+='<li><a href="javascript:;" NaN'+items[item.key]+"</a></li>"})),items.init&&setTimeout((function(){items.init(_btn)}),400)):template+='<button type="button" title="'+(items.tips||items.title)+'" class="btn '+(items.active?"btn-success":"btn-default")+" "+_btn+' btn-sm mr5">'+(items.icon?'<span class="glyphicon glyphicon-'+items.icon+' mr5"></span>':"")+"<span>"+items.title+"</span></button>",event_list[_btn]||(event_list[_btn]={event:items.event,type:"button"})}));break;case"search":this.config.search=item;var _input="search_input_"+this.random,_focus="search_focus_"+this.random,_btn="search_btn_"+this.random;template='<div class="bt_search"><input type="text" class="search_input '+_input+'" style="'+(item.width?"width:"+item.width:"")+'" placeholder="'+(item.placeholder||"")+'"/><span class="glyphicon glyphicon-search '+_btn+'" aria-hidden="true"></span></div>',event_list[_input]||(event_list[_input]={eventType:"keyup",type:"search_input"}),event_list[_focus]||(event_list[_focus]={type:"search_focus",eventType:"focus"}),event_list[_btn]||(event_list[_btn]={type:"search_btn"});break;case"batch":this.config.batch=item;var batch_list=[],_html="",active=item.config;void 0!==item.config?(_that.batch_active=active,$(_that.config.el).on("click",".set_batch_option",(function(e){for(var check_list=[],i=0;i<_that.checkbox_list.length;i++)check_list.push(_that.data[_that.checkbox_list[i]]);if($(this).hasClass("bt-disabled"))return layer.tips(_that.config.batch.disabledTips||"请选择需要批量操作的数据",$(this),{tips:[1,"red"],time:2e3}),!1;switch(typeof active.confirm){case"function":active.confirm(active,(function(param,callback){active.param=$.extend(active.param,param),execute_batch(active,check_list,callback)}));break;case"undefined":execute_batch(active,check_list);break;case"object":var config=active.confirm;bt.open({title:config.title||"批量操作",area:config.area||"350px",btn:config.btn||["确认","取消"],content:config.content,success:function(layero,index){config.success(layero,index,active)},yes:function(index,layero){config.yes(index,layero,(function(param,callback){active.param=$.extend(active.param,param),request(active,check_list)}))}})}}))):($.each(item.selectList,(function(index,items){items.group?($.each(items.group,(function(indexs,itemss){batch_list.push($.extend({},items,itemss)),_html+='<li class="item">'+itemss.title+"</li>"})),delete items.group):(batch_list.push(items),_html+='<li class="item">'+items.title+"</li>")})),$(_that.config.el).on("click",".bt_table_select_group .bt_select_value",(function(e){var _this=this,$parent=$(this).parent(),bt_selects=$parent.find(".bt_selects"),area=$parent.offset(),_win_area=_that.$get_win_area();return $parent.hasClass("bt-disabled")?(layer.tips(_that.config.batch.disabledSelectValue,$parent,{tips:[1,"red"],time:2e3}),!1):($parent.hasClass("active")?$parent.removeClass("active"):$parent.addClass("active"),bt_selects.height()>_win_area[1]-area.top?bt_selects.addClass("top"):bt_selects.removeClass("top"),$(document).one("click",(function(){return $(_that.config.el).find(".bt_table_select_group").removeClass("active"),!1})),!1)})),$(_that.config.el).on("click",".bt_table_select_group .item",(function(e){var _text=$(this).text(),_index=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$(_that.config.el+" .bt_select_tips").html("批量"+_text+"<em>(已选中"+_that.checkbox_list.length+")</em>"),_that.batch_active=batch_list[_index],_that.checked||$(".bt_table_select_group").removeClass("active")})),$(_that.config.el).on("click",".set_batch_option",(function(e){var check_list=[],active=_that.batch_active;if($(this).hasClass("bt-disabled"))return layer.tips(_that.config.batch.disabledSelectValue,$(this),{tips:[1,"red"],time:2e3}),!1;for(var i=0;i<_that.checkbox_list.length;i++)check_list.push(_that.data[_that.checkbox_list[i]]);if("{}"===JSON.stringify(active)){var bt_table_select_group=$(_that.config.el+" .bt_table_select_group");return layer.tips("请选择需要批量操作的类型",bt_table_select_group,{tips:[1,"red"],time:2e3}),bt_table_select_group.css("border","1px solid red"),setTimeout((function(){bt_table_select_group.removeAttr("style")}),2e3),!1}switch(typeof active.confirm){case"function":active.confirm(active,(function(param,callback){active.param=$.extend(active.param,param),execute_batch(active,check_list,callback)}));break;case"undefined":execute_batch(active,check_list);break;case"object":var config=active.confirm;bt.open({title:config.title||"批量操作",area:config.area||"350px",btn:config.btn||["确认","取消"],content:config.content,success:function(layero,index){config.success(layero,index,active)},yes:function(index,layero){config.yes(index,layero,(function(param,callback){active.param=$.extend(active.param,param),request(active,check_list)}))}})}}))),template='<div class="bt_batch"><label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'" data-checkbox="all"></i><input type="checkbox" lass="cust—checkbox-input" /></label>'+(void 0!==item.config?'<button class="btn btn-default btn-sm set_batch_option bt-disabled">批量'+item.config.title+"</button>":'<div class="bt_table_select_group bt-disabled not-select"><span class="bt_select_value"><span class="bt_select_tips">请选择批量操作<em></em></span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_selects ">'+_html+'</ul></div><button class="btn btn-default btn-sm set_batch_option bt-disabled" >'+item.buttonValue+"</button>")+"</div>";break;case"page":this.config.page=item;var pageNumber=bt.get_cookie(this.config.cookiePrefix+"_"+this.config.page.numberParam);this.config.cookiePrefix&&pageNumber&&(this.config.page.number=pageNumber),template=this.$reader_page(this.config.page,'<div><span class="Pcurrent">1</span><span class="Pcount">共0条数据</span></div>')}if(template){var tools_group=$(_that.config.el+" .tootls_"+item.positon[1]);if(tools_group.length){var tools_item;tools_group.find(".pull-"+item.positon[0]).append(template)}else{var tools_group_elment='<div class="tootls_group tootls_'+item.positon[1]+'"><div class="pull-left">'+("left"==item.positon[0]?template:"")+'</div><div class="pull-right">'+("right"==item.positon[0]?template:"")+"</div></div>";"top"===item.positon[1]?($(_that.config.el).append(tools_group_elment),0===$(_that.config.el+" .divtable").length&&$(_that.config.el).append('<div class="divtable mtb10" style="max-height:'+_that.config.height+'px"></div>')):(0===$(_that.config.el+" .divtable").length&&$(_that.config.el).append('<div class="divtable mtb10" style="max-height:'+_that.config.height+'px"></div>'),$(_that.config.el).append(tools_group_elment))}}}this.init||this.$event_bind(event_list)},$clear_table_checkbox:function(){$(this.config.el).find(".bt_table .cust—checkbox").removeClass("selected active")},$get_data_batch_list:function(fid,data){var arry=[];return $.each(data||this.data,(function(index,item){arry.push(item[fid])})),arry},$reader_page:function(config,page){"number"==typeof page&&(page=this.$custom_page(page));var _that=this,$page=$(page),template="",eventList={};if($page.find("a").addClass("page_link_"+this.random),template+=$page.html(),config.numberStatus){var className="page_select_"+this.random,number=bt.get_cookie("page_number");template+='<select class="page_select_number '+className+'">',$.each(config.numberList,(function(index,item){template+='<option value="'+item+'" '+((number||config.number)==item?"selected":"")+">"+item+"条/页</option>"})),template+="</select>",eventList[className]={eventType:"change",type:"page_select"}}if(config.jump){var inputName="page_jump_input_"+this.random,btnName="page_jump_btn_"+this.random;template+='<div class="page_jump_group"><span class="page_jump_title">跳转到</span><input type="number" class="page_jump_input '+inputName+'" value="'+config.page+'" /><span class="page_jump_title">页</span><button type="button" class="page_jump_btn '+btnName+'">确认</button></div>',eventList[inputName]={eventType:"keyup",type:"page_jump_input"},eventList[btnName]={type:"page_jump_btn"}}return eventList["page_link_"+this.random]={type:"cut_page_number"},this.config.page.total=0==$page.length?0:"number"==typeof page?page:parseInt($page.find(".Pcount").html().match(/([0-9]*)/g)[1]),this.$event_bind(eventList),'<div class="page">'+template+"</div>"},$custom_page:function(total,number){void 0===number&&(number=5);var html='<div clas="page">',config=this.config.page,page=Math.ceil(total/config.number);config.page>1&&page>1&&(html+='<a class="Pstart" href="p=1">首页</a><a class="Pstart" href="p='+(config.page-1)+'">上一页</a>');for(var i=1;i<=page;i++)i==config.page?html+='<span class="Pcurrent">'+i+"</span>":html+='<a class="Pnum" href="p='+i+'">'+i+"</a>";return page>1&&config.page<page&&(html+='<a class="Pstart" href="p='+(config.page+1)+'">下一页</a><a class="Pstart" href="p='+page+'">尾页</a>'),html+='<span class="Pcount">共'+total+"条</span></div>"},$dynamic_merge_style:function(column,index){var str="";return $.each(column,(function(key,item){switch(key){case"align":str+="text-align:"+item+";";break;case"width":str+="width:"+("string"==typeof item?item:item+"px")+";";break;case"style":str+=item;break;case"minWidth":str+="min-width:"+("string"==typeof item?item:item+"px")+";";break;case"maxWidth":str+="max-width:"+("string"==typeof item?item:item+"px")+";"}})),{index:index,css:str}},$event_bind:function(eventList){var _that=this;$.each(eventList,(function(key,item){if(_that.event_list[key]&&_that.event_list[key].eventType===item.eventType)return!0;_that.event_list[key]=item,$(_that.config.el).on(item.eventType||"click","."+key,(function(ev){var index=$(this).parents("tr").index(),data1=$(this).data(),arry=[];switch(item.type){case"rows":_that.event_rows_model={el:$(this),model:_that.config.column[$(this).parents("td").index()],rows:_that.data[index],index:index},arry=[_that.event_rows_model.rows,_that.event_rows_model.index,ev,key,_that];break;case"sort":var model=_that.config.column[data1.index];$(this).hasClass("sort-active")&&$(".sort_"+_that.random+" .sort-active").data({sort:"desc"}),$(".sort_"+_that.random).removeClass("sort-active").find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom"),$(this).addClass("sort-active"),"asc"==data1.sort?($(this).data({sort:"desc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom")):($(this).data({sort:"asc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-bottom").addClass("glyphicon-triangle-top")),_that.config.sort=_that.config.sortParam({name:model.fid,sort:data1.sort}),_that.$refresh_table_list(!0);break;case"checkbox":var all=$(_that.config.el+' [data-checkbox="all"]'),checkbox_list=$(_that.config.el+" tbody .checkbox_"+_that.random);null==data1.checkbox?$(this).hasClass("active")?($(this).removeClass("active"),_that.checkbox_list.splice(_that.checkbox_list.indexOf(index),1),_that.checkbox_list.length>0?all.addClass("selected").removeClass("active"):all.removeClass("selected active")):($(this).addClass("active"),_that.checkbox_list.push(index),_that.data.length===_that.checkbox_list.length?all.addClass("active").removeClass("selected"):_that.checkbox_list.length>0&&all.addClass("selected")):_that.checkbox_list.length===_that.data.length?(_that.checkbox_list=[],checkbox_list.removeClass("active selected").next().prop("checked","checked"),all.removeClass("active")):(checkbox_list.each((function(index,item){$(this).hasClass("active")||($(this).addClass("active").next().prop("checked","checked"),_that.checkbox_list.push(index))})),all.removeClass("selected").addClass("active")),_that.$set_batch_view();break;case"button":arry.push(ev,_that);break;case"search_focus":var search_tips=$(_that.config.el+" .bt_search_tips");$(_that.config.el+" .bt_search_tips").length>0&&search_tips.remove();break;case"search_input":if(13==ev.keyCode)return $(_that.config.el+" .search_btn_"+_that.random).click(),!1;break;case"search_btn":var _search=$(_that.config.el+" .search_input"),val=$(_that.config.el+" .search_input").val();val=val.replace(/\s+/g,""),_search.val(val),_that.config.search.value=val,_search.append('<div class="bt_search_tips"><span>'+val+'</span><i class="bt_search_close"></i></div>'),_that.$refresh_table_list(!0);break;case"page_select":var limit=parseInt($(this).val());return bt.set_cookie("page_number",limit),_that.config.page.number=limit,_that.config.page.page=1,_that.$refresh_table_list(!0),!1;case"page_jump_input":return 13==ev.keyCode&&($(_that.config.el+" .page_jump_btn_"+_that.random).click(),$(this).focus()),!1;case"page_jump_btn":var jump_page=parseInt($(_that.config.el+" .page_jump_input_"+_that.random).val()),max_number;jump_page>Math.ceil(_that.config.page.total/_that.config.page.number)&&(jump_page=_that.config.page.page),_that.config.page.page=jump_page,_that.$refresh_table_list(!0);break;case"cut_page_number":var page=parseInt($(this).attr("href").match(/([0-9]*)$/)[0]);return _that.config.page.page=page,_that.$refresh_table_list(!0),!1;case"eye_open_password":return $(this).hasClass("glyphicon-eye-open")?($(this).addClass("glyphicon-eye-close").removeClass("glyphicon-eye-open"),$(this).prev().text(_that.data[index].password)):($(this).addClass("glyphicon-eye-open").removeClass("glyphicon-eye-close"),$(this).prev().html("<i>**********</i>")),!1;case"copy_password":return bt.pub.copy_pass(_that.data[index].password),!1}item.event&&item.event.apply(this,arry)}))}))},$style_bind:function(style_list,status){var str="",_that=this;$.each(style_list,(function(index,item){""!=item.css&&(item.className?str+=item.className+"{"+item.css+"}":str+=_that.config.el+" thead th:nth-child("+(item.index+1)+"),"+_that.config.el+" tbody tr td:nth-child"+(item.span?" span":"")+"("+(item.index+1)+"){"+item.css+"}")})),0==$("#bt_table_"+_that.random).length&&$(_that.config.el).append('<style type="text/css" id="bt_table_'+_that.random+'">'+str+"</style>")},$get_win_area:function(){return[window.innerWidth,window.innerHeight]},$http:function(success){var param={},config=this.config,_page=config.page,_search=config.search,_sort=config.sort||{};_page&&(param[_page.numberParam]=_page.number,param[_page.pageParam]=_page.page,this.config.cookiePrefix&&bt.set_cookie(this.config.cookiePrefix+"_"+_page.numberParam,_page.number)),_search&&(param[_search.searchParam]=_search.value),this.config.beforeRequest&&(config.param=this.config.beforeRequest(config.param)),bt_tools.send({url:config.url,data:$.extend(config.param,param,_sort)},(function(res){if(void 0!==config.dataFilter){var data=config.dataFilter(res);void 0!==data.tootls&&(data.tootls=parseInt(data.tootls)),success&&success(data)}else success&&success({data:res.data,page:res.page})}))}},new ReaderTable(config)},form:function(config){var _that=this;function ReaderForm(config){this.config=config,this.data=config.data||{},this.$load()}return ReaderForm.prototype={element:null,style_list:[],event_list:{},event_type:["click","event","focus","keyup","blur","change"],hide_list:[],form_element:{},form_config:{},random:bt.get_random(5),$load:function(){var that=this;that.el&&this.$reader_content((function(){that.$event_bind()}))},$reader_content:function(callback){var that=this,html="",_content="";return $.each(that.config.form,(function(index,item){html+=that.$reader_content_row(index,item)})),that.element=$('<form class="bt-form" data-form="'+that.random+'">'+html+"</form>"),(_content=$('<div class="'+_that.$verify(that.config.class)+'"></div>')).append(that.element),callback&&callback(),_content[0].outerHTML},$reader_content_row:function(index,data){var that=this,help=data.help,labelWidth=this.config.formLabelWidth||data.formLabelWidth;return'<div class="line'+_that.$verify(data.class)+_that.$verify(data.hide,"hide",!0)+'"'+_that.$verify(data.id,"id")+">"+(data.label?'<span class="tname" '+(labelWidth?'style="width:'+labelWidth+'"':"")+">"+data.label+"</span>":"")+'<div class="'+(data.label?"info-r":"")+_that.$verify(data.line_class)+'"'+_that.$verify(this.$reader_style($.extend(data.style,labelWidth?{"margin-left":labelWidth}:{})),"style")+">"+this.$reader_form_element(data.group,index)+(help?'<div class="c9 mt5 '+_that.$verify(help.class,"class")+'" '+_that.$verify(this.$reader_style(help.style),"style")+">"+help.list.join("</br>")+"</div>":"")+"</div></div>"},$reader_form_element:function(data,index){var that=this,html="";return Array.isArray(data)||(data=[data]),$.each(data,(function(key,item){item.find_index=index,html+=that.$reader_form_find(item),that.form_config[item.name]=item})),html},$reader_form_find:function(item){var that=this,html="",style=that.$reader_style(item.style)+_that.$verify(item.width,"width","style"),attribute=that.$verify_group(item,["name","value","placeholder","disabled","readonly","autofocus","autocomplete","min","max"]),event_group=that.$create_event_config(item),eventName="",index=item.find_index;switch(html+=item.label?'<span class="mr5">'+item.label+"</span>":"",void 0!==item.name&&(that.event_list[item.name]=event_group),html+='<div class="'+(item.dispaly||"inlineBlock")+'">',item.type){case"text":case"checkbox":case"password":case"radio":case"number":var _event="event_"+item.name+"_"+that.random;switch(item.type){case"checkbox":html+='<label class="cursor-pointer form-checkbox-label"><i class="form-checkbox cursor-pointer mr5 '+_event+'_label"></i><input type="checkbox" class="form—checkbox-input mr10 '+_event+'" name="'+item.name+'" /><span class="vertical_middle">'+item.title+"</span></label>",that.event_list[_event+"_label"]={click:{type:"checkbox_icon",config:item}},that.event_list[_event]={input:{type:"checkbox",config:item}};break;default:html+='<input type="'+item.type+'"'+attribute+" "+(item.icon?'id="'+_event+'"':"")+' class="bt-input-'+("select_path"!=item.type?item.type:"text")+" mr10 "+(item.label?"vertical_middle":"")+_that.$verify(item.class,"class")+'"'+_that.$verify(style,"style")+' value="'+(that.data[item.name]||item.value||"")+'"/>'}item.icon&&(html+='<span class="glyphicon '+item.icon.type+" "+item.name+'_icon cursor" '+_that.$verify(that.$reader_style(item.icon.style),"style")+"></span>",void 0!==item.icon.event&&(that.event_list[item.name+"_icon"]={click:{type:"select_path",config:item,event:item.icon.event}}));break;case"textarea":if(html+='<textarea class="bt-input-text"'+_that.$verify(style,"style")+attribute+" >"+(that.data[item.name]||"")+"</textarea>",$.each(["blur","focus","input"],(function(index,items){if(item.tips){var added=null;switch(items){case"blur":added=function(ev,item,element){""===$(this).val()&&$(this).next().show(),layer.close(item.tips.loadT),$(ev.target).data("layer","")};break;case"focus":added=function(ev,item){$(this).next().hide(),item.tips.loadT=layer.tips(tips,$(this),{tips:[1,"#20a53a"],time:0,area:$(this).width()})}}}that.event_list[item.name][items]?that.event_list[item.name][items].added=added:that.event_list[item.name][items]={type:item.type,cust:!1,event:item[items],added:added}})),item.tips){var tips="";tips=void 0===item.tips.list?item.tips.text:item.tips.list.join("</br>"),html+='<div class="placeholder c9 '+item.name+'_tips" '+_that.$verify(that.$reader_style(item.tips.style),"style")+">"+tips+"</div>",that.event_list[item.name+"_tips"]={click:{type:"textarea_tips",config:item}}}break;case"select":html+=that.$reader_select(item,style,attribute,index),that.event_list.custom_select={click:{type:"custom_select",children:".bt_select_value"}},that.event_list.custom_select_item={click:{type:"custom_select_item",children:"li.item"}};break;case"link":eventName="event_"+bt.get_random(6),html+='<a href="'+(item.href||"javascript:;")+'" class="btlink offsetY7'+_that.$verify(item.class,"class")+" "+eventName+'" '+_that.$verify(that.$reader_style(item.style),"style")+">"+item.title+"</a>",that.event_list[eventName]={click:{type:"link_event",event:item.event}};break;case"help":var _html="";$.each(item.list,(function(index,items){_html+="<li>"+items+"</li>"})),html+='<ul class="help-info-text c7'+_that.$verify(item.class)+'"'+_that.$verify(that.$reader_style(item.style),"style")+">"+_html+"</ul>"}return html+="</div>"},$create_event_config:function(item){var config={};return void 0===item.name?{}:($.each(this.event_type,(function(key,items){item[items]&&(config["event"===items?"click":items]={type:item.type,event:item[items],cust:["select","checkbox","radio"].indexOf(item.type)>-1,config:item})})),config)},$reader_style:function(data){var style="";return"string"==typeof data?data:void 0===data?"":($.each(data,(function(key,item){style+=key+":"+item+";"})),style)},$local_refresh:function(name,config){this.element.find("[data-name="+name+"]").replaceWith(this.$reader_form_find(config))},$reader_select:function(item,style,attribute,index){var that=this,list="",option="",active={};if(!Array.isArray(item.list)){var config=item.list;bt_tools.send({url:config.url,data:config.param||{}},(function(res){!1!==res.status?(item.list=item.list.dataFilter?item.list.dataFilter(res):res,that.$replace_render_content(index)):bt.msg(res)}))}return $.each(item.list,(function(key,items){try{active=items.value===item.value?items:item.list[0]}catch(er){}list+='<li class="item'+_that.$verify(items.value===active.value?"active":"")+" "+(items.disabled?"disabled":"")+'">'+items.title+"</li>",option+='<option value="'+items.value+'"'+(items.disabled?"disabled":"")+" "+_that.$verify(items.value===active.value?"selectd":"")+">"+items.title+"</option>"})),!active.title&&Array.isArray(item.list)&&(active=item.list[0]),'<div class="bt_select_updown mr10 '+(item.disabled?"bt-disabled":"")+" "+_that.$verify(item.hide,"hide",!0)+_that.$verify(item.class)+'" '+_that.$verify(style,"style")+' data-name="'+item.name+'"><span class="bt_select_value"><span class="bt_select_content">'+(active.title||"获取数据中...")+'</span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_select_list">'+(list||"")+"</ul><select"+attribute+' class="hide" '+(item.disabled?"disabled":"")+">"+(option||"")+"</select></div>"},$replace_render_content:function(index){var that=this,config=this.config.form[index];$("[data-form="+this.random+"]").find(".line:eq("+index+")").replaceWith(this.$reader_content_row(index,config))},$event_bind:function(eventList,callback){var that=this,_event={};that.element=$("object"==typeof eventList?that.element:"[data-form="+that.random+"]"),void 0===eventList&&(_event=that.event_list),$.each(_event,(function(key,item){if($.isEmptyObject(item))return!0;$.each(item,(function(keys,items){var childNode="";childNode="boolean"==typeof items.cust?"["+(items.cust?"data-":"")+"name="+key+"]":"."+key,function(items,key){if(!1===items.onEvent){switch(items.type){case"input_checked":$(childNode).on("event"!=keys?keys:"click",(function(ev){items.event.apply(this,[ev,that])}))}return!0}that.element.on("event"!=keys?keys:"click",items.children?items.children:childNode,(function(ev){var form=that.$get_form_element(!0),value=that.$get_form_value(),config=that.form_config[key];switch(items.type){case"textarea_tips":$(this).hide().prev().focus();break;case"custom_select":if($(this).parent().hasClass("bt-disabled"))return!1;var select_value=$(this).next();return select_value.hasClass("show")?select_value.removeClass("show"):($(".bt_select_list").removeClass("show"),select_value.addClass("show")),$(document).click((function(){return that.element.find(".bt_select_list").removeClass("show"),$(this).unbind("click"),!1})),!1;case"custom_select_item":if(config=that.form_config[$(this).parents(".bt_select_updown").attr("data-name")],item_config=config.list[$(this).index()],$(this).hasClass("disabled"))return $(this).parent().removeClass("show"),item_config.tips&&layer.msg(item_config.tips,{icon:2}),!0;$(this).hasClass("active")||$(this).hasClass("disabled")||($(this).parent().prev().find(".bt_select_content").text($(this).text()),$(this).addClass("active").siblings().removeClass("active"),$(this).parent().next().val(item_config.value.toString()),$(this).parent().removeClass("show"),$(this).parent().next().trigger("change"));break;case"select_path":bt.select_path("event_"+$(this).prev().attr("name")+"_"+that.random);break;case"checkbox":var checked;$(this).is(":checked")?$(this).prev().addClass("active"):$(this).prev().removeClass("active")}items.event&&items.event.apply(this,[value,form,that,config,ev]),items.added&&items.added.apply(this,[ev,config,form])}))}(items,key)}))})),callback&&callback()},$get_form_value:function(){return this.element.serializeObject()},$set_find_value:function(name,value){var config={},that=this;"string"!=typeof name?config=name:config[name]=value,$.each(config,(function(key,item){that.form_element[key].val(item)}))},$get_form_element:function(afresh){var form={},that=this;return afresh||$.isEmptyObject(this.form_element)?(this.element.find(":input").each((function(index){form[$(this).attr("name")]=$(this)})),this.form_element=form,form):this.form_element},$verify_group:function(config,group){var that=this,str="";return $.each(group,(function(index,item){if(void 0===config[item])return!0;["disabled","readonly"].indexOf(item)>-1?str+=" "+(config[item]?item+'="'+item+'"':""):str+=" "+item+'="'+config[item]+'"'})),str},$verify_bind_event:function(eventName,row,group){var event_list={};return $.each(group,(function(index,items){var event_fun=row[items];event_fun&&("object"==typeof event_list[eventName]?(Array.isArray(event_list[eventName])||(event_list[eventName]=[event_list[eventName]]),event_list[eventName].push({event:event_fun,eventType:items})):event_list[eventName]={event:event_fun,eventType:items})})),event_list},$verify:function(value,attr,type){return value?!0===type?value?" "+attr:"":"style"===type?attr?attr+":"+value+";":value:attr?" "+attr+'="'+value+'"':" "+value:""},$verify_form:function(){for(var form_list={},form=this.config.form,form_value=this.$get_form_value(),form_element=this.$get_form_element(!0),key=0;key<form.length;key++){var item=form[key];Array.isArray(item.group)||(item.group=[item.group]);for(var i=0;i<item.group.length;i++){var items=item.group[i],name=items.name;if("help"!==items.type)if(void 0!==items.verify){var value=items.verify(form_value[name],form_element[name],items,!0);if(!1===value&&!1!==form_value[name])return!1;form_list[name]=value}else form_list[name]=form_value[name]}}return form_list},$submit:function(param,callback,tips){var form=this.$verify_form();return"function"==typeof param&&(tips=callback,callback=param,param={}),!!form&&(form=$.extend(form,param),void 0===this.config.url?(bt_tools.msg("请求提交地址不能为空！",!1),!1):void bt_tools.send({url:this.config.url,data:form},(function(res){callback?callback(res,form):bt_tools.msg(res)}),tips||"提交中"))}},new ReaderForm(config)},tab:function(config){var _that=this;function ReaderTab(config){this.config=config,this.theme=this.config.theme||{},this.$load()}return ReaderTab.prototype={type:1,theme_list:[{content:"tab-body",nav:"tab-nav",body:"tab-con",active:"on"},{content:"bt-w-body",nav:"bt-w-menu",body:"bt-w-con"}],random:bt.get_random(5),$init:function(){var that=this,active=this.config.active,config=this.config.list;this.$event_bind(),config[this.active].success&&config[this.active].success(),config[this.active].init=!0},$load:function(){var that=this},$reader_content:function(){var that=this,_list=that.config.list,_tab="",_tab_con="",_theme=that.theme,config=that.config;return void 0===that.active&&(that.active=0),$.isEmptyObject(config.theme)||(_theme=this.theme_list[that.active],$.each(config.theme,(function(key,item){_theme[key]&&(_theme[key]+=" "+item)})),that.theme=_theme),config.type&&$.isEmptyObject(config.theme)&&(this.theme=this.theme_list[that.active]),$.each(_list,(function(index,item){var active=that.active===index,_active=_theme.active||"active";_tab+='<span class="'+(active?_active:"")+'">'+item.title+"</span>",_tab_con+='<div class="tab-block '+(active?_active:"")+'">'+(active?item.content:"")+"</div>"})),that.element=$('<div id="tab_'+that.random+'" class="'+_theme.content+_that.$verify(that.config.class)+'"><div class="'+_theme.nav+'" >'+_tab+'</div><div class="'+_theme.body+'">'+_tab_con+"</div></div>"),that.element[0].outerHTML},$event_bind:function(){var that=this,_theme=that.theme,active=_theme.active||"active";that.el||(that.element=$("#tab_"+that.random)),that.element.on("click","."+_theme.nav.replace(/\s+/g,".")+" span",(function(){var index=$(this).index(),config=that.config.list[index];$(this).addClass(active).siblings().removeClass(active),$("."+_theme.body+">div:eq("+index+")").addClass(active).siblings().removeClass(active),that.active=index,config.init||($("."+_theme.body+">div:eq("+index+")").html(config.content),config.success&&config.success(),config.init=!0)}))}},new ReaderTab(config)},load:function(title){var random=bt.get_random(5),layel=$('<div class="layui-layer layui-layer-dialog layui-layer-msg layer-anim" id="'+random+'" type="dialog" style="z-index: 99891031;"><div class="layui-layer-content layui-layer-padding"><i class="layui-layer-ico layui-layer-ico16"></i>正在'+title+'，请稍候...</div><span class="layui-layer-setwin"></span></div><div class="layui-layer-shade" id="layer-mask-'+random+'" times="17" style="z-index:99891000; background-color:#000; opacity:0.3; filter:alpha(opacity=30);"></div>'),mask="",loadT="";$("body").append(layel);var win=$(window),msak=$(".layer-loading-mask"),layel;return(layel=$("#"+random)).css({top:(win.height()-64)/2,left:(win.width()-320)/2}),!0===title&&(loadT=layer.load()),{close:function(){"number"==typeof loadT?layer.close(loadT):$("body").find("#"+random+",#layer-mask-"+random).remove()}}},open:function(config){var _config={},layerT=null,form=null;if("object"==typeof(_config=$.extend({type:1,area:"640px",closeBtn:2,btn:["确认","取消"]},config)).content){var param=_config.content;form=bt_tools.form(param),_config.success=function(layero,indexs){form.$event_bind(),void 0!==_config.success&&void 0!==param.success&&param.success(layero,indexs)},_config.yes=function(indexs,layero){var form_val=form.$verify_form(),yes;if(!form_val)return!1;if(void 0!==config.yes&&!config.yes.apply(form,[form_val,indexs,layero]))return!1},_config.content=form.$reader_content()}return layerT=layer.open(_config),{close:function(){layer.close(layerT)},form:form}},msg:function(param1,param2){var layerT=null,msg="",config={};return"object"==typeof param1&&"boolean"==typeof param1.status&&(msg=param1.msg,config={icon:param1.status?1:2},param1.status||(config=$.extend(config,{time:0,closeBtn:2}))),"string"==typeof param1&&(msg=param1,config={icon:void 0!==param2?param2:1}),layerT=layer.msg(msg,config),{close:function(){layer.close(layerT)}}},send:function(param1,param2,param3,param4,param5,param6){var params={},success=null,error=null,config=[],param_one="";function diff_data(i){try{success="function"==config[i][1]?config[i][0]:null,error="function"==config[i+1][1]?config[i+1][0]:null}catch(error){}}switch($.each(arguments,(function(index,items){config.push([items,typeof items])})),(param_one=config[0])[1]){case"string":$.each(config,(function(index,items){var value=items[0],type=items[1];if(index>1&&("boolean"==type||"string"==type||"object"==type)){var arry=param_one[0].split("/");return params.url="/"+arry[0]+"?action="+arry[1],"object"==type?(params.load=value.load,params.verify=value.verify,value.plugin&&(params.url="/plugin?action=a&name="+arry[0]+"&s="+arry[1])):"string"==type&&(params.load=value),!1}params.url=param_one[0]})),"object"===config[1][1]?(params.data=config[1][0],diff_data(2)):diff_data(1);break;case"object":params.url=param_one[0].url,params.data=param_one[0].data||{},$.each(config,(function(index,items){var value=items[0],type=items[1];if(index>1&&("boolean"==type||"string"==type||"object"==type))return"object"==type?(params.load=value.load,params.verify=value.verify):"string"==type&&(params.load=value),!0})),"object"===config[1][1]?(params.data=config[1][0],diff_data(2)):diff_data(1)}params.load&&(params.load=this.load(params.load)),$.ajax({type:params.type||"POST",url:params.url,data:params.data||{},dataType:params.dataType||"JSON",complete:function(){params.load&&params.load.close()},success:function(res){return params.verify?"string"==typeof res?(layer.msg(res,{icon:2,time:0,closeBtn:2}),!1):params.batch?(success&&success(res),!1):!1===res.status?(bt_tools.msg(res),!1):(params.tips&&bt_tools.msg(res),void(success&&success(res))):(success&&success(res),!1)},error:function(er){error&&error(er),layer.closeAll("dialog"),layer.closeAll("loading"),layer.msg("服务响应状态码："+(0==er.status?"--":er.status)+"</br>错误信息："+er.statusText+"</br>接口信息："+params.url+"</br>接口参数："+JSON.stringify(params.data),{icon:2,time:0,closeBtn:2})}})},$clear_verify_tips:function(element){element.removeClass("bt-border-error bt-border-sucess"),layer.close("tips")},$verify_tips:function(element,tips,is_error){void 0===is_error&&(is_error=!0),element.removeClass("bt-border-error bt-border-sucess").addClass(is_error?"bt-border-error":"bt-border-sucess"),element.focus(),layer.tips('<span class="inlineBlock">'+tips+"</span>",element,{tips:[1,is_error?"red":"#20a53a"],time:3e3,area:element.width()})},$verify:function(value,attr,type){return value?!0===type?value?" "+attr:"":"style"===type?attr?attr+":"+value+";":value:attr?" "+attr+'="'+value+'"':" "+value:""},$batch_success_table:function(config){var _that=this,length=$(config.html).length;bt.open({type:1,title:config.title,area:config.area||["350px","350px"],shadeClose:!1,closeBtn:2,content:config.content||'<div class="batch_title"><span class><span class="batch_icon"></span><span class="batch_text">'+config.title+'操作完成！</span></span></div><div class="'+(length>4?"fiexd_thead":"")+' batch_tabel divtable" style="margin: 15px 30px 15px 30px;overflow: auto;height: 200px;"><table class="table table-hover"><thead><tr><th>'+config.th+'</th><th style="text-align:right;width:120px;">操作结果</th></tr></thead><tbody>'+config.html+"</tbody></table></div>",success:function(){length>4&&_that.$fixed_table_thead(".fiexd_thead")}})},$fixed_table_thead:function(el){$(el).scroll((function(){var scrollTop=this.scrollTop;this.querySelector("thead").style.transform="translateY("+scrollTop+"px)"}))},$piugin_view_set:function(layid,config){var element=$("string"==typeof layid?"#layui-layer"+layid:layid).hide(),win=$(window);setTimeout((function(){var width=config.width||element.width(),height=config.height||element.height();element.css($.extend(config,{left:(win.width()-width)/2,top:(win.height()-height)/2})).addClass("custom_layer")}),50),setTimeout((function(){element.show()}),500)}};$.fn.serializeObject=function(){var hasOwnProperty=Object.prototype.hasOwnProperty;return this.serializeArray().reduce((function(data,pair){return hasOwnProperty.call(data,pair.name)||(data[pair.name]=pair.value),data}),{})};