<style>
	.bt-w-menu p a {
		text-decoration: none;
	}

	.bt-w-con .serverSide,
	.bt-w-con .clientSide,
	.bt-w-con .logsSide {
		margin: 0 20px;
	}

	.serverSide .header,
	.clientSide .header {
		padding-top: 20px;
		overflow: hidden;
	}

	.serverSide .header .switch span {
		font-size: 14px;
	}

	.ssh-item {
		display: inline-block;
		height: 20px;
		line-height: 32px;
		float: none;
		margin: 0 10px;
	}

	.serverSide .header .pull-right button {
		margin-right: 10px;
	}

	.serverSide .conter,
	.clientSide .conter {
		margin-top: 20px;
	}

	.serverSide .divtable,
	.clientSide .divtable {
		height: 418px;
		overflow-y: auto;
	}

	.psShow {
		cursor: pointer;
	}

	.pullDown {
		position: relative;
		padding: 5px 0;
	}

	.pullDown:hover ul {
		display: block !important;
	}

	.pullDown ul {
		position: absolute;
		right: -7px;
		top: 27px;
		z-index: 999;
		width: 45px;
		text-align: center;
		background: #fff;
		border: 1px solid #ececec;
	}

	.pullDown ul li {
		padding: 4px 0;
	}

	.pullDown ul:after {
		content: '';
		width: 10px;
		height: 10px;
		position: absolute;
		top: -6px;
		left: 19px;
		background: #fff;
		transform: rotate(45deg);
		border-top: 1px solid #ececec;
		border-left: 1px solid #ececec;
	}

	.wafConf {
		overflow: hidden;
		margin: 15px 0;
	}

	.wafConf fieldset {
		border: 1px solid #ccc;
		border-radius: 3px;
		float: left;
		padding-bottom: 0;
		width: 370px;
		margin-left: 15px;
	}

	.wafConf fieldset:nth-of-type(2) {
		margin: 0px;
		margin-left: 15px;
	}

	.wafConf legend {
		border: 0 none;
		font-size: 14px;
		margin: 0 6px;
		padding: 3px;
		width: auto
	}

	.wafConf fieldset input {
		margin-left: 4px
	}

	.wafConf fieldset .table {
		margin-top: -1px;
		margin-bottom: 0
	}

	.wafConf fieldset .table tr td:nth-of-type(2) {
		width: 42px
	}

	.wafConf fieldset .table-overflow {
		overflow: auto;
		margin-top: 10px;
		border-top: #ddd 1px solid
	}
	.table-overflow{
		height:260px;
		overflow-y: auto;
	}

	.wafConf-btn {
		border-bottom: #ddd 1px solid;
		margin-bottom: 12px;
		padding-bottom: 15px;
		height: 45px
	}

	.wafConf-btn span {
		float: left;
		margin-right: 8px;
		line-height: 33px
	}

	.wafConf-btn .btn {
		margin-right: 10px
	}

	.wafConf-btn .ssh-item {
		margin-right: 50px
	}

	.wafConf .table>tbody>tr:last-child {
		border-bottom: #ddd 1px solid;
	}

	.help-info-text li {
		list-style-type: decimal;
	}

	.bt-monitor .line {
		/*overflow: ;*/
		height: 44px;
	}

	.plan_hms {
		height: 32px;
	}

	.plan_hms span {
		height: 30px;
		line-height: 30px;
	}
	select:hover,input:hover,textarea:hover{
		border-color: #ccc;
	}
	input,textarea,select{
		outline:none
	}
	.plan_hms input {
		height: 30px;
	}
	.plan_hms span input {
		height: 30px;
		outline: none;
	}
	code {
		padding: 1px 5px;
		font-size: 90%;
		color: #2196F3;
		background-color: #EEE;
		border-radius: 4px;
		margin: 2px;
	}

	.demo-class .line {
		padding-left: 35px;
	}

	.global-class .line {
		padding: 9px 0;
	}
	
	.clientSide .pull-left .btn {
		margin-right: 5px;
	}

	.help-info-text {
		margin-left: 10px;
	}

	.rsync_set_ip {
		width: 250px;
		display: inline-block;
	}

	.rsync_tip {
		display: inline-block;
		width: 200px;
		height: 100px;
		vertical-align: top;
		line-height: 25px;
		padding-left: 10px;
		padding-top: 8px;
	}

	.tsynsList .overFlowStyle {
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		display: inline-block;
	}

	.clientSide .btswitch+.btswitch-btn {
		width: 2.4em;
		height: 1.4em;
		margin-bottom: 0;
	}

	.tsynsList .size_ellipsis {
		display: inline-block;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	/* 高级配置按钮样式 */
	#fromServerPath .form-check-lable {
		cursor: pointer;
		display: inline-block;
	}

	#fromServerPath .form-check-lable i,
	.form-check-lable-receive i {
		display: inline-block;
		width: 16px;
		height: 16px;
		border: 1px solid #ccc;
		background-color: #fff;
		vertical-align: top;
		border-radius: 1px;
		position: relative;
		border-radius: 2px;
		margin-right: 3px;
	}

	#fromServerPath .form-check-lable i.active::after {
		content: '';
		position: absolute;
		display: block;
		left: 50%;
		top: 50%;
		margin-left: -2.5px;
		margin-top: -6px;
		width: 5px;
		height: 10px;
		border: solid #fff;
		border-width: 0 2px 2px 0;
		transform: rotate(45deg);
	}

	.form-check-lable-receive i.active::after {
		content: '';
		position: absolute;
		display: block;
		left: 50%;
		top: 50%;
		margin-left: -2.5px;
		margin-top: -6px;
		width: 5px;
		height: 10px;
		border: solid #fff;
		border-width: 0 2px 2px 0;
		transform: rotate(45deg);
	}

	#fromServerPath .form-check-lable i.active,
	.form-check-lable-receive i.active {
		background-color: #20a53a;
		border-color: #20a53a;
	}

	#fromServerPath .form-check-lable span {
		font-weight: initial;
	}

	/* 高级配置按钮样式 end*/

	/* 二次验证 */
	.sync-direction-box {
		padding: 42px 50px;
	}

	.sync-direction-box .sync-info {
		display: flex;
		align-items: center;
	}

	.sync-direction-box .sync-info .info-icon {
		margin: 0 36px;
	}

	.sync-info .info-icon .icon {
		width: 58px;
		height: 38px;
		margin: 0 auto;
		background-size: cover;
		background-repeat: no-repeat;
		background-position: center;
	}

	.sync-info .info-icon .icon_waring {
		width: 18px;
		height: 18px;
		margin: 0 auto;
		background-size: cover;
		background-repeat: no-repeat;
		background-position: center;
	}

	.sync-info .info-icon .name {
		margin-top: 8px;
		font-size: 14px;
	}

	.sync-info .info-icon.error .name,
	.sync-info .info-icon.success .name {
		color: #ff0000;
		display: flex;
		align-items: center;
	}

	.sync-info .info-icon.error .icon {
		background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOgAAACQCAYAAAAC2CfUAAAABHNCSVQICAgIfAhkiAAABppJREFUeJzt3V1y2zgQhdFLOauwKmuJvDJJK7O8FhW9i4jzIHLGo+IPSKKBBvmdqlTNwzhmEl81AAINCQAAAAAAAAAAAAAAAACwY3fplPsZALyopcu39FlLTfvrkvuZAOgZzh/BfP11yf18+L8q9wMgrVpqAv6365GwunDI/QBIZ0aFPFNRfSCgGHNu56qX3A+yV79yPwB8a54rvadaEsPe9KigCMWwNwMCirkIakIEFEsR1ASYg2Ktc93+B3PU+AgoYjhLEgtJ8THERUwMeyMjoLBAUCMhoLBEUFdiDooUWEhaiIAiFRaSFmCIi9QY9s5AQJELQQ1AQJEbQR3BHBResJDUg4DCExaSXjDEhUcMe1sEFJ7tPqgEFCXYbVCZg6Iku1tIIqAoza4WkhjiolS7GPYSUJRu00EloNiKTQaVOSi25lxLeki339It98OsRQXFFp0PG+mIT0CxZcUPewko9qDYoBLQHamkP7mfIbPigsoi0U7U0qXhyvtOMQtJsy/wvfOPXJw36Uw4B7m+rDgooHfpxD8yNs5lUCcDepdOB+kzxcMADrgK6uQi0YGqiX1xdav4ZAWtpSbFgwAOZa+mBBSYli2oBBQIlzyoBBSYL1lQCSiwQCXdGunLOqgEFFjHtJoSUCAOk6ASUCCuqEEloICNKEHlNAtgI0oPXwIK2Fndw5chLpBAJd3epY+5X0dHBSCBRjotOUtNQIFE3toh7xwEFEikkb7mfg0BBRwjoEAai96LElBsSvXs0nfN/RwvFm9a4DULNuEhffS10Gxbl8xenImhkm5/peua1p5sVEDxhsIpPTcItDt6koU0RjB//F7jqKDwbCycP31Ln9ZtY2MGs8McFCULDsNf+3np9T3ww2KOyQqa4pMHWOI482YEo/mo6YFtKihKNbsiRj6neXtIH9lbnkjMQ+HP3OrZWXtTgsU8c0xQBW3/Mry9W8J+Df4s3qXTWFf439KtWhCurmJazDMnvi+2rK0YJ2V6F2igd87XVxmHjngtqKJ+G1djG7ZyCVbf0Hbiz9YbrsDFz+xXP7BItBNLh3bO9A5tJz54zn3nMN+lj6G/j1QLQCEI6I4sOe7kSV9gQm4hGzqH2Q5//w19rnnmGAKKUgwtDE3OrZuRhaOjdDlK1VGqPAWzQ0BRgt654Mw7PItcJCOgKNms0Hm5lHcOAgrvYlTPTu+CkWcEFK6NrKQuGrIuadyVEwGFZ70LQ2uGqkvbX+ZCQOFW7OrZKamKElB4Fb16dkqqogQUHo0tDEWpfqVUUQIKdx4JNguUUkUJKLzpPWtp0Q2hhCpKQOGK1cJQnxKqKG034cnqhaHHj/OfIedg25Mwbo9dElC4saZ6DhzOvoX0xK2fG+aHvndWDHHhxarqOXSU7ihdAs7Bup2LElB4MNa5ICg8YxUwpCeu1430BBTZDYUrcWhcbqQnoMhtrLolHXp6fO1CQJFViup5CKyMHl+7EFBk8+hpiSk9u/RpZjWLFSxvVZSAIouxW8lCK54Fb1WUgCK161GqhsKZ88LdjqcqSkCRhKdes1M8VVECClNzes1aVc9K+jP3a7xUUQIKEwubQLsIhTTeSzclAgoLs2+bXhsGo4Wl7B8YBBQxXdsu7ZcFX5s9DH1yV1ECitXWLgBZhyDgFrMxWT84CCgWi3jZ0OoQLFkICvWd8dpGAorZYt4ClnsIGSLnaxcCirlmLwBNcDn3fJXrtQsBRag1C0C9SqienVxVlIBilNUOoFRb+mKGKkcVJaA7MqffrMfbpnPLUUUJ6I6EBC1FMC2q59CrlNgbGFJXUQK6P2MdDGIvAA0x+SHvm9PGfv2SuorSdnNnjtKl1vMHt5FOlXRrpK9Up0yMF4bOtf4byr9J55WbFHq1VfQW+/ft47ZhL7aplprczxDJWCfCaBjiIpmSXqsESDIXJaBIqYhNCaFSfOAQUCSxserZMe+lyxwUSaSae3adAn+8XjGt2gN3wkTDKi7MpaqeL50Cb+33lgxD2r12sXo1RQWFuUTVc3BV9Vv6tHjd0rGsosxBYSpV9Vx7edIalpsXCCjMpNoQH3C9oDmrLYAEFMWbGr6m6FRvVUUJKEyk7hDvodG0RRVlkQgmUm/pG1qoSf1BMXbnzBIEFNHdpdMhX6Otq/Vm+TGxV3QJKKLzcAFSTseIuWIOiugsW2CWIOZ8mAqK6DIPcbOjggJ+Rd0UQQWFiT3OQy22/BFQmPmxzW/TQe12MlmeagEAAAAAAAAAAACArfgHOMsZZcksMlYAAAAASUVORK5CYII=');
	}

	.sync-info .info-icon.error .icon_waring {
		background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAABHNCSVQICAgIfAhkiAAAAOJJREFUOI3NU0ESgjAQy3Y8WF5jeUF9GfCy4gfE16inxoMghW4VT5ob2900zQbg3yClAx72HiLN+Okh0gGAnK+t1m80AjobYIwH2clwO8pwE8TYAwCdJetKJZtJ6qqls4GHvV8QrwbXPTmRs1Rqgc4GVbX2NNZVO/nwCXK59xA5paqWHo0+5JNyymox9skyEiKykctdJyqpSpAq2q5mhteI8HYTK4w5e3m6m0/YwRifKYuxV5/87C3couRDW/9Yz6KykKsOrQPqbNiabrKuWi3hpVSXf9rpRrLB5BvZfROR3+IB8JF6H58ooLsAAAAASUVORK5CYII=');
	}

	.sync-info .info-icon.success .name {
		color: #20a53a;
	}

	.sync-info .info-icon.success .icon {
		background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAAiCAYAAAAOPsreAAAABHNCSVQICAgIfAhkiAAAAUtJREFUWIXtmd9tgzAQh89OB/EaQZECa6TqLMazRGQN/FA1a7BI7T4016LUQA02+Cy+J/6F86f7yRcJgJ2doIjrqVyjDl+jyBCiKWrgphW3YxtbeFPRHywrgZtWNEUdq0Qaor9I0RQ2hnBqoogMLZuqKEDg7qYsigQRpiCKLIozJVGABd2lJopIcTt6jSOqot+z1yPODA/E9VQCN2WcVQ1Vt+fHgkOgutePerAUHoimsIEKbokCw3X39q6fb9CNrhs59FcyN1FEPic0V1EAZnX/NFdR1V3uVf9CXqLMajC8cu2+LxssJw6GV67dFumLqvir+YMM8I7R+YmwqQdi8hgD82SZ1fB5UGNd7EM1uqq73GufH9DajEY2mylodNQzpi4oiHrH1EW60V0QUxdpdnRiJs4hNdF/zcQ5bBtdwzUABI9pkqz1kWknN74AU6d89OY7sLIAAAAASUVORK5CYII=');
	}


	.sync-info .info-icon.success .icon_waring {
		background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAABHNCSVQICAgIfAhkiAAAAQhJREFUOI3Nk1HOgjAQhL+W/yC9hsZEvIbGs0DPYvQalMToNbgIrQ8tpUD7x0f3CZbpMDs7hV8rUfqgboeaamwAcKIGNMBwebVfEUUCJ3qsNMP1aWJf2hpoAF0i9CT3faseu07dDvV/Y+QwfytMM5zfxXFjjZUOY5upJVM1BB+KSoKK4fo0ONGnquQCaaWhUOq+b5G2Cz/02GkZK6BLD8UD87tLe+C9mp5nj4Sb1VhpkLZTj90RJ3pKm/Kx2I628MDKUwBmSQI2ejoTjZUOOWEiGy4vgZWnbGYS7Ka+yVDEJp7COkeZfGwIYvKXUdleEb+ZBtDZKyLckbHSU79ItCIEaOJGMwS/Wx+SsouFOtVwfgAAAABJRU5ErkJggg==');
	}

	.sync-direction-box .sync-info .info-box {
		flex: 1;
	}

	.sync-info .info-box {
		border: 1px solid #ECECEC;
		border-radius: 5px;
	}

	.info-box .info-tit {
		padding: 14px 0;
		background: rgb(239, 239, 239);
		color: #6B6B6B;
		font-size: 14px;
		text-align: center;
	}

	.info-box .info-body {
		padding: 20px 24px;
	}

	.info-body .head {
		display: flex;
		align-items: center;
		padding-bottom: 18px;
		border-bottom: 1px solid #ECECEC;
	}

	.info-body .head .icon {
		width: 38px;
		height: 38px;
		background-size: cover;
		background-repeat: no-repeat;
		background-position: center;
	}

	.info-body .head .info {
		flex: 1;
		width: 0;
		padding-left: 10px;
	}

	.info-body .info p {
		text-overflow: ellipsis;
		overflow: hidden;
		width: 126px;
		white-space: nowrap;
	}

	.info-body .info p+p {
		margin-top: 6px;
	}

	.info-body .status {
		display: flex;
		align-items: center;
		justify-content: center;
		padding-top: 18px;
	}

	.info-body .status .success {
		color: #20a53a;
	}

	.info-body .status .error {
		color: #ff0000;
		line-height: 18px;
	}

	.info-body .status .warning {
		color: rgb(255, 142, 18);
		line-height: 18px;
	}

	.send-info .head .icon {
		background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzguMDAwMDAwIiBoZWlnaHQ9IjM2LjAwMDAwMCIgdmlld0JveD0iMCAwIDM4IDM2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8cGF0aCBpZD0i5ZCI5bm2IiBkPSJNMiAzLjYyOTVMMiA5LjgyMTYyTDMzLjI4IDkuODIxNjJMMzMuMjggNy41NDAzMUMzMy4yNzk4IDcuMzI0MyAzMy4yMzY0IDcuMTE2NTQgMzMuMTUgNi45MTcwMUMzMy4wNjM3IDYuNzE3NDkgMzIuOTQwOCA2LjU0MTM2IDMyLjc4MTUgNi4zODg2MkMzMi42MjIxIDYuMjM1ODcgMzIuNDM4NSA2LjExODEyIDMyLjIzMDMgNi4wMzUzNUMzMi4wMjIyIDUuOTUyNTcgMzEuODA1NCA1LjkxMTA1IDMxLjU4IDUuOTEwODFMMTguMDYyNSA1LjkxMDgxQzE3Ljk2ODUgNS45MTEwOSAxNy44ODg0IDUuODc5MjYgMTcuODIyMSA1LjgxNTI5TDE0LjMzOTYgMi40NzcyNUMxNC4wMDgyIDIuMTU3ODUgMTMuNjA3NSAxLjk5ODc2IDEzLjEzNzUgMS45OTk5OUwzLjcwMDAxIDEuOTk5OTlDMy40NzQ2NyAyLjAwMDI0IDMuMjU3ODcgMi4wNDE3NiAzLjA0OTc0IDIuMTI0NTNDMi44NDE1NSAyLjIwNzMxIDIuNjU3OSAyLjMyNTA2IDIuNDk4NTQgMi40Nzc4MUMyLjMzOTIzIDIuNjMwNTUgMi4yMTYzNyAyLjgwNjY4IDIuMTMgMy4wMDYyQzIuMDQzNjQgMy4yMDU3MiAyLjAwMDI0IDMuNDEzNDkgMiAzLjYyOTVaTTIgMTMuNTkxM0wyIDExLjEyNTRMMzMuMjggMTEuMTI1NEwzMy4yOCAxMi45MTkzQzMzLjI4MDUgMTIuOTQ4IDMzLjI4MDMgMTIuOTgwMiAzMy4yODAyIDEzLjAxNjZDMzMuMjgwMSAxMy4wMzE3IDMzLjI4IDEzLjA0NzUgMzMuMjggMTMuMDY0MUwzMy4yOCAxNi4wMTM5TDMzLjI4IDE2LjAxOTNMMzMuMjggMjEuMjI4M0MzMi42IDIxLjIyODMgMzIuMjYgMjEuMDMwNSAzMS41OTcyIDIwLjY4NjVDMzEuMDA4MSAyMC4yMjc5IDMwLjQ2ODkgMTkuODM4IDI5Ljk3OTggMTkuNTE3QzI5LjQ5MDcgMTkuMTczIDI5LjA2MjcgMTkuMDUyNiAyOC42OTU5IDE5LjE1NThDMjguMzI5IDE5LjI1OSAyOC4wMjg5IDE5LjQ4MjYgMjcuNzk1NCAxOS44MjY2QzI3LjU2MiAyMC4xNzA2IDI3LjM4NDIgMjAuNTcxOSAyNy4yNjE4IDIxLjAzMDVDMjcuMTM5NiAyMS40ODkyIDI3LjA3ODQgMjEuOTAxOSAyNy4wNzg0IDIyLjI2ODlDMjcuMDc4NCAyMi41MjExIDI3LjA3MjkgMjIuNzI3NSAyNy4wNjE4IDIyLjg4OEMyNy4wNTA3IDIzLjA0ODYgMjcuMDQ1MSAyMy4xODYyIDI3LjA0NTEgMjMuMzAwOEMyNy4wMjI4IDIzLjQxNTUgMjcuMDExNyAyMy41MDcyIDI3LjAxMTcgMjMuNTc2TDI2LjUxMTUgMjMuNTc2TDIzLjEwOTkgMjMuNTc2QzIyLjY0MyAyMy41NzYgMjIuMjY1MSAyMy42NzkyIDIxLjk3NiAyMy44ODU2QzIxLjY4NyAyNC4wOTIgMjEuNDU5MSAyNC4zNTU3IDIxLjI5MjQgMjQuNjc2OEMyMS4xMjU2IDI0Ljk5NzggMjEuMDE0NSAyNS4zNTkgMjAuOTU4OSAyNS43NjAzQzIwLjkwMzMgMjYuMTYxNiAyMC44NzU1IDI2LjU0NTcgMjAuODc1NSAyNi45MTI3TDIwLjg3NTUgMjkuNzMzM0MyMC44NzU1IDI5Ljg3MDkgMjAuODg2NyAyOS45OTcxIDIwLjkwODkgMzAuMTExN0wxNi4zMDY3IDMwLjExMTdDMTQuNzI4MiAzMC4xMTE3IDEzLjI0OTcgMzAuMTA2IDExLjg3MTMgMzAuMDk0NUMxMC40OTI5IDMwLjA4MzEgOS4yODExOSAzMC4wNzczIDguMjM2MjcgMzAuMDc3M0w1LjkzNTE4IDMwLjA3NzNDNS4xMzQ4MyAzMC4wNzczIDQuNDc4OTQgMjkuOTY4NCAzLjk2NzU5IDI5Ljc1MDVDMy40NTYyNCAyOS41MzI3IDMuMDU2MDMgMjkuMjUxOCAyLjc2NzAzIDI4LjkwNzhDMi40NzgwMyAyOC41NjM4IDIuMjc3ODkgMjguMTY4MiAyLjE2Njc1IDI3LjcyMUMyLjA1NTYgMjcuMjczOCAyIDI2LjgwOTUgMiAyNi4zMjc5TDIgMTMuNjAwNEwyIDEzLjU5MTNaTTM1LjU0OTEgMjcuMTg3OEMzNS44MzgxIDI3LjQxNzIgMzUuOTg4MiAyNy43MzgyIDM1Ljk5OTMgMjguMTUxQzM2LjAxMDQgMjguNTYzOCAzNS44OTM3IDI4Ljg2MTkgMzUuNjQ5MSAyOS4wNDU0QzM1LjMxNTYgMjkuMzIwNiAzNC45MjY2IDI5LjY0NzMgMzQuNDgxOSAzMC4wMjU3QzM0LjAzNzIgMzAuNDA0MSAzMy41NzU5IDMwLjc4ODIgMzMuMDk3OSAzMS4xNzgxQzMyLjYxOTkgMzEuNTY3OSAzMi4xNTMgMzEuOTU3OCAzMS42OTczIDMyLjM0NzZDMzEuMjQxNSAzMi43Mzc1IDMwLjgyNDYgMzMuMDgxNSAzMC40NDY3IDMzLjM3OTZDMjkuOTc5OCAzMy43Njk0IDI5LjY1MTkgMzMuOTc1OCAyOS40NjI5IDMzLjk5ODdDMjkuMjczOSAzNC4wMjE3IDI5LjE3OTQgMzMuNzIzNiAyOS4xNzk0IDMzLjEwNDRMMjkuMTc5NCAzMS41NTY1QzI5LjE3OTQgMzEuMTY2NiAyOS4wODQ5IDMwLjg0NTYgMjguODk1OSAzMC41OTMzQzI4LjcwNyAzMC4zNDEgMjguNDU2OCAzMC4yMTQ5IDI4LjE0NTYgMzAuMjE0OUwyNC4yNzcxIDMwLjIxNDlDMjMuOTY1OSAzMC4yMTQ5IDIzLjY2MDIgMzAuMTAwMyAyMy4zNiAyOS44NzA5QzIzLjA1OTkgMjkuNjQxNiAyMi45MDk4IDI5LjM0MzUgMjIuOTA5OCAyOC45NzY2TDIyLjkwOTggMjcuMjIyMkMyMi45MDk4IDI2LjU4MDEgMjMuMDA5OCAyNi4xOTAzIDIzLjIxIDI2LjA1MjdDMjMuNDEgMjUuOTE1MSAyMy43NjU3IDI1Ljg0NjMgMjQuMjc3MSAyNS44NDYzTDI0Ljk0NDEgMjUuODQ2M0MyNS4xNDQyIDI1Ljg0NjMgMjUuMzcyMSAyNS44NTIgMjUuNjI3NyAyNS44NjM1QzI1Ljg4MzQgMjUuODc1IDI2LjE4OTEgMjUuODgwNyAyNi41NDQ5IDI1Ljg4MDdMMjcuOTQ1NSAyNS44ODA3QzI4LjM5MDEgMjUuODgwNyAyOC43MDcgMjUuODAwNCAyOC44OTU5IDI1LjYzOTlDMjkuMDg0OSAyNS40Nzk0IDI5LjE3OTQgMjUuMTkyNyAyOS4xNzk0IDI0Ljc4TDI5LjE3OTQgMjMuMjY2NEMyOS4xNzk0IDIyLjg1MzYgMjkuMjQ2MSAyMi41ODk5IDI5LjM3OTUgMjIuNDc1M0MyOS41MTI5IDIyLjM2MDYgMjkuNzU3NCAyMi40NTIzIDMwLjExMzIgMjIuNzUwNUMzMC40Njg5IDIzLjAyNTYgMzAuODgwMiAyMy4zNTgyIDMxLjM0NzEgMjMuNzQ4QzMxLjgxNCAyNC4xMzc5IDMyLjI5NzUgMjQuNTMzNCAzMi43OTc4IDI0LjkzNDdDMzMuMjk4IDI1LjMzNjEgMzMuNzg3MSAyNS43Mzc0IDM0LjI2NTEgMjYuMTM4N0MzNC43NDMxIDI2LjU0IDM1LjE3MTEgMjYuODg5NyAzNS41NDkxIDI3LjE4NzhaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzIwQTUzQSIgZmlsbC1vcGFjaXR5PSIxLjAwMDAwMCIvPgoJPGRlZnMvPgo8L3N2Zz4K');
	}

	.receive-info .head .icon {
		margin-right: 4px;
		background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYuMDAwMDAwIiBoZWlnaHQ9IjM4LjAwMDAwMCIgdmlld0JveD0iMCAwIDM2IDM4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8cGF0aCBpZD0i5YeP5Y676aG25bGCIiBkPSJNMjEuNTA4NCAxMi45NzA4TDI0Ljg2OTIgMTYuNDk2NEMyNS4xODQ0IDE2LjgyNzEgMjUuNzEyMSAxNi44MjcxIDI2LjAyNzMgMTYuNDk2NEwyOS4zODgyIDEyLjk3MDhMMzIuMjYwOSAxMi45NzA4QzMyLjQ5MTQgMTIuOTcxMSAzMi43MTMyIDEzLjAxNjkgMzIuOTI2MSAxMy4xMDgzQzMzLjEzOSAxMy4xOTk3IDMzLjMyNyAxMy4zMjk3IDMzLjQ5MDEgMTMuNDk4NEMzMy42NTMxIDEzLjY2NyAzMy43Nzg3IDEzLjg2MTUgMzMuODY3MSAxNC4wODE4QzMzLjk1NTQgMTQuMzAyMSAzMy45OTk3IDE0LjUzMTUgMzQgMTQuNzdMMzQgMTcuMjg4OEwyIDE3LjI4ODhMMiAxMC40NTJDMi4wMDAyNCAxMC4yMTM1IDIuMDQ0NTYgOS45ODQwOSAyLjEzMjkgOS43NjM3OUMyLjIyMTI1IDkuNTQzNSAyLjM0NjkyIDkuMzQ5MDMgMi41MDk5NSA5LjE4MDM5QzIuNjcyOTcgOS4wMTE3NCAyLjg2MDk2IDguODgxNzIgMy4wNzM4OCA4Ljc5MDMzQzMuMjg2ODMgOC42OTg5MyAzLjUwODU4IDguNjUzMSAzLjczOTE0IDguNjUyODNMMTMuMzkzOSA4LjY1MjgzQzEzLjg3NDcgOC42NTE0NiAxNC4yODQ2IDguODI3MTEgMTQuNjIzNyA5LjE3OTc2TDE4LjE4NjMgMTIuODY1M0MxOC4yNTQgMTIuOTM2IDE4LjMzNiAxMi45NzExIDE4LjQzMjIgMTIuOTcwOEwyMS41MDg0IDEyLjk3MDhaTTIgMzQuMjAwOEwyIDE4LjcyODFMMzQgMTguNzI4MUwzNCAzNC4yMDA4QzMzLjk5OTcgMzQuNDM5MyAzMy45NTU0IDM0LjY2ODcgMzMuODY3MSAzNC44ODlDMzMuNzc4NyAzNS4xMDkzIDMzLjY1MzEgMzUuMzAzOCAzMy40OTAxIDM1LjQ3MjRDMzMuMzI3IDM1LjY0MTEgMzMuMTM5MSAzNS43NzExIDMyLjkyNjEgMzUuODYyNUMzMi43MTMyIDM1Ljk1MzkgMzIuNDkxNCAzNS45OTk3IDMyLjI2MDkgMzZMMy43MzkxNCAzNkMzLjUwODU4IDM1Ljk5OTcgMy4yODY4MyAzNS45NTM5IDMuMDczODggMzUuODYyNUMyLjg2MDk2IDM1Ljc3MTEgMi42NzI5NyAzNS42NDExIDIuNTA5OTUgMzUuNDcyNUMyLjM0NjkyIDM1LjMwMzggMi4yMjEyNSAzNS4xMDkzIDIuMTMyOSAzNC44ODlDMi4wNDQ1NiAzNC42Njg3IDIuMDAwMjQgMzQuNDM5MyAyIDM0LjIwMDhaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzIwQTUzQSIgZmlsbC1vcGFjaXR5PSIxLjAwMDAwMCIvPgoJPHBhdGggaWQ9IuefoumHjyAxMiIgZD0iTTI2LjExMzggMkwyNC40MzE3IDJDMjMuOTg5OSAyIDIzLjYzMTcgMi4zNTgxNyAyMy42MzE3IDIuOEwyMy42MzE3IDYuNzcxNDNDMjMuNjMxNyA3LjIxMzI1IDIzLjI3MzUgNy41NzE0MyAyMi44MzE3IDcuNTcxNDNMMjEuMDk3MyA3LjU3MTQzQzIwLjQzMDMgNy41NzE0MyAyMC4wNTYyIDguMzM5NjIgMjAuNDY3NSA4Ljg2NDcxTDI0LjY0MjkgMTQuMTk1OUMyNC45NjMyIDE0LjYwNDggMjUuNTgyMiAxNC42MDQ4IDI1LjkwMjYgMTQuMTk1OUwzMC4wNzggOC44NjQ3MUMzMC40ODkzIDguMzM5NjIgMzAuMTE1MSA3LjU3MTQzIDI5LjQ0ODIgNy41NzE0M0wyNy43MTM3IDcuNTcxNDNDMjcuMjcxOSA3LjU3MTQzIDI2LjkxMzggNy4yMTMyNSAyNi45MTM4IDYuNzcxNDNMMjYuOTEzOCAyLjhDMjYuOTEzOCAyLjM1ODE3IDI2LjU1NTYgMiAyNi4xMTM4IDJaIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMyMEE1M0EiLz4KCTxkZWZzLz4KPC9zdmc+Cg==');
	}

	.sync-direction-box .package-list {
		padding-top: 20px;
		margin-top: 32px;
		display: flex;
		justify-content: space-between;
		border-top: 1px solid rgb(239, 239, 239);
		line-height: 22px;
	}

	.dir-title {
		color: #20a53a;
		height: 25px;
		background-color: #f5f5f5;
		text-align: center;
		line-height: 25px;
	}

	.dir-content {
		text-align: center;
		height: 25px;
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		line-height: 25px;
		border-bottom: 1px solid white;
		padding: 0 12px;
	}

	.dir-content:last-child {
		border-bottom: 0px;
	}

	.tip-title {
		background-color: #fff;
		border-radius: 4px;
		height: 25px;
		line-height: 25px;
		width: 100px;
		text-align: center;
		margin-bottom: 10px;
	}

	.div_back {
		width: 49%;
		background-color: #f2f2f2;
		border-radius: 4px;
		padding: 10px;
	}

	.demo-class2 {
		color: red;
	}

	.click-link {
		color: rgb(32, 165, 58);
		cursor: pointer;
	}

	.link-button {
		background-color: rgb(32, 165, 58);
    color: #fff;
    padding: 6px 14px;
    width: 180px;
    height: 36px;
    border-radius: 4px;
    margin-top: 14px;
    border: none;
	}

	.total_tips,
	.total_tips_delay,
	.total_tips_sync,
	.total_tips_exclude,
	.total_tips_status {
		border: 1px solid #fb7d00;
		border-radius: 8px;
		color: #fb7d00;
		cursor: pointer;
		display: inline-block;
		font-family: arial;
		font-size: 12px;
		font-style: normal;
		height: 14px;
		line-height: 14px;
		margin-right: 5px;
		text-align: center;
		width: 14px;
	}
	.total_tips_status:hover,
	.total_tips:hover,
	.total_tips_delay:hover,
	.total_tips_sync:hover,
	.total_tips_exclude:hover {
		background-color: #fb7d00;
		color: #fff;
	}

	.file_txt {
		background-image: url('../img/file_icon/file.png');
	}

	.file_folder {
		background-image: url('../img/file_icon/folder.png');
	}

	.hint_title {
		display: flex;
		align-items: center;
		margin-bottom: 20px;
	}

	.hint_title .hint-confirm-icon {
		background: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjY1NzE4MTEwNDUyIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjMyNTAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxwYXRoIGQ9Ik01MTIgOTkyQzI0Ni45MTIgOTkyIDMyIDc3Ny4wODggMzIgNTEyIDMyIDI0Ni45MTIgMjQ2LjkxMiAzMiA1MTIgMzJjMjY1LjA4OCAwIDQ4MCAyMTQuOTEyIDQ4MCA0ODAgMCAyNjUuMDg4LTIxNC45MTIgNDgwLTQ4MCA0ODB6TTQ4MCAyNTZ2MzUyYTMyIDMyIDAgMCAwIDY0IDBWMjU2YTMyIDMyIDAgMCAwLTY0IDB6IG0tMTYgNTI4YTQ4IDQ4IDAgMSAwIDk2IDAgNDggNDggMCAwIDAtOTYgMHoiIHAtaWQ9IjMyNTEiIGZpbGw9IiNmZmI2NjQiPjwvcGF0aD48L3N2Zz4=');
		min-width: 40px;
		height: 40px;
		align-self: baseline;
		margin-right: 10px;
	}

	.hint_con {
		font-size: 16px;
		color: red;
		/* font-weight: bold; */
	}
	.rsync_anomaly_details{
		background-color: #333;
		overflow: auto;
		height:400px;
		padding: 15px;
		color:white;
		white-space: pre-wrap;
		margin-bottom:0px;
	}
	/* 滚动条轨道 */
	.rsync_anomaly_details::-webkit-scrollbar-track {
		-webkit-box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
		background: #fff;
	}
	.rsync_anomaly_details::-webkit-scrollbar-thumb {
		border-radius: 10px;
		background: #9090908a;
	}
	.rsync_anomaly_details::-webkit-scrollbar {
		height: 14px;
		width: 10px;
	}
	
	
	#task_table{
		height:420px;
		overflow-y: auto;
	}
	/* 滚动条轨道 */
	#task_table::-webkit-scrollbar-track {
		/* -webkit-box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2); */
		-webkit-box-shadow: inset 0 0 5px rgb(217 217 217);
		background: #fff;
	}
	#task_table::-webkit-scrollbar-thumb {
		border-radius: 10px;
		background: #cecece8a;
	}
	#task_table::-webkit-scrollbar {
		height: 14px;
		width: 10px;
	}
	/* end */
	.choose_database {
		/* height: 475px; */
		width: 401px;
		/* border-top: 1px solid rgb(242, 242, 242);
		border-left: 1px solid rgb(242, 242, 242);
		border-bottom: 1px solid rgb(242, 242, 242); */
  }

    .choose_database_table {
			height: 475px;
			width: 401px;
			/* border: 1px solid rgb(242, 242, 242); */
			margin: 0 0 0 -1px;
			z-index: 0;
			box-shadow: 0px 5px 10px 4px #e8e8e8;
    }
		.item_main_table,
    .item_main {
			height: 286px;
			overflow: auto;
			-ms-overflow-style: none; /* IE and Edge */
			scrollbar-width: none; /* Firefox */
    }

    .item_main_table {
			padding: 18px;
    }

    #create_pop_config_main::-webkit-scrollbar {
			display: none;
    }

    .item_main_table {
			height: 321px;
    }

    .item_main_table::-webkit-scrollbar,
    .item_main::-webkit-scrollbar {
			display: none;
    }
		.right_table{
			padding: 16px;
			text-align: center;
			display: flex;
			flex-direction: column;
			flex-wrap: nowrap;
			position: relative;
			align-items: flex-start;
		}
		.input_file{
			display: flex;
			width: 100%;
			justify-content: flex-start;
			align-items: center;
		}
		.right_table .button_group{
			display: flex;
			width: 100%;
			margin-bottom:10px;
			justify-content: flex-start;
		}
		.right_table .button_group button{
			margin-right: 10px;
		}
		.empty_box_detail{
			display: flex;
			width: 100%;
			height: 300px;
			align-items: center;
			justify-content: center;
			flex-direction: column;
		}

		.file-type-icon {
			width: 24px;
			height: 24px;
			display: inline-block;
			vertical-align: middle;
			background-position: center;
			background-repeat: no-repeat;
			background-size: cover;
		}

		.file_folder {
			background-image: url('data:image/png;base64,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UmVhZHlxyWU8AAADKGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NEQ2NjBGOUZFQ0UxMUU5OEUyQUFENDExRjZDRkI0OCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2NEQ2NjBGQUZFQ0UxMUU5OEUyQUFENDExRjZDRkI0OCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY0RDY2MEY3RkVDRTExRTk4RTJBQUQ0MTFGNkNGQjQ4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY0RDY2MEY4RkVDRTExRTk4RTJBQUQ0MTFGNkNGQjQ4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+10BluQAACu9JREFUeNpi/P//PwMuwAJj/Ho49f/fr3cZWDm5GZhZ2BkZZWsYmGCSbEDBf//+MvwH4z9gMbgkw99fDP/+/mH4//cv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');
		}

		.file_icon {
			background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAFpOLgnAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAMqADAAQAAAABAAAAMgAAAAB1y6+rAAAD10lEQVRoBe1Z3U5aQRBeKBUxpEikll4oNsWnqOHed+lN05foG+ELaPwJl+gFCaW1qZYgBBChFKUz1N3sWWbZ3fOTcsEmJ2dndma+mdnZnwOM2bS7u7spPuVyecrlY7yDA7y/tbU148c5g3r7H6SsmXkzj6y85EJaD90HzO65SIikoxL3VjZwfn4+Iw8PD4VsQhbAfrPZZA8PD4K9vb3N9vb2BI2dOaVcLsfG47FHSCXmlOLxOFtfX1flPPScEo7GYjEsKv4gSxQZEtE3kb52u/04nU7npv7q6qp1cHDwmrsiC5C+9vv93NnZWZUryAhjQHjJB9Q3X1VypmYIjUbDI6udRLD+hJKqgEcbiDmE0WjkkVEnU1aYIagCHm0gjFlapDBDUAVUWkb4jINYS/A8PT+P8J4Ae6AqLhctqkN2C2qxDnP5Tubp+tVqtVcqlTK6ceTLuZLlCjKxqD8YDF7hqXBycvJNJ6eL5A9EItePTn+Oz9eDPKCLhFyJsqJLXwdiVZe2QGRKIFUikm63y4bD4UJ7+Xx+4TgJAhoikkwmw/AJ0nQgIhL1IKLAXLYsWV9Egqdb0KabeBFJUICV/nJmgNy7qIsX5X69XmfZbPZNsVhsUuOcp6suPm5812q1X7CW0osEA4Og8Uql0oedSHtTCQUEgY6OjvBKRKafZNrOCRpX2gjOk5TC056MqlwgOrR0oRdwrSEzo9uFhefqLVIMPHc2NjaYaRM1gpi2cQWUjCTUdAEgCWKM5Pb2VnHWS6ZSKePJaQTZ3Nz0WlWotbU1meMvEtNdXUaAPgkS9pwomP9IY7ocS5iMxAjiWMJkJGGni4wkVBDdLhwqCJkrYJJzAvvcb/AqiUrQl+9gVF/mfdIBrfirDESRAXJ9UkDwZf8RivoLFDTu7KqeE82X7M3NzfdkMvlhf3//B4XpwlMd0OpCIE/cAa2Q4wBepFutFkun053d3d33hUKh42hCiLvsW/LWIQyE0bm/v89eXl62j4+Pf0KyFv9AqgFcikC4b71e7y3c2Yenp6c1COgF59u8XQKxsReKTKfTKUJAk4uLi4qtQZc14vvHL1tnCDnyQ4eQc/r4iWyNUI658sj7g8YIGQhe9k2/tWnsCTZ+EFC/x8FWb10xLoEIYLlDOSCPB+xbB+Ky2MkZCehoaOrWgcB2+D8CsZ4Rl9IiA7m+vmaTCf6l4r8lEgm2s7NDGYgkEApI5wApGyXTurTACXJGonQObFvPyLIHYp2nwGskynPEZUZcAiGzszpHyLT4Zy71GoGjK/zFDteehv98+dMEzK/+NFdaqwyEloG/engwwneEWvEAAAAASUVORK5CYII=');
		}
		#result_table,#result_table_filter{
			width:100%
		}
		.left_table{
			display: flex;
			flex-direction: row;
			align-items: flex-start;
			flex-wrap: nowrap;
		}
		#fileScanPath,#fileScanPath2{
			margin-bottom: 10px;
		}
		.triangle{
			position: absolute;
			width: 9px;
			height: 10px;
			bottom: 0px;
			right: -8px;
			border-top: 16px solid transparent;
			border-bottom: 16px solid #ffffff00;
			border-left: 12px solid #f1f9f3;
			z-index: 9999;
		}
		.help-line-ul li {
			list-style:disc;
		}

		.demo-class .tab-nav{
			margin:20px 20px 0;
		}
		.demo-class .tab-nav .on,
		.log_demo .tab-nav .on{
			color:#20a53a
		}
		
		.demo-class .tab-nav span:hover,
		.log_demo .tab-nav span:hover{
			color:#20a53a
		}
		.demo-class .tab-span-hr{
			border-left: 6px solid #20a53a;
			background-color: #f2f2f2;
			width:580px;
			height: 32px;
			line-height: 32px;
			text-align: left;
      padding-left: 10px;
			margin: 0 0px 10px;
			color:#666;
			display: inline-block;
		}
		.message_card {
			width: 100%;
			margin-bottom: 10px;
			background-color: #FAFAFA;
			border: #ddd 1px solid;
		}
		.message_card .name {
			margin: 0 15px;
			padding: 6px 0;
			border-bottom: 1px solid #eee;
			font-size: 14px;
			font-weight: bold;
			color: #333;
		}
		.info_box {
			display: flex;
			padding: 0 15px;
		}
		.info_box .info_box_item {
			flex: 1;
			display: flex;
			align-items: center;
			padding: 6px 0;
		}
		.info_box .info_box_item + .info_box_item {
			margin-left: 10px;
		}
		.info_box_item .item_label {
			color: #78797D;
		}
		.info_box_item .item_value {
			color: #333;
		}
		.select-icon{
			display: inline-block;
			height:12px;
			width:12px;
			cursor:pointer;
			margin-left: 4px;
			background-repeat: no-repeat;
			background:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIuMDAwMDAwIiBoZWlnaHQ9IjEyLjAwMDAwMCIgdmlld0JveD0iMCAwIDEyIDEyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcy8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTEuMTIzMjggMy44MDkzOUw1LjcxNTU4IDguODQzODdDNS44Nzg2MiA5LjAyMzAxIDYuMTY4NDcgOS4wNDQzMSA2LjMzMDM4IDguODYzODlMMTAuODc5MyAzLjc4MzA4QzExLjA0MTIgMy42MDI2NiAxMS4wNCAzLjMxMjAxIDEwLjg3NyAzLjEzMjgxQzEwLjc5NjIgMy4wNDQ2OCAxMC42ODk0IDMgMTAuNTgzOCAzQzEwLjQ3NyAzIDEwLjM2OTQgMy4wNDU5NiAxMC4yODgzIDMuMTM2Nkw2LjAyODgzIDcuODkyODJMMS43MDg2NCAzLjE1NjYyQzEuNjI3ODcgMy4wNjg0OCAxLjUyMjIgMy4wMjM4IDEuNDE1MzkgMy4wMjM4QzEuMzA3NDYgMy4wMjM4IDEuMjAxMDMgMy4wNjk3NiAxLjExOTg4IDMuMTYwNEMwLjk1ODM1MyAzLjMzODMyIDAuOTYwNjE4IDMuNjMwMjUgMS4xMjMyOCAzLjgwOTM5WiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjMjBBNTNBIi8+Cjwvc3ZnPgo=')
		}
		.clientSide .sideList .select-icon-roate{
			background:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIuMDAwMDAwIiBoZWlnaHQ9IjEyLjAwMDAwMCIgdmlld0JveD0iMCAwIDEyIDEyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcy8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTEuMTIzMjkgMy44MDkzOUw1LjcxNTU4IDguODQzODdDNS44Nzg2IDkuMDIzMDEgNi4xNjg0NiA5LjA0NDMxIDYuMzMwMzggOC44NjM4OUwxMC44NzkzIDMuNzgzMDhDMTEuMDQxMiAzLjYwMjY2IDExLjA0IDMuMzEyMDEgMTAuODc3IDMuMTMyODFDMTAuNzk2MyAzLjA0NDY4IDEwLjY4OTUgMyAxMC41ODM3IDNDMTAuNDc2OSAzIDEwLjM2OTQgMy4wNDU5NiAxMC4yODgzIDMuMTM2Nkw2LjAyODgxIDcuODkyODJMMS43MDg2MiAzLjE1NjYyQzEuNjI3ODcgMy4wNjg0OCAxLjUyMjIyIDMuMDIzOCAxLjQxNTQxIDMuMDIzOEMxLjMwNzQzIDMuMDIzOCAxLjIwMTA1IDMuMDY5NzYgMS4xMTk4NyAzLjE2MDRDMC45NTgzNzQgMy4zMzgzMiAwLjk2MDYzMiAzLjYzMDI1IDEuMTIzMjkgMy44MDkzOVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0iIzk5OTk5OSIvPgo8L3N2Zz4K");
			transform: rotate(0deg);
		}
		.clientSide .sideList .select-icon{
			background:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIuMDAwMDAwIiBoZWlnaHQ9IjEyLjAwMDAwMCIgdmlld0JveD0iMCAwIDEyIDEyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcy8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTMuODA5MzkgMTAuODc2N0w4Ljg0Mzg3IDYuMjg0NDJDOS4wMjMwMSA2LjEyMTQgOS4wNDQzMSA1LjgzMTU0IDguODYzODkgNS42Njk2MkwzLjc4MzA4IDEuMTIwNzNDMy42MDI2NiAwLjk1ODgwMSAzLjMxMjAxIDAuOTU5OTYxIDMuMTMyODEgMS4xMjI5OUMzLjA0NDY4IDEuMjAzNzQgMyAxLjMxMDU1IDMgMS40MTYyNkMzIDEuNTIzMDcgMy4wNDU5NiAxLjYzMDYyIDMuMTM2NiAxLjcxMTczTDcuODkyODIgNS45NzExOUwzLjE1NjYyIDEwLjI5MTRDMy4wNjg0OCAxMC4zNzIxIDMuMDIzOCAxMC40Nzc4IDMuMDIzOCAxMC41ODQ2QzMuMDIzOCAxMC42OTI2IDMuMDY5NzYgMTAuNzk5IDMuMTYwNCAxMC44ODAxQzMuMzM4MzIgMTEuMDQxNiAzLjYzMDI1IDExLjAzOTQgMy44MDkzOSAxMC44NzY3WiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjOTk5OTk5Ii8+Cjwvc3ZnPgo=");
		}
		.select-icon-roate{
			display: inline-block;
			height:12px;
			cursor:pointer;
			width:12px;
			margin-left: 4px;
			background-repeat: no-repeat;
			transform: rotate(180deg);
			background:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIuMDAwMDAwIiBoZWlnaHQ9IjEyLjAwMDAwMCIgdmlld0JveD0iMCAwIDEyIDEyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcy8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTEuMTIzMjggMy44MDkzOUw1LjcxNTU4IDguODQzODdDNS44Nzg2MiA5LjAyMzAxIDYuMTY4NDcgOS4wNDQzMSA2LjMzMDM4IDguODYzODlMMTAuODc5MyAzLjc4MzA4QzExLjA0MTIgMy42MDI2NiAxMS4wNCAzLjMxMjAxIDEwLjg3NyAzLjEzMjgxQzEwLjc5NjIgMy4wNDQ2OCAxMC42ODk0IDMgMTAuNTgzOCAzQzEwLjQ3NyAzIDEwLjM2OTQgMy4wNDU5NiAxMC4yODgzIDMuMTM2Nkw2LjAyODgzIDcuODkyODJMMS43MDg2NCAzLjE1NjYyQzEuNjI3ODcgMy4wNjg0OCAxLjUyMjIgMy4wMjM4IDEuNDE1MzkgMy4wMjM4QzEuMzA3NDYgMy4wMjM4IDEuMjAxMDMgMy4wNjk3NiAxLjExOTg4IDMuMTYwNEMwLjk1ODM1MyAzLjMzODMyIDAuOTYwNjE4IDMuNjMwMjUgMS4xMjMyOCAzLjgwOTM5WiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjMjBBNTNBIi8+Cjwvc3ZnPgo=')
		}
		.other_disposition{
			display:inline-flex !important;
			align-items:center;
			text-align: center;
			margin-bottom: 10px;
		}
		.bymore_rsync{
			display:flex;
			justify-content: center;
			width:100%;
			position:relative;
			margin-bottom: 40px;
		}
		#bymore_rsync_table{
			width:95%;
		}
		#bymore_rsync_table .divtable{
			border:none;
		}
		 
		.add_input_rsync{
			width: 551px;
			position: absolute;
			border-top: 1px solid #dcdfe6;
			bottom: -24px;
			padding: 0px 4px;
			border-bottom: 1px solid #DCDFE6;
		}
		.add_input_rsync input{
			width: 551px;
			/* border-top: none; */
			border: none;
			/* border: #DCDFE6 1px solid; */
			outline: none;
			height: 30px;
		}
		.open_own_rsync{
			max-width: 610px;
			width:520px;
		}
		.open_own_rsync .loacal_or_receive{
			height: 32px;
			display: inline-block;
			vertical-align: top;
			cursor: pointer;
			margin-right: 10px;
		}
		.open_own_rsync .loacal_or_receive span.cur,.open_own_rsync .loacal_or_receive span.cur:hover {
			border-right: none;
			border-color: #20a53a;
			background-color: #20a53a;
			color: #fff;
	}
	.open_own_rsync .loacal_or_receive span.cur{
		border-radius: 2px;
	}
	.loacal_or_receive span.cur:hover{
		border-right: none;
		border-left: none;
	}
	.open_own_rsync .loacal_or_receive span:hover {
		border-left: none;
			border-color: #BCE4C4;
			background-color: #F1F9F3;
			color: #20a53a;
	}

	.open_own_rsync .loacal_or_receive span:first-of-type {
		border-left: #ddd 1px solid;
	}
	.open_own_rsync .loacal_or_receive span{
		float: left;
		border: #ddd 1px solid;
		border-left: none;
		padding: 0px 12px;
		position: relative;
		border-radius:2px;
		line-height: 30px;
	}
	.loacal_or_receive span.last-span:last-child {
		padding: 0;
	}
	.demo_hr_div{
		border-top: #ccc 1px dashed;
		padding-top: 18px;
		margin-top: 10px;
		display: flex;
		width: 100%;
		justify-content: center;
	}
	input::-webkit-input-placeholder,.press {
			color: #666;
  }
	.press:active,.press:hover{
		color: #333;
	}
	
	.table-hover>tbody>tr:hover {
		background-color: #F5F7FA !important
	}
	.table-hover>tbody>tr{
		height: 40px;
	}

	.layui-layer-btn {
		background-color: #f6f8f8;
		border-top: 1px solid #edf1f2;
		border-bottom: 1px solid #edf1f2;
		float: left;
		padding: 10px 18px 10px;
		pointer-events: auto;
		text-align: right;
		width: 100%;
		user-select: none;
		-webkit-user-select: none;
	}
	.line{
		padding:10px 0;
	}
	.line .info-r{
		margin-bottom:0px;
	}
	.open_item_rsync{
		display:inline-flex !important;
		align-items: center;
	}
	.log_demo pre{
		overflow: auto; 
		border: 0px none; 
		border-radius: 0; 
		padding: 15px; 
		height: 350px; 
		background-color: #333;
		color: #fff; 
		white-space: pre-wrap;
	}
	.setchmod {
		display: flex;
		height: 100%;
	}

	.setchmod .tab-group {
		border: 1px solid #ececec;
		overflow: auto;
		width: 200px;
		display: flex;
    flex-direction: column;
	}

	.tab-content {
		width: 100%;
		flex: 1;
	}

	.setchmod .tab-group .tab-item.on {
		background-color: #EEF8F0;
		color: #20a53a;
	}

	.setchmod .tab-group .tab-item.on:hover {
		background-color: #EEF8F0;
	}

	.setchmod .tab-group .tab-item {
		line-height: 18px;
		padding: 10px;
		border-bottom: 1px solid #ececec;
		cursor: pointer;
		word-wrap: break-word;
	}

	.setchmod .tab-group .tab-item:hover {
		background-color: rgb(245, 247, 250);
	}
	#task_table .table{
		border:none;
		table-layout:fixed
	}
	.info-r .goFilterConfig {
		margin-right:134px;
		width:70px;
		float:right;
		border: #DCDFD6 solid 1px;
		border-radius: 2px;
    line-height: 1;
    background-color: #FFFFFF;
		padding: 0px;
    text-align: center;
		line-height: 32px;
	}
	.info-r .goFilterConfig:hover{
		background: rgb(241, 249, 243);
		border: 1px solid rgb(188, 228, 196);
		color: #20A53A;
		cursor: pointer;
	}
</style>
<div class="tsynsList" style="display: none;">
	<div class="bt-w-menu">
		<p class="bgw"><a href="javascript:;" onclick="tsync.getClientInfo();">任务列表</a></p>
		<p><a href="javascript:;" onclick="tsync.getServerInfo();">接收配置</a></p>
		<p><a href="javascript:;" onclick="tsync.getfilterModel();">过滤模板配置</a></p>
		<p><a href="javascript:;" onclick="tsync.get_logs();">操作日志</a></p>
	</div>
	<div class="bt-w-con" style="height: 680px;">
		<div class="clientSide">
			<div class="header">
				<div class="pull-left">
					<button class="btn btn-success btn-sm va0" onclick="tsync.setClientView(false)">创建发送任务</button>
					<button class="btn btn-default btn-sm va0" onclick="tsync.setClientLocal()">创建本地同步</button>
					<button class="btn btn-default btn-sm va0" onclick="tsync.methodLogs(false,false,'service')">实时同步日志</button>
					<button class="btn btn-default btn-sm va0" onclick="tsync.setRsyncAlert()">异常告警设置</button>

				</div>
			</div>
			<div class="conter divtable" id="task_table">
				<table class="table table-hover">
					<thead>
						<tr>
							<th width="120">名称</th>
							<th width="160">源目录</th>
							<th width="200">同步到</th>
							<th width="68">同步开关</th>
							<th width="73">连接方式</th>
							<th width="80">周期</th>
							<th width="140">最后同步时间</th>
							<th width="130" style="text-align: center;line-height:1;">最后同步状态<i style="margin-left:5px" class='total_tips_status'>?</i></th>
							<th style="text-align: right;" width="200">操作</th>
						</tr>
					</thead>
					<tbody class="sideList"></tbody>
				</table>
			</div>
		</div>
		<div class="serverSide" style="display: none;">
			<div class="header">
				<div class="pull-left">
					<button class="btn btn-success btn-sm va0" onclick="tsync.setServerView(false)"
						style="margin-right: 6px;">创建接收任务</button>
					<button class="btn btn-default btn-sm va0" onclick="tsync.setOverallView()">全局配置</button>
				</div>
				<div class="switch pull-right">
					<span class="switchText"></span>
					<div class="ssh-item">
						<input class="btswitch btswitch-ios" id="switch" type="checkbox" onclick="tsync.serverSwitch()">
						<label class="btswitch-btn" for="switch"></label>
					</div>
				</div>
			</div>
			<div class="conter divtable">
				<table class="table table-hover">
					<thead>
						<tr>
							<th width="200">任务名称</th>
							<th width="150">用户名</th>
							<th width="150">密码</th>
							<th>目录</th>
							<th width="120" style="text-align: right;">操作</th>
						</tr>
					</thead>
					<tbody class="sideList"></tbody>
				</table>
			</div>
		</div>
		<div id="filter_model" style="display: none;padding: 20px;"></div>
		<div class="logsSide" style="display: none;padding-top: 20px;">
			<div class="conter divtable">
				<table class="table table-hover">
					<thead>
						<tr>
							<th>详情</th>
							<th style="text-align: right;">操作时间</th>
						</tr>
					</thead>
					<tbody class="logsList"></tbody>
				</table>
				<div class="page"></div>
			</div>
		</div>
		<span class="tip" style="position: absolute;bottom:10px;line-height: 22px;color: #777;margin: 20px 25px 10px 25px;">
			温馨提示：<br />
			1. 如需将其他服务器数据同步到本服务器，请在接收配置中“创建接收任务”。<br />
			2. 如需将本服务器数据同步到其他服务器，请在发送配置里“创建发送任务”。<br />
			3. 如需将本服务器内部的两个文件夹的数据进行同步，请在发送配置里“创建本地同步”。<br />
			4. 注意：不同的同步任务及服务器请不要使用相同的同步名称及用户名，这会导致管理混乱。<br />
			5. <a class="btlink" target="_blank"
				href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=73889&highlight=%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8">详细使用方法，请点击这里查看教程</a><a
				href="https://www.bt.cn/bbs/forum.php?mod=viewthread&tid=73889&highlight=%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8"
				target="_blank" class="bt-ico-ask" style="cursor: pointer;">?</a><br />
			6. 联系我们：QQ群(620695507),问题反馈和建议都可以哦,(●ˇ∀ˇ●)。
		</span>
	</div>
</div>
<script type="text/javascript">
	var tsync = {
		setStatus: false,
		setTitle: '添加目录',
		setSubmit: '提交',
		set_layer_View: '',
		cancelLog: '',
		alertListModule:[],   //告警设置获取的消息模块列表
		template_data_list:[],//模板列表
		bymore_tabledata:[], // 一对多同步表格信息
		default_disposition:{
			work_type: 0, // 0:本地 1:rsync 2ssh
      target: '', // ssh 目标文件夹
      name: '', // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
      password_file: '', // ignore
      ip: '', // 服务器ip
      port: 873, // 端口
      id: null, 
      title: '', // 有的话用户名 
      bwlimit: 1024, // 限速
      delete: false, // true:完全 false：增量
      archive: true, // ignore
      compress: true, // 压缩
      verbose: true, // ignore
      password: '', // 密码
      realtime: true, // 实时同步
      cron: { // 实时定时
        type: 'minute-n',
        where1: '5',
        hour: '',
        minute: '',
        seconds: '',
      },
		},
		setServerForm: {
			mName: '',
			path: '/www/wwwroot/',
			passwd: '',
			comment: ''
		},
		rsync_list:[],
		setClientForm: {
			name: '',
			args: '',
			cron_info: {
				where_hour: '',
				id: '',
				type: '',
				where1: '1',
				where_minute: '1'
			},
			inotify_info: true,
			secret_key: '',
			ip: '',
			mName: '',
			path: '/www/wwwroot/',
			exclude: '',
			include: ''
		},
		conf_data:[],
		// 初始化
		initial: function () {
			var width = 1340;
			var height = 720;
			var _this = this;
			var boxwidth = ($(document).width() / 2) - (width / 2);
			var boxheight = ($(document).height() / 2) - (height / 2);
			$('.layui-layer-page').width(width);
			$('.layui-layer-page').height(height);
			$('.bt-w-menu').height((height - 1) - $('.layui-layer-title').height())
			$('.layui-layer-page').css({
				'left': boxwidth + 'px',
				'top': boxheight + 'px'
			});
			$(".bt-w-menu p").click(function () {
				var index = $(this).index();
				$(this).addClass("bgw").siblings().removeClass("bgw");
				$('.bt-w-con>div:eq(' + index + ')').show().siblings().hide();
				$('.tip').show();
			});
			$('.tsynsList').show();
			this.getClientInfo();

			// 表格提示
			var showTips_status = ''
			$('.total_tips_status').hover(function () {
				showTips_status = setTimeout(function () {
					layer.tips('状态成功：最近一次同步成功<br/>状态异常：最近一次同步可能失败或出现其他问题，点击将呈现详细错误日志。', $('.total_tips_status'), {
						tips: [1, '#20a53a'],
						area:['220px','auto'],
						time: 0,
					})
				}, 200)
			}, function () {
				clearTimeout(showTips_status)
				layer.closeAll('tips');
			})
			// this.setClientView(false)
		},
		/**
		 * @description 表格头固定
		 **/

		tableFixed:function (name){
			var tableName = document.querySelector('#'+name);
			tableName.addEventListener('scroll',this.scrollHandle);
		},
		scrollHandle:function(e){
			var scrollTop = this.scrollTop;
			//this.querySelector('thead').style.transform = 'translateY(' + scrollTop + 'px)';
			$(this).find("thead").css({"transform":"translateY("+(scrollTop === 0?(scrollTop):(scrollTop-1))+"px)","position":"relative","z-index":"1"});
		},

		/**
		 * @description 获取操作日志
		 **/
		get_logs: function (p) {
			if (p == undefined) p = 1;
			var loadget = layer.msg('正在获取操作日志...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.get('/plugin?action=a&name=rsync&s=get_logs&tojs=tsync.get_logs&p=' + p, function (res) {
				layer.close(loadget);
				var tbody = '';
				for (var i = 0; i < res.data.length; i++) {
					tbody += '<tr><td>' + res.data[i].log + '</td><td style="text-align: right;">' + res.data[i].addtime + '</td></tr>'
				}
				$(".logsList").html(tbody);
				$(".page").html(res.page);
			});
		},

		/**
		 * @description 接收端-获取配置信息
		 **/
		getServerInfo: function () {
			var _this = this,domData = '';
			var loadget = layer.msg('正在获取配置信息...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.get('/plugin?action=a&name=rsync&s=get_global_conf', function (res) {
				layer.close(loadget);
				if (res.open) {
					$('#switch').prop('checked', res.open);
					$('.switchText').empty().append('<span style="color:#20a53a">接收服务已开启</span>');
					$('.restart').show();
				} else {
					$('#switch').prop('checked', res.open);
					$('.switchText').empty().append('<span style="color:red">接收服务已关闭</span>');
					$('.restart').hide();
				}
				for (var i = 0; i < res['modules'].length; i++) {
					domData += '<tr>\
						<td><span class="overFlowStyle" style="width:220px" title="'+ res['modules'][i].comment + '">' + res['modules'][i].comment + '</span></td>\
										<td width="100"><span class="overFlowStyle" style="width:100px" title="'+ res['modules'][i].name + '">' + res['modules'][i].name + '</span></td>\
										<td width="120" style="position: relative;">\
											<span class="password"  data-pw="'+ res['modules'][i].password + '">******</span>\
											<span class="glyphicon glyphicon-eye-open psShow" title="显示密码" style="margin-left:5px"></span>\
										</td>\
										<td><span class="overFlowStyle" style="width:200px"><a href="javascript:;" onclick="openPath(\''+ res['modules'][i].path + '\')" class="btlink" title="' + res['modules'][i].path + '">' + res['modules'][i].path + '</a></span></td>\
										<td style="text-align: right;">\
											<a href="javascript:;" class="btlink generateKey" data-mName="'+ res['modules'][i].name + '">密钥</a> | \
											<a href="javascript:;" class="btlink" onclick="tsync.setServerView(\''+ res['modules'][i].name + '\')">编辑</a> | \
											<a href="javascript:;" class="btlink" onclick="tsync.delServerInfo(\''+ res['modules'][i].name + '\')">删除</a>\
										</td>\
									</tr>'
				}
				$('.serverSide .sideList').empty().append(domData);
				// 显示密码
				$('.psShow').click(function (event) {
					if ($(this).hasClass('glyphicon-eye-open')) {
						$(this).removeClass('glyphicon-eye-open').addClass('glyphicon-eye-close');
						var password_value = $(this).prev().attr('data-pw');
						$(this).prev().attr('title',$(this).prev().attr('data-pw'))
						var password_elclipse = password_value.length>30?'...':'';
						var password_show = password_value.substr(0, 30) + password_elclipse;
						$(this).prev().text(password_show);
					} else {
						$(this).removeClass('glyphicon-eye-close').addClass('glyphicon-eye-open');
						$(this).prev().text('******');
					}
				});
				$('.generateKey').click(function (event) {
					_this.set_task_key($(this).attr('data-mName'))
				});
				$('body').on('click', '.btcopy', function (event) {
					event.preventDefault();
					btcopy();
				});
			});
		},
		// 接收端 - 设置配置信息(编辑和添加)
		setServerView: function (mName) {
			var that = this;
			$.post('/plugin?action=a&name=rsync&s=get_module', { mName: mName }, function (rdata) {
				var _this = this, readonly = '';
				var status = true;
				if (!mName) {
					status = false;
					mName = '';
				}
				that.setStatus = status;
				if (status) {
					that.setTitle = '编辑接收';
					that.setSubmit = '保存';
					readonly = 'readonly="readonly" disabled="disabled"'
					action = 'modify_module';
				} else {
					that.setTitle = '创建接收';
					that.setSubmit = '提交';
					action = 'add_module'
					that.setServerForm = {
						mName: '',
						path: '/www/wwwroot/',
						dont_commpress: '',
						password: RandomStrPwd(12),
						comment: ''
					}
					rdata = that.setServerForm;
				}
				tsync.set_layer_View = layer.open({
					type: 1,
					area: '500px',
					title: that.setTitle,
					closeBtn: 2,
					shift: 0,
					shadeClose: false,
					content: "\
						<form class='bt-form pd20 pb70' id='fromServerPath' accept-charset='utf-8' enctype='application/x-www-form-urlencoded'>\
							<div class='line'>\
								<span class='tname'>接收目录</span>\
								<div class='info-r c4'>\
									<input id='inputPath' class='bt-input-text mr5' type='text' name='path' value='"+ rdata.path + "' placeholder='请选择本地路径' style='width:300px' /><span class='glyphicon glyphicon-folder-open cursor' onclick='ChangePath(\"inputPath\")'></span>\
								</div>\
							</div>\
							<div class='line'>\
								<span class='tname'>任务名称</span>\
								<div class='info-r c4'>\
									<input class='bt-input-text' type='text' name='comment' placeholder='' value='"+ rdata.comment + "' style='width:300px' />\
								</div>\
							</div>\
							<div class='demo_hr_div '>\
								<span class='btlink form-check-lable-receive other_disposition active'>点击查看，更多配置<span class='select-icon'></span></span>\
							</div>\
							<div class='session_clear hide' >\
							<div class='line'>\
								<span class='tname'>用户名</span>\
								<div class='info-r c4'>\
									<input class='bt-input-text' type='text' name='mName' "+ readonly + "  placeholder='请填写用户名,不能有中文或特殊符号' value='" + mName + "' style='width:300px' />\
								</div>\
							</div>\
							<div class='line'>\
								<span class='tname'>密码</span>\
								<div class='info-r c4'>\
									<input class='bt-input-text' type='text' name='password' placeholder='请输入密码' value='"+ rdata.password + "' style='width:300px' />\
									<span title='随机密码' style='margin-right: 10px;' class='glyphicon glyphicon-repeat cursor pws'></span>\
								</div>\
							</div>\
							</div>\
							<div class='bt-form-submit-btn'>\
								<button type='button' class='btn btn-danger btn-sm btn-title colseView' onclick='layer.close(tsync.set_layer_View)'>取消</button>\
								<button type='button' class='btn btn-success btn-sm btn-title setViewData'>"+ that.setSubmit + "</button>\
							</div>\
						</form>",
					success: function () {
						if (!status) {
							var result = [];
							for (var i = 0; i < 5; i++) {
								var ranNum = Math.ceil(Math.random() * 25);
								result.push(String.fromCharCode(97 + ranNum));
							}
							$("input[name='mName']").val(result.join(''))
						}

						// 高级配置
						$('.form-check-lable-receive').click(function () {
							var childIcon = $(this).find('i'),
								isExpert = $(this).hasClass('config_switch')
							expert = $('.session_clear');
							if ($(this).hasClass('active')) {
								$(this).removeClass('active');
								$('.session_clear').removeClass('hide')
									$(this).html('点击收起，更多配置<span class="select-icon-roate"></span>')
								} else {
									$(this).addClass('active');
									$('.session_clear').addClass('hide')
									$(this).html('点击查看，更多配置<span class="select-icon"></span>')
								}
						});

						$('.setViewData').click(function (event) {
							that.setServerForm = {
								mName: $("input[name='mName']").val(),
								password: $("input[name='password']").val(),
								path: $("input[name='path']").val(),
								comment: $("input[name='comment']").val()
							}
							for (var index in that.setServerForm) {
								if (that.setServerForm['comment'] == '') {
									layer.msg('请输入当前任务名称!');
									return false;
								}
								if (that.setServerForm['password'] == '') {
									layer.msg('请输入当前用户名密码!');
									return false;
								}
							}
							if (that.setServerForm['path'] == '') {
								layer.msg('请输入当前同步目录!');
								return false;
							} else {
								path = $("input[name='path']").val();
								$.post('/plugin?action=a&name=rsync&s=check_dir_status', { path: path }, function (rdata) {
									if (rdata.isMysqlData) {
										layer.msg('当前发送目录为mysql数据存储目录，同步会导致数据库出现异常,请重新选择！',{icon:8})
										return
									} else if (!rdata.isEmpty && !rdata.isMysqlData) {
										var itemHtmlDir = ''
										var itemHtmlFiles = ''
										for (var k = 0; k < rdata.dirs.length; k++) {
											itemHtmlDir += '<p class="dir-content" title="' + rdata.dirs[k] + '">' + rdata.dirs[k] + '</p>'
										}
										for (var j = 0; j < rdata.files.length; j++) {
											itemHtmlFiles += '<p class="dir-content" title="' + rdata.files[j] + '">' + rdata.files[j] + '</p>'
										}
										var contentHtml = '<div style="padding: 20px;">\
											<div class="hint_title">\
            						<i class="hint-confirm-icon"></i>\
           						 <div class="hint_con">当前选中的目录包含以下内容，继续操作可能会存在被覆盖风险，请仔细核对后选择是否继续创建接收任务</div>\
          						</div>\
												<div id="receive_show_table">\
													</div>\
												</div>'
										var tableData = []
										$.each(rdata.dirs, function (index, item) {
											tableData.push({
												fid: item,
												type: 'dir'
											})
										})
										$.each(rdata.files, function (index, item) {
											tableData.push({
												fid: item,
												type: 'file'
											})
										})
										layer.open({
											type: 1,
											title: '同步提醒',
											btn: ['继续', '取消'],
											closeBtn: 2,
											area: ['600px', '460px'],
											content: contentHtml,
											success: function (index, layers) {
												bt_tools.table({
													el: '#receive_show_table',
													load: true,
													data: tableData,
													default: "列表为空", //数据为空时的默认提示
													height: '250px',
													column: [
														{
															title: '',
															width: '30px',
															template: function (row) {
																if (row.type == 'file') return '<i class="file_icon file_txt"></i>'
																	return '<i class="file_icon file_folder"></i>'
															}
														}, {
															title: "名称",
															type: 'text',
															fid: 'fid',
														}, {
															title: "操作结果",
															type: 'text',
															align: 'right',
															template: function (row) {
																return '<span style="color:red">存在被覆盖风险</span>'
															}
														}
													]
												})
											},
											yes: function (index, layers) {
												var loadget = layer.msg('正在提交表单信息，请稍侯...', { icon: 16, time: 0, shade: [0.3, '#000'] });
												$.post('/plugin?action=a&name=rsync&s=' + action, that.setServerForm, function (res) {
													layer.close(loadget);
													if (res.status) {
														layer.close(tsync.set_layer_View);
														tsync.getServerInfo();
														layer.msg(res.msg, { icon: 1 });
														if (!status) that.set_task_key(that.setServerForm.mName)
													} else {
														layer.msg(res.msg, { icon: 2 });
													}
												});
												layer.close(index)
											}
										})
									} else {
										var loadget = layer.msg('正在提交表单信息，请稍侯...', { icon: 16, time: 0, shade: [0.3, '#000'] });
										$.post('/plugin?action=a&name=rsync&s=' + action, that.setServerForm, function (res) {
											layer.close(loadget);
											if (res.status) {
												layer.close(tsync.set_layer_View);
												tsync.getServerInfo();
												layer.msg(res.msg, { icon: 1 });
												if (!status) that.set_task_key(that.setServerForm.mName)
											} else {
												layer.msg(res.msg, { icon: 2 });
											}
										});
									}
								})
							}
						});
						$('.pws').click(function (event) {
							$('input[name="password"]').val(RandomStrPwd(12));
						});
					}
				});
			});
		},
		// 接收端 - 全局配置
		setOverallView: function () {
			$.get('/plugin?action=a&name=rsync&s=get_global_conf', function (rdata) {
				tsync.set_layer_View = layer.open({
					type: 1,
					skin: 'global-class',
					area: '600px',
					title: 'rsync服务器全局配置',
					closeBtn: 2,
					shift: 0,
					shadeClose: false,
					content: "<form class='bt-form pd20 pb70' id='fromServerPath' >\
									<div class='line'>\
										<span class='tname'>监听端口</span>\
										<div class='info-r c4'>\
											<input style='width:60px;margin-right:5px;' class='bt-input-text' type='number' name='port' value='"+ rdata.global['port'] + "' />\
											<span style='color:red'>请将此端口在防火墙和安全组放行，否则发送端无法连接</span>\
										</div>\
									</div>\
									<div class='line'>\
										<span class='tname'>最大连接数</span>\
										<div class='info-r c4'>\
											<input style='width:60px;margin-right:5px;' class='bt-input-text' type='number' name='max_connections' value='"+ rdata.global['max connections'] + "' />\
											<span>请设置合理的最大连接数,过高会增加服务器负载，过低则影响同步效率</span>\
										</div>\
									</div>\
									<div class='line'>\
										<span class='tname'>超时时间</span>\
										<div class='info-r c4'>\
											<input style='width:60px;margin-right:5px;' class='bt-input-text' type='number' name='timeout' value='"+ rdata.global['timeout'] + "' />\
											<span>秒，根据您要同步的文件情况设置，建议设置300-1800之间</span>\
										</div>\
									</div>\
									<div class='line'>\
										<span class='tname'>不压缩的文件</span>\
										<div class='info-r c4'>\
											<input style='width:360px;margin-right:5px;' class='bt-input-text' type='text' name='dont_compress' value='"+ rdata.global['dont compress'] + "' />\
											<span>每个用\",\"隔开</span>\
										</div>\
									</div>\
									<div class='line'>\
										<span class='tname'>IP白名单</span>\
										<div class='info-r c4'>\
											<div class='rsync_set_ip'><textarea class='bt-input-text' rows='3' style='width:250px;height:100px;line-height: 20px;' name='hosts_allow' placeholder='每行添加一个IP地址&#10;使用回车分割IP地址，例如：&#10;192.168.1.1&#10;127.0.0.1'>"+ rdata.global['hosts allow'].replace(/ /g, "\n") + "</textarea></div>\
											<div class='rsync_tip'>只允许IP白名单内的机器与本服务器进行数据同步，每行1个IP地址，若不作IP限制请留空</div>\
										</div>\
									</div>\
									<div class='bt-form-submit-btn'>\
										<button type='button' class='btn btn-danger btn-sm btn-title colseView' onclick='layer.close(tsync.set_layer_View)'>取消</button>\
										<button type='button' class='btn btn-success btn-sm btn-title setViewData'>提交</button>\
									</div>\
								  </form>",
				});
				$('.setViewData').click(function (event) {
					var pdata = {
						port: $("input[name='port']").val(),
						hosts_allow: $("textarea[name='hosts_allow']").val(),
						max_connections: $("input[name='max_connections']").val(),
						dont_compress: $("input[name='dont_compress']").val(),
						timeout: $("input[name='timeout']").val()
					}
					var loadget = layer.msg('正在提交表单信息，请稍侯...', { icon: 16, time: 0, shade: [0.3, '#000'] });
					$.post('/plugin?action=a&name=rsync&s=modify_global_conf', pdata, function (res) {
						layer.close(loadget);
						if (res.status) {
							layer.msg(res.msg, { icon: 1 });
							layer.close(tsync.set_layer_View);
						} else {
							layer.msg(res.msg, { icon: 2 });
						}
					});
				});
			});
		},
		// 接收端 - 删除配置信息
		delServerInfo: function (mName) {
			SafeMessage('删除接收', '即将删除接收[' + mName + '],确定吗？', function () {
				var loadT = layer.msg('正在删除接收[' + mName + '] <img src="/static/img/ing.gif">', { icon: 16, time: 0, shade: [0.3, "#000"] });
				$.post('/plugin?action=a&name=rsync&s=remove_module', { mName: mName }, function (res) {
					layer.close(loadT);
					layer.msg(res.msg, { icon: res.status ? 1 : 2 });
					if (res.status) tsync.getServerInfo();
				});
			});
		},
		// 接收端 - 配置开关
		serverSwitch: function (switchs) {
			var _this = this;
			var title = '';
			if (switchs == undefined) {
				if ($('#switch').is(':checked')) {
					$('.switchText').empty().append('<span style="color:#20a53a">服务已开启</span>');
					$('.restart').show();
					switchs = 'start';
					title = '正在开启服务中，请稍侯...';
				} else {
					$('.switchText').empty().append('<span style="color:red">服务已关闭</span>');
					$('.restart').hide();
					switchs = 'stop';
					title = '正在关闭服务中，请稍侯...';
				}
			} else {
				$('.switchText').empty().append('<span style="color:#20a53a">服务已开启</span>');
				switchs = 'start';
			}
			// layer.load();
			var loadget = layer.msg(title, { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.post('/plugin?action=a&name=rsync&s=rsync_service', { state: switchs }, function (res) {
				layer.close(loadget);
				if (res.status) {
					layer.msg(res.msg, { icon: 1 });
				} else {
					layer.msg(res.msg, { icon: 2 });
				}
			});
		},
		// 获取周期信息
		get_cycle: function (cron) {
			var cycle_str = '';
			if (cron['type'] == 'minute-n') {
				cycle_str = '每隔' + cron['where1'] + '分钟';
			} else {
				cycle_str = '每天' + cron['hour'] + '时' + cron['minute'] + '分';
			}
			return cycle_str;
		},
		// 发送端  - 获取配置信息
		getClientInfo: function () {
			var _this = this, domData = '',receive_data_item = '';
			var loadget = layer.msg('正在获取配置信息...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.get('/plugin?action=a&name=rsync&s=get_send_conf', function (res) {
				layer.close(loadget);
				tsync.conf_data = res
				if (res === false) {
					layer.closeAll();
					layer.msg('未购买【宝塔数据同步工具】插件，或已到期!', { icon: 2 })
					return;
				}
				if (res.status === false) {
					layer.closeAll();
					layer.msg(res.msg, { icon: 2 })
					return;
				}
				// 获取告警通道
				bt_tools.send({url:'config?action=get_msg_configs'},function(rdata){
						var resetChannelMessage = [],prevArray = []
						Object.getOwnPropertyNames(rdata).forEach(function(key) { 
								var mod = rdata[key]
								key == 'wx_account' ? prevArray.push(mod) :resetChannelMessage.push(mod)
						})
						_this.alertListModule = prevArray.concat(resetChannelMessage)
				})

				// 循环所有文件同步总任务
				tsync.rsync_list = res
				for (var i = 0; i < res.length; i++) {
					var receive_data = '',to = '',time_data = '--',modelHTML = 'ssh(' // 子任务行
					var exec_cmd_data = 'onclick="tsync.exec_cmd('+res[i].id+')"', // 同步点击事件 - 单个一对一任务
					target_length = res[i].target_list.length, // 子任务数量
					target_data = res[i].target_list[0] // 子任务

					// 判定子任务书数量是否大于1 
					if(target_length>1){
						receive_data = '<td><span class="overFlowStyle btlink open_item_rsync" data-index="'+i+'" data-length="'+target_length+'">子同步任务数：'+(target_length)+'</span></td>'
					}else{
						// 当链接方式为本地同步
						if (target_data.work_type == 0){
							to = '<a href="javascript:;" onclick="openPath(\'' + target_data.target + '\')" class="btlink" title=\'' + target_data.target + '\'>本地:' + target_data.target + '</a>';
						}else{
							to = '接收服务器:' + target_data.ip + '::' +target_data.name.replace(/(\d+\.){3,3}\d+_/, '');
						}
						// 周期内容
						time_data = (target_data.realtime ? '实时' : tsync.get_cycle(target_data.cron))
						receive_data = '<td><span class="overFlowStyle" style="width:170px" title="'+(target_data.work_type == 0?'':to)+'">'+to+'</span></td>'
					}

					
					// 没有子任务时
					if(target_length == 1){
						if (target_data.work_type == 0) {
							modelHTML = '本地('
						}else if(target_data.work_type == 1){
							modelHTML = '远程('
						}
						exec_cmd_data = 'onclick="tsync.exec_cmd('+res[i].id+',\''+target_data.name+'\')"'
					} 

					// 总任务-整行
					domData += '<tr>\
						<td><span class="overFlowStyle '+(target_length >1?'open_item_rsync':'')+'" data-index="'+i+'" data-length="'+target_length+'" style="width:90px;display:block;height:18px;'+(target_length>1?'cursor:pointer;':'')+'" title="'+ res[i].title + '">' + (target_length >1?'\
							<span  class="select-icon" style="padding-left:10px;margin-right:6px;"></span><span style="width:100%" class="overFlowStyle">'+res[i].title:res[i].title) + '</span></td>\
						<td><span class="overFlowStyle" style="width:130px"><a href="javascript:;" onclick="openPath(\''+ res[i].source + '\')" class="btlink" title="' + res[i].source + '">' + res[i].source + '</a></span></td>\
						'+receive_data+'\
							<td>\
								<input class="btswitch btswitch-ios" id="enable_switch_'+ res[i].id + '" data-id="' + res[i].id + '" type="checkbox" ' + (res[i].status  ? 'checked' : '') + ' onclick="tsync.rsync_task_status(' + res[i].id + ')">\
								<label class="btswitch-btn" for="enable_switch_' + res[i].id + '"  ></label></td>\
							<td style="width:60px">'+(target_length>1?'--':(modelHTML + (res[i].target_list[0].delete? '完全' : '增量')+')'))+'</td>\
							<td style="width:80px">'+time_data+'</td>\
							<td>'+(target_length > 1?'--':target_data.last_status.time)+'</td>\
							<td style="text-align:center">\
								'+(target_length > 1?'--':(target_data.last_status.status?'<span style="color:#20a53a">同步成功</span>':'<span class="rsync_anomaly" data-index="'+i+'" data-type="one" style="color:#ef0808;cursor:pointer;">同步异常</span>'))+'</td>\
							<td style="text-align: right;">\
								<a href="javascript:;" class="btlink" title="立即同步" '+exec_cmd_data+'>同步</a> | \
								<a href="javascript:;" class="btlink" title="查看定时或手动同步的日志" onclick="tsync.methodLogs(\''+ res[i].id + '\',false,\'watch\')">日志</a> | \
								<a href="javascript:;" data-index="'+i+'" class="btlink open_filter">过滤器</a> | \
								<a href="javascript:;" class="btlink edits_rsync" data-index="'+i+'">编辑</a> | \
								<a href="javascript:;" class="btlink" onclick="tsync.delClientInfo(\''+ res[i].id + '\')">删除</a>\
							</td>\
						</tr>';
				}

				$('.clientSide .sideList').empty().append(domData);
				// 点击展开子任务目录
				$('.open_item_rsync').click(function(){
					var tr_index = $(this).parent().parent().index()
					receive_data_item = ''
					var index1 = $(this).data('index'),length = $(this).data('length')
					// 循环渲染子任务
					var res_data = tsync.conf_data
					for(var item = 0;item<res_data[index1].target_list.length;item++){
						var item_data = res_data[index1].target_list[item]
						to = '接收服务器:' + item_data.ip + '::' +item_data.name;
							if (item_data.work_type == 0) {
								to = '<a href="javascript:;" onclick="openPath(\'' + item_data.target + '\')" class="btlink" title="' + item_data.target + '">本地:' + item_data.target + '</a>';
								modelHTML = '本地('
							}else if (item_data.work_type == 1) {
								modelHTML = '远程('
							}
							receive_data_item += '<tr style="background: rgba(245, 247, 250, 0.68);">\
							<td><span class="overFlowStyle" style="width:80px;margin-left:30px" title="'+ item_data.name + '">' + item_data.name + '</span></td>\
							<td><span class="overFlowStyle" style="width:150px;margin-left:10px">\
								<a href="javascript:;" onclick="openPath(\''+ res_data[index1].source + '\')" class="btlink" title="' + res_data[index1].source + '">' + res_data[index1].source + '</a></span></td>\
							<td><span class="overFlowStyle" style="width:170px;margin-left:10px" '+ (item_data.work_type == 0 ? '' : 'title="接收服务器:' + item_data.ip + '::' + item_data.name + '"') + '>' + to + '</span></td>\
							<td><input class="btswitch btswitch-ios" id="enable_switch_'+ item_data.name + '" \
													data-name="' + item_data.name + '" data-id="' + res_data[index1].id + '" type="checkbox" ' + (res_data[index1].status?(item_data.status?'checked' : ''):'') + ' onclick="tsync.rsync_task_status(\'' + item_data.name + '\',true)" >\
								<label class="btswitch-btn" for="enable_switch_' + item_data.name + '"  ></label></td>\
							<td style="width:60px">'+ modelHTML + (item_data.delete? '完全' : '增量') + ')</td>\
							<td style="width:80px">'+ (item_data.realtime ? '实时' : tsync.get_cycle(item_data.cron)) + '</td>\
							<td>'+(item_data.last_status.time)+'</td>\
							<td style="text-align:center">\
								'+(item_data.last_status.status?'<span style="color:#20a53a">同步成功</span>':'<span class="rsync_anomaly_item" data-index="'+index1+'" data-type="more" data-item="'+item+'" style="color:#ef0808;cursor:pointer;">同步异常</span>')+'</td>\
							<td style="text-align: right;">\
								<a href="javascript:;" class="btlink" title="立即同步" onclick="tsync.exec_cmd(\''+ res_data[index1].id + '\',\''+ item_data.name + '\')">同步</a> | \
								<a href="javascript:;" class="btlink" title="查看定时或手动同步的日志" onclick="tsync.methodLogs(\''+ res_data[index1].id + '\',\''+ item_data.name + '\',\'watch\')">日志</a> | \
								<a href="javascript:;" class="btlink" onclick="tsync.delClientInfo(\''+ res_data[index1].id  + '\',\''+ item_data.name  + '\')">删除</a>\
							</td>\
						</tr>';
					}
					// 子任务展开收起
					if($('#task_table tbody tr').eq(tr_index).find('.open_item_rsync').hasClass('active')){
						$('#task_table tbody tr').eq(tr_index).find('.open_item_rsync').removeClass('active')
						for(var k = 0;k<length;k++){
							$('.clientSide .sideList').children().eq(tr_index+1).remove()
						}
						$(this).find('.select-icon-roate').removeClass('select-icon-roate').addClass('select-icon')
						$(this).parent().parent().css({'background':'#fff','border-top':'#ddd solid 0.5px','border-bottom':'#ddd solid 0.5px'})
					}else{
						// 点击展开
						$('.clientSide .sideList').children().eq(tr_index).after(receive_data_item)
						// 展示同步异常信息
						$('.rsync_anomaly_item').click(function(){
							var row_index = $(this).data('index'),type = $(this).data('type'),item = $(this).data('item')
							tsync.show_error_log(row_index,type,function(){
								// 类型为
								$('#anomaly').text(res[row_index].target_list[item].last_status.err_msg)
							})
						})
						$('#task_table tbody tr').eq(tr_index).find('.open_item_rsync').addClass('active')
						$(this).find('.select-icon').removeClass('select-icon').addClass('select-icon-roate')
						$(this).parent().parent().css({'background':'rgba(240, 244, 249, 0.8)','border-top':'#dbdee4 solid 2px','border-bottom':'#dbdee4 solid 2px'})
					}
				})

				// 点击编辑
				$(".edits_rsync").click(function(){
					var item_index = $(this).data('index')
					if(res[item_index].target_list[0].work_type == 0){
						tsync.setClientLocal(res[item_index])
					}else{
						tsync.setClientView(true,tsync.rsync_list[item_index])
					}
				})
				// 点击过滤器
				$('.open_filter').click(function(){
					tsync.blackWhiteList(res[$(this).data('index')].id,$(this).data('index'))
				})

				// 展示密码
				$('.psShow').click(function (event) {
					if ($(this).hasClass('glyphicon-eye-open')) {
						$(this).removeClass('glyphicon-eye-open').addClass('glyphicon-eye-close');
						$(this).prev().text($(this).prev().attr('data-pw'));
					} else {
						$(this).removeClass('glyphicon-eye-close').addClass('glyphicon-eye-open');
						$(this).prev().text('******');
					}
				});
				_this.tableFixed('task_table')
				// 展示同步异常信息
				$('.rsync_anomaly').click(function(){
					var row_index = $(this).data('index'),type = $(this).data('type')
					tsync.show_error_log(row_index,type,function(){
						if(type === 'more'){
							$('#anomaly').text(res[row_index].target_list[$(this).data('item')].last_status.err_msg)
						}else{
							$('#anomaly').text(res[row_index].target_list[0].last_status.err_msg)
						}
					})
				})
			});
		},
		// 同步方法
		exec_cmd: function (id,receiver_name) {
			var loadget = layer.msg('正在发送同步指令...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.post('/plugin?action=a&name=rsync&s=exec_cmd', { send_id: id,receiver_name:receiver_name }, function (res) {
				layer.close(loadget);
				layer.msg(res.msg, { icon: res.status ? 1 : 2 });
			});
		},
		// 展示异常信息
		show_error_log:function(row_index,type,callback){
			layer.open({
				title:'异常信息',
				type:1,
				closeBtn:2,
				area:['1000px'],
				content:'<div><pre class="rsync_anomaly_details" id="anomaly"></pre></div>',
				btn:['关闭'],
				success:function(){
					if(callback) callback()
				}
			})
		},
		// 本地文件夹同步
		setClientLocal: function (data) {
			var aulv = '',alwv = '',real = '',none = '',timing = '',day = '',
			hour = '',minuten = '',open_compress = '',close_compress = '';
			// 同步方式
			if(data){
				if (data && !data.target_list[0].delete) {
					aulv = 'selected ="selected "';
				} else {
					alwv = 'selected ="selected "';
				}
				// 实时定时
				if (data && data.target_list[0].realtime) {
					real = 'selected ="selected"';
					none = 'display:none;';
				} else {
					timing = 'selected ="selected "';
					none = 'display:block;';
				}
				// 定时选择
				if (data && data.target_list[0].cron.type == 'day') {
					day = 'selected ="selected "';
					hour = 'display:block;';
					minuten = 'display:none;';
				} else {
					min = 'selected ="selected "';
					hour = 'display:none;';
					minuten = 'display:block;';
				}
				// 压缩传输
				if (data && data.target_list[0].compress) {
					open_compress = 'selected ="selected "';
				} else {
					close_compress = 'selected ="selected "';
				}
			}
			
			
			this.set_layer_View = layer.open({
				type: 1,
				area: '500px',
				title: '本地文件夹同步任务',
				closeBtn: 2,
				skin:'local_rsync_demo',
				btn:['确认','取消'],
				shift: 0,
				shadeClose: false,
				content: "<form class='bt-form pd20' id='fromServerPath' accept-charset='utf-8'>\
								<div class='line'>\
									<span class='tname'>名称</span>\
									<div class='info-r c4'>\
										<input class='bt-input-text' type='text' name='mName' placeholder='请填写名称,不能有中文或特殊符号' value='"+ (data?data.target_list[0].name:'') + "' style='width:300px;" + (name == '' ? '' : 'background-color:#f1f1f1;') + "' " + (name == '' ? '' : 'readonly') + " />\
									</div>\
								</div>\
								<div class='line'>\
									<span class='tname'>从</span>\
									<div class='info-r c4'>\
										<input id='inputPath' class='bt-input-text mr5' type='text' name='path' value='"+ (data?data.source:'') + "' placeholder='请选择被同步的文件夹' style='width:300px' />\
										<span class='glyphicon glyphicon-folder-open cursor press' onclick='ChangePath(\"inputPath\")'></span>\
									</div>\
								</div>\
								<div class='line'>\
									<span class='tname'>同步到</span>\
									<div class='info-r c4'>\
										<input id='inputPath2' class='bt-input-text mr5' type='text' name='path' value='"+ (data?data.target_list[0].target:'') + "' placeholder='请选择目标文件夹，请确保目标文件夹没有重要文件' style='width:300px' />\
										<span class='glyphicon glyphicon-folder-open cursor press' onclick='ChangePath(\"inputPath2\")'></span>\
									</div>\
								</div>\
								<div class='demo_hr_div'>\
									<span class='btlink form-check-lable other_disposition active'>点击查看，更多配置<span class='select-icon'></span></span>\
								</div>\
								<div class='session_clear hide'>\
							<div class='line rsync_stype'>\
								<span class='tname'>同步方式</span>\
								<div class='info-r c4' style='display: flex;align-items: center;'>\
									<select class='bt-input-text' name='delete' style='width:100px'>\
										<option value='false' "+ aulv + ">增量(推荐)</option>\
										<option value='true' "+ alwv + ">完全</option>\
									</select>\
									<i class='total_tips_sync' style='margin-left:4px'>?</i>\
									<span style='margin-left: 46px;margin-right: 14px;'>限速</span>\
									<div class='plan_hms bt-input-text'>\
												<span><input type='number' name='bwlimit'  min='0' value='"+(data?data.target_list[0].bwlimit:'1024')+"' style='width:50px;margin-right:8px'></span>\
												<span class='name' style='width:33px'>KB</span>\
									</div>\
								</div>\
							</div>\
							<div class='line'>\
										<div class='info-r c4'  style='margin-left:0'>\
											<span class='tname'>压缩传输</span>\
											<select class='bt-input-text' name='compress' style='width:100px'>\
												<option value='true' "+ open_compress + ">开启</option>\
												<option value='false' "+ close_compress + ">关闭</option>\
											</select>\
											<i class='total_tips'>?</i>\
											<span  style='margin-left: 20px;margin-right: 10px;'>同步周期</span>\
										<div class='c4' style='display:inline-block'>\
											<select class='bt-input-text synchronization' name='realtime' style='width:100px'>\
												<option value='true' "+real+">实时同步</option>\
												<option value='false' "+timing+">定时同步</option>\
											</select>\
									</div>\
								</div>\
							</div>\
							<div class='line' id='period_own' style='"+none+" height:45px;'>\
										<span class='tname'>定时周期</span>\
										<div class='info-r c4'>\
											<select class='bt-input-text pull-left mr20' name='period' style='width:100px;'>\
												<option value='day'>每天</option>\
												<option value='minute-n'>N分钟</option>\
											</select>\
											<div class='plan_hms pull-left mr10 bt-input-text hour'>\
												<span><input style='width:36px' type='number' value='"+(data ? data.target_list[0].cron.hour:'0')+"' name='hour' maxlength='2' max='23' min='0' /></span>\
												<span class='name'>小时</span>\
											</div>\
											<div class='plan_hms pull-left mr10 bt-input-text minute'>\
												<span><input style='width:36px' type='number' name='minute' value='"+(data ? data.target_list[0].cron.minute:'0')+"' maxlength='2' max='59' min='0' /></span>\
												<span class='name'>分钟</span>\
											</div>\
											<div class='plan_hms pull-left bt-input-text minute-n'>\
												<span><input style='width:36px' type='number' name='minute-n' value='"+(data ? data.target_list[0].cron.where1:'0')+"' maxlength='2' max='59' min='0' /></span>\
												<span class='name'>分钟</span>\
											</div>\
										</div>\
							</div>\
						</div>\
								<ul class=\"help-info-text c9\">\
									<li>【同步目录】：若不以<code>/</code>结尾，则表示将数据同步到二级目录</li>\
									  <li>【注意】： 此处为服务器内部目录的同步，添加后两个目录即保持实时同步!</li>\
									  <li style='color:red'>【警告】： 目标文件夹将被清空，请仔细检查目标文件夹是否有重要文件!</li>\
								  </ul>\
							  </form>",
						success:function(){
							$('#period_own').hide();
							$('.minute-n').hide()
							// 高级配置事件
							$('.form-check-lable').click(function () {
								if ($(this).hasClass('active')) {
									$(this).removeClass('active');
									$(this).html('点击收起，更多配置<span class="select-icon-roate"></span>')
									$('.session_clear').removeClass('hide')
								} else {
									$(this).addClass('active');
									$(this).html('点击查看，更多配置<span class="select-icon"></span>')
									$('.session_clear').addClass('hide')
								}
							});
							// 同步周期
							$('.synchronization').click(function (event) {
								var selVal = $('.local_rsync_demo .synchronization option:selected').val();
								if (selVal == "false") {
									$('#period_own').show();
								} else {
									$('#period_own').hide();
									$('.local_rsync_demo .hour input,.local_rsync_demo .minute input').val('0');
									$('.local_rsync_demo .minute-n input').val('1');
								}
							});
							// 定时-选项改变
							$('.local_rsync_demo #period_own select').change(function (event) {
								var selVal = $('.local_rsync_demo #period_own select option:selected').val();
								if (selVal == 'day') {
									$('.local_rsync_demo .hour, .local_rsync_demo .minute').show();
									if ($('.local_rsync_demo .hour input').val() == '') $('.local_rsync_demo .hour input,.local_rsync_demo .minute input').val('0');
									$('.local_rsync_demo .minute-n').hide();
								} else {
									$('.local_rsync_demo .hour,.local_rsync_demo .minute').hide();
									$('.local_rsync_demo .minute-n').show();
									if ($('.local_rsync_demo .minute-n input').val() == '') $('.local_rsync_demo .minute-n input').val('1');
								}
							});
						},yes:function(){
							tsync.add_local_sync(data?false:true,data?data:null)
						}
			});
		},
		// 增加本地同步 - 前置判断
		add_local_sync: function (isAdd,data) {
			var that = this,
				pdata = {
							work_type: 0, // 0:本地 1:rsync 2ssh
							target: $("#inputPath2").val(), // ssh 目标文件夹
							name: $("input[name='mName']").val(), // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
							password_file: '',
							ip: '',
							port: 873,
							id: data?data.target_list[0].id:null, // 具体数值
							title: '', // 有的话用户名 
							bwlimit: $('.local_rsync_demo [name="bwlimit"]').val(),
							delete: $('.local_rsync_demo select[name="delete"] option:selected').val() == 'true'?true:false, // 增量同步 true:完全
							archive: true, // 
							compress: $('.local_rsync_demo select[name="compress"] option:selected').val() == 'true'?true:false, // 压缩
							verbose: true,
							password: '', // 密码
							realtime: $('.local_rsync_demo select[name="realtime"] option:selected').val() == 'true'?true:false, // 实时同步
							cron: {
								type: $('.local_rsync_demo select[name="period"] option:selected').val(),
								where1: $('.local_rsync_demo [name="minute-n"]').val(),
								hour: $('.local_rsync_demo [name="hour"]').val(),
								minute: $('.local_rsync_demo [name="minute"]').val(),
								seconds:''
							},
						}
			if (pdata.target == '' || $('.local_rsync_demo #inputPath').val() == '' || pdata.name == '') {
				layer.msg('请填写任务名称、被同步的文件夹、目标文件夹!');
				return;
			}
			if(!isAdd){
				data.target_list[0] = pdata
				data.bwlimit = pdata.bwlimit
				data.compress = data.compress
				data.delete = data.delete
			}else{
				pdata.source = $('.local_rsync_demo #inputPath').val()
			}
			isAdd ? that.add_before_ormodify(pdata, true) : that.set_rsync_task(data,false,function(rdata){
					layer.close(tsync.set_layer_View)
					layer.msg(rdata.msg,{icon:rdata.status?1:2})
			})
		},

		// 发送端 - 设置配置信息(编辑和添加)
		setClientView: function (mName, data) {
			tsync.bymore_tabledata = []
			if(data && data.target_list.length>1){
				tsync.bymore_tabledata = data.target_list
				// tsync.render_ownrsync_table(true)
			}
			var that = this;
				var aulv = '', alwv = '', real = '', timing = '', day = '', min = '', none = '', hour = '', minuten = '', open_compress = '', close_compress = '';
				var status = (mName == false) ? false : true;
				var hr_method = '', hs_method = '';
				var ruleN = '', rulek = '';
				var sshDir = data?data.target_list[0].target:''
				that.setStatus = status;
				if (status) {
					that.setTitle = '编辑同步任务';
					that.setSubmit = '保存';
					if(data && data.target_list.length == 1){
						if(data && data.target_list[0].secret_key){
							rulek = 'selected ="selected "';
						}else{
							ruleN = 'selected ="selected "'
						}
						// 链接方式
						if (data && data.target_list[0].work_type == 1) {
							hr_method = 'selected ="selected "';
						} else if(data && data.target_list[0].work_type == 2) {
							hs_method = 'selected ="selected "';
						}
						// 同步方式
						if (data && !data.target_list[0].delete) {
							aulv = 'selected ="selected "';
						} else {
							alwv = 'selected ="selected "';
						}
						// 实时定时
						if (data && data.target_list[0].realtime) {
							real = 'selected ="selected"';
							none = 'display:none;';
						} else {
							timing = 'selected ="selected "';
							none = 'display:block;';
						}
						// 定时选择
						if (data && data.target_list[0].cron.type == 'day') {
							day = 'selected ="selected "';
							hour = 'display:block;';
							minuten = 'display:none;';
						} else {
							min = 'selected ="selected "';
							hour = 'display:none;';
							minuten = 'display:block;';
						}
						// 压缩传输
						if (data && data.target_list[0].compress) {
							open_compress = 'selected ="selected "';
						} else {
							close_compress = 'selected ="selected "';
						}
					}
				}else{
					that.setTitle = '添加同步任务';
				}
				$.ajaxSettings.async = false
				// 过滤规则
				var option_data = ''
				bt_tools.send({url:'/plugin?action=a&name=rsync&s=get_filters'},function(ress){
					tsync.template_data_list = ress
						//比对数组是否相同
						function arraysEqual(a, b) {
							if (a === b) return true;
							if (a == null || b == null) return false;
							if (a.length !== b.length) return false;
							for (var i = 0; i < a.length; i++) {
								if (!b.includes(a[i])) return false;
							}
							for (var j = 0; j < b.length; j++) {
								if (!a.includes(b[j])) return false;
							}
							return true;
						}
						for(var i = 0;i<ress.length;i++){
							option_data += '<option data-index="'+i+'" '+(data?(arraysEqual(ress[i].template,data.exclude)?'selected':''):'')+'  value="'+ress[i].name+'">'+ress[i].name+'</option>'
						}
				})
				$.ajaxSettings.async = true
				// <div class='tname goFilterConfig'>配置模板</div>\
				tsync.set_layer_View = layer.open({
					type: 1,
					skin: 'demo-class',
					area: '620px',
					title: that.setTitle,
					btn:[that.setSubmit,'取消'],
					closeBtn: 2,
					shift: 0,
					shadeClose: false,
					content: "\
					<div class='tab-nav hide "+(data && data.target_list.length>1?'hide':'')+"'><span class='on'>一对一同步</span><span >一对多同步</span></div>\
					<form class='bt-form' style='padding:12px 20px 20px' id='fromServerPath' accept-charset='utf-8'>\
							<span class='tab-span-hr' style='display:none'>接收端配置</span>\
							<div class='byone_rsync'>\
								<div class='line'>\
									<span class='tname'>连接方式</span>\
									<div class='info-r c4'>\
										<select class='bt-input-text' name='model' style='width:100px' "+ (status ? 'disabled="disabled"' : '') + ">\
											<option value='default.rsync' "+ hr_method + ">推荐(rsync)</option>\
											<option value='default.rsyncssh' "+ hs_method + ">SSH</option>\
										</select>\
										<div class='verify_method_line' style='display:inline-block'>\
											<span style='margin-left: 45px;margin-right: 10px;'>验证方式</span>\
											<select class='bt-input-text' name='conn_type' style='width:100px' "+ (status ? 'disabled="disabled"' : '') + ">\
												<option value='key' "+ rulek + ">密钥</option>\
												<option value='user' "+ ruleN + ">帐号</option>\
											</select>\
										</div>\
									</div>\
								</div>\
								<div class='line ssh_dir_box hide'>\
									<span class='tname'>名称</span>\
									<div class='info-r c4'>\
										<input class='bt-input-text' type='text' name='taskName' placeholder='请输入任务名称' value='"+(data?data.target_list[0].name:'')+"' style='width:310px' />\
									</div>\
								</div>\
								<div class='line conn-user'>\
									<span class='tname'>服务器IP</span>\
									<div class='info-r c4'>\
										<input class='bt-input-text' type='text' name='ip' placeholder='请输入接收服务器IP' "+(data?'disabled':'')+"  value='"+(data?data.target_list[0].ip:'')+"' style='width:160px' />\
										<div class='conn-user' style='display:inline-block'>\
												<span style='width:52px' class='tname'>端口</span>\
												<input class='bt-input-text' type='number' name='u_port' min='0'  value='"+(data?data.target_list[0].port:'873')+"' style='width: 95px;'/>\
										</div>\
									</div>\
								</div>\
								<div class='line conn-key'>\
									<span class='tname'>接收密钥</span>\
									<div class='info-r c4'>\
										<textarea id='mainDomain' class='bt-input-text' name='secret_key' "+(data?'disabled':'')+" style='width:310px;height:76px;line-height:22px' placeholder='此密钥为 接收配置[接收账号] 的密钥'>"+ (data?data.target_list[0].secret_key:'') + "</textarea>\
									</div>\
								</div>\
								<div class='line ssh_dir_box hide'>\
									<span class='tname'>接收目录</span>\
									<div class='info-r c4'>\
										<input id='inputPath2' class='bt-input-text mr5' type='text' name='path' value='"+ sshDir + "' placeholder='请输入需要存放【接收数据】的远程服务器文件夹' style='width:310px' />\
									</div>\
								</div>\
								<div class='line verify_method_line  server_message' style='display:none'>\
									<span class='tname'>服务器信息</span>\
									<div class='info-r c4'>\
										<input disabled id='server_message' class='bt-input-text' style='width:310px' value='"+(data?data.target_list[0].ip:'')+"' placeholder='输入密钥后显示'>\
									</div>\
								</div>\
								<div class='line conn-user'>\
									<span class='tname'>用户名</span>\
									<div class='info-r c4'>\
										<input class='bt-input-text' type='text' name='u_user' min='0'  value='"+ (data ? data.target_list[0].name : '') + "' style='width:310px' />\
									</div>\
								</div>\
								<div class='line conn-user'>\
									<span class='tname'>密码</span>\
									<div class='info-r c4'>\
										<input class='bt-input-text' type='text' name='u_pass' min='0'  value='"+ (data ? data.target_list[0].password  : '') + "' style='width:310px' />\
									</div>\
								</div>\
							</div>\
							<div class='bymore_rsync'>\
								<div id='bymore_rsync_table'>\
								</div>\
								<div class='add_input_rsync hide'>\
									<input name='add_input_rsync' type='text' style='width:551px' placeholder='输入接收端密钥回车，快速添加配置' />\
								</div>\
							</div>\
							<span class='tab-span-hr rsync_disposition_tip' style='display:none'>同步配置</span>\
							<div class='line'>\
								<span class='tname'>同步目录</span>\
								<div class='info-r c4'>\
									<input id='inputPath' class='bt-input-text mr5' type='text' name='path' value='"+(data?data.source:'/www/test/')+"' placeholder='请选择同步目录' style='width:310px' />\
									<span class='glyphicon glyphicon-folder-open cursor press' onclick='ChangePath(\"inputPath\")'></span>\
								</div>\
							</div>\
							<div class='line'>\
									<span class='tname'>排除文件</span>\
									<div class='info-r c4'>\
										<select class='bt-input-text' style='width:310px;' name='filter_template'>\
											"+option_data+"\
										</select>\
										<i class='total_tips_exclude' style='margin-left:4px'>?</i>\
									</div>\
								</div>\
							<div class='line conn-way'>\
									<span class='tname '>同步方式</span>\
									<div class='info-r c4'>\
										<select class='bt-input-text' name='delete' style='width:100px' "+ (status ? 'disabled="disabled"' : '') + ">\
											<option value='false' "+ aulv + ">增量(推荐)</option>\
											<option value='true' "+ alwv + ">完全</option>\
										</select>\
										<i class='total_tips_sync'>?</i>\
											<span style='margin-left: 45px;margin-right: 10px;'>限速</span>\
											<input class='bt-input-text' type='number' name='bwlimit' min='0'  value='"+(data?data.target_list[0].bwlimit:'1024')+"' style='width:100px;margin-right:8px' /> KB\
									</div>\
								</div>\
									<div class='line conn-time'>\
										<span class='tname'>同步周期</span>\
										<div class='info-r c4' style='display:flex'>\
											<select class='bt-input-text synchronization' name='realtime' style='width:100px'>\
												<option value='true' "+real+">实时同步</option>\
												<option value='false' "+timing+">定时同步</option>\
											</select>\
										<div>\
									</div>\
								</div>\
							</div>\
							<div class='line' id='period' style='"+none+" height:45px;'>\
										<span class='tname'>定时周期</span>\
										<div class='info-r c4'>\
											<select class='bt-input-text pull-left mr20' name='period' style='width:100px;'>\
												<option value='day' selected='selected'>每天</option>\
												<option value='minute-n'>N分钟</option>\
											</select>\
											<div class='plan_hms pull-left mr20 bt-input-text hour' >\
												<span><input type='number' name='hour' value='"+(data ? data.target_list[0].cron.hour:'0')+"' maxlength='2' max='23' min='0'></span>\
												<span class='name'>小时</span>\
											</div>\
											<div class='plan_hms pull-left mr20 bt-input-text minute' >\
												<span><input type='number' name='minute' value='"+(data ? data.target_list[0].cron.minute:'0')+"' maxlength='2' max='59' min='0'></span>\
												<span class='name'>分钟</span>\
											</div>\
											<div class='plan_hms pull-left mr 20 bt-input-text minute-n' style='display:none'>\
												<span><input type='number' name='minute-n' value='"+(data ? data.target_list[0].cron.where1:'0')+"' maxlength='2' max='59' min='0'></span>\
												<span class='name'>分钟</span>\
											</div>\
										</div>\
								</div>\
								<div class='demo_hr_div'>\
									<span class='btlink form-check-lable other_disposition active'>点击查看，更多配置<span class='select-icon'></span></span>\
								</div>\
								<div class='session_clear hide'>\
									<div class='line' id='advanced'>\
											<span class='tname'>压缩传输</span>\
											<div class='info-r c4'>\
												<select class='bt-input-text' "+(data?(data.target_list.length == 1?'':'disabled'):'')+" name='compress' style='width:100px'>\
													<option value='true' "+ open_compress + ">开启</option>\
													<option value='false' "+ close_compress + ">关闭</option>\
												</select>\
												<i class='total_tips'>?</i>\
												<span style='margin-left:45px;margin-right:10px'>延迟</span>\
												<input class='bt-input-text' min='0' type='number' name='delay'  value='"+(data?data.delay:'3')+"' style='width:100px' /> 秒<i style='margin-left:4px' class='total_tips_delay'>?</i>\
											</div>\
										</div>\
								</div>\
							<ul class=\"help-info-text c9\" style='margin-left:46px'>\
								<li>【重要说明】：不能用来同步mysql数据库，请使用mysql主从同步插件或其他方式</li>\
							</ul>\
						</form>",
					success: function (index) {
						// var AlwaysMore = true
						// if(!data || (data.target_list && data.target_list.length === 0)){
						// 		// 如果是创建模式，直接打开创建弹窗
						// 		// tsync.open_own_rsync()
						// 		$('button [title="添加接收端配置"]').click()
						// 	}
						// 一对多同步 编辑模式
						if(data && data.target_list.length>1){
							$('.demo-class .tab-nav span').eq(1).addClass('on').siblings().removeClass('on')
							// $('.byone_rsync').hide().siblings().show()
							$('.conn-way,.conn-time,.demo-class #period').hide()
							// tsync.render_ownrsync_table(true)
						}else if(data && data.target_list.length == 1){
							// 一对一
							$('.demo-class .tab-nav span').eq(1).addClass('on').siblings().removeClass('on')
							$('.bymore_rsync').hide()
							$('.byone_rsync').show()
							$('#server_message').text(data.target_list[0].ip)
							$('.tab-span-hr').hide()
							tsync.bymore_tabledata = data.target_list
							if(data.target_list[0].work_type == 2){
								$('.ssh_dir_box').removeClass('hide')
							}
							// tsync.render_ownrsync_table(true)
						}else{
							// 创建模式
							// $('.demo-class .tab-nav span').eq(1).addClass('on').siblings().removeClass('on')
							// $('.byone_rsync').hide().siblings().show()
							// tsync.render_ownrsync_table()
							$('.bymore_rsync').hide()
							$('.demo-class #period').hide()
							// tsync.render_ownrsync_table()
							// $('#mainDomain').focus()
						}

						// 只有1对多
						// $('.demo-class .tab-nav span').eq(1).addClass('on').siblings().removeClass('on')
						// $('.byone_rsync').hide().siblings().show()
						// $('.tab-span-hr').hide()
						// // $('.conn-way,.conn-time,.demo-class #period').hide()
						// if(data&&data.target_list){
						// 	tsync.bymore_tabledata = data.target_list
						// }
						// tsync.render_ownrsync_table(true)



						$(".conn-user").hide();
						// 点击菜单栏
						$('.demo-class .tab-nav span').click(function(){
							$(this).addClass('on').siblings().removeClass('on')
							if($(this).text() === '一对多同步'){
								$('.tab-span-hr').show()
								$('.byone_rsync').hide().siblings().show()
								$('.rsync_disposition_tip').html('同步配置<span class="c9" style="margin-left:8px;font-size:12px">（注意事项：接收端可以单独设置同步配置，如果不设置，则使用以下默认同步配置）</span>')
							}else{
								$('.bymore_rsync').hide().siblings().show() 
								$('.tab-span-hr').hide()
							}
						})
						// 配置模板事件
						$(".goFilterConfig").click(()=>{
							// layer.close(tsync.set_layer_View)
							// $(".filterConfigIndex").click()
							// tsync.getfilterModel();
							tsync.addFilterTemplate(undefined,undefined,true)
							// tsync.getfilterModel()
						})
						// 添加默认接收端事件 回车事件绑定
						$('[name="add_input_rsync"]').on('keyup', function(event) {
								if (event.keyCode == "13") {
									var rsync_key_val = $(this).val()
									if(rsync_key_val == ''){
										layer.msg('请输入接收端密钥')
										return false
									}else{
										try {
											var server_data = atob($(this).val())
											layer.open({
												title:'密钥信息确认',
												btn:['确认','取消'],
												area:[420,360],
												content:'<div>\
													<pre>接收端服务器ip：'+ JSON.parse(server_data).D+'\n接收端目录：'+JSON.parse(server_data).E+'\n端口:'+JSON.parse(server_data).C+'</pre>\
													<div>当前密钥解析到上述信息，是否添加？</div>\
												</div>',
												yes:function(index){
													tsync.default_disposition = {
														work_type: 1, // 0:本地 1:rsync 2ssh
														target: JSON.parse(server_data).E, // ssh 目标文件夹
														name: JSON.parse(server_data).A, // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
														password_file: '', // ignore
														ip: JSON.parse(server_data).D, // 服务器ip
														port: JSON.parse(server_data).C, // 端口
														id: null, 
														title: '', // 有的话用户名 
														bwlimit: 1024, // 限速
														delete: false, // true:完全 false：增量
														archive: true, // ignore
														secret_key:$('[name="add_input_rsync"]').val(),
														compress: true, // 压缩
														isOwn:false,
														verbose: true, // ignore
														password: JSON.parse(server_data).B, // 密码
														realtime: ($('[name="realtime"]').val() == "true"?true:false), // 实时同步
														cron: { // 实时定时
															type: $('[name="period"]').val(),
															where1: $('[name="minute-n"]').val(),
															hour: $('[name="hour"]').val(),
															minute: $('[name="minute"]').val(),
															seconds: '',
														},
													}
													$('[name="add_input_rsync"]').val('')
													function findObject(arr, obj) {
														for (var i = 0; i < arr.length; i++) {
															if (arr[i].name === obj.name) {
																return true;
															}
														}
														return false;
													}
													if(findObject(tsync.bymore_tabledata,tsync.default_disposition)){
														layer.msg('已存在当前接收端密钥相关配置，请将接收数据方【接收配置】的用户名修改后再添加任务!')
														return false
													}
													bt_tools.send({url:'/plugin?action=a&name=rsync&s=check_receiver_conn',data:{sender_data:JSON.stringify(tsync.default_disposition)}},function(rdata){
														if(rdata.status){
															  tsync.bymore_tabledata.push(JSON.parse(JSON.stringify(tsync.default_disposition)))
																// tsync.render_ownrsync_table()
														}
													},'检测状态')
													layer.close(index)
												}
										})
										} catch (error) {
											layer.msg('密钥解析失败')
										}
									}
								}
						});
						// 同步配置改变
						// 同步方式
						$('.demo-class [name="delete"]').change(function(){
							that.default_disposition.delete = $(this).val()
						})
						// 限速
						$('.demo-class [name="bwlimit"]').change(function(){
								that.default_disposition.bwlimit = $(this).val()
						})
						// 压缩
						$('.demo-class [name="compress"]').change(function(){
								that.default_disposition.compress = $(this).val()
						})
						// 高级配置事件
						$('.form-check-lable').click(function () {
							if ($(this).hasClass('active')) {
								$(this).removeClass('active');
								$(this).html('点击收起，更多配置<span class="select-icon-roate"></span>')
								$('.session_clear').removeClass('hide')
							} else {
								$(this).addClass('active');
								$(this).html('点击查看，更多配置<span class="select-icon"></span>')
								$('.session_clear').addClass('hide')
							}
						});
						// 显示提示 -延迟
						var showTips_delay = ''
						$('#advanced .total_tips_delay').hover(function () {
							showTips_delay = setTimeout(function () {
								layer.tips('在延迟时间周期内仅记录不同步，到达周期后一次性同步数据，以节省开销', $('#advanced .total_tips_delay'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTips_delay)
							layer.closeAll('tips');
						})
						// 显示提示 -增量
						var showTips_sync = ''
						$('.total_tips_sync').hover(function () {
							showTips_sync = setTimeout(function () {
								layer.tips('【增量】：数据更改/增加时同步，且只追加和替换文件，接收目录可不为空<br/>【新建增量同步前】：目标服务器已存在同名文件在新建增量同步后会被重命名<br/>\
								【新建增量同步后】：目标服务器新建的同名文件（发送服务器存在此文件）会被覆盖<br/>\
								【完全】：保持两端的数据与目录结构的一致性，会同步删除、追加和替换文件和目录，接收目录必须为空', 
								$('.total_tips_sync'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTips_sync)
							layer.closeAll('tips');
						})
						// 显示提示 -过滤模板
						var showTip_exclude = ''
						$('.total_tips_exclude').hover(function(){
							showTip_exclude = setTimeout(function () {
								layer.tips('【过滤模板】:在模板配置中可设置自己特有的过滤规则，在此选中规则，在同步时，将排除规则中符合条件的文件<br/>【默认模板】:默认排除.upload.tmp，.log，tmp，.temp后缀文件', $('.total_tips_exclude'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTip_exclude)
							layer.closeAll('tips');
						})
						// 显示提示 -压缩
						var showTips = ''
						$('#advanced .total_tips').hover(function () {
							showTips = setTimeout(function () {
								var tip = layer.tips('开启后可减少带宽开销，但会增加CPU开销，如带宽充足，建议关闭此选项', $('#advanced .total_tips'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTips)
							layer.closeAll('tips');
						})
						// 连接方式事件
						$('select[name="model"]').change(function () {
							var _isRsync = $('select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							$('[name="u_port"]').val(_isRsync ? 873 : 22)
							$('#mainDomain').attr('placeholder', _isRsync ? '此密钥为 接收配置[接收账号] 的密钥' : '此密钥为登录SSH终端的密钥')
							if (_isRsync) {
								$('.conn-user').hide()
								$('.ssh_dir_box').addClass('hide');
								$('.verify_method_line').removeClass('hide');
							} else {
								$('.ssh_dir_box').removeClass('hide')
								$('.verify_method_line').addClass('hide');
								if (!status) $("select[name='conn_type']").val('key').change()
								$('[name="u_user"]').val('root')
							}
						});
						// 服务器信息
						$('[name=secret_key]').on('change', function (e) {
							var _isRsync = $('select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							if (!_isRsync) return
							try {
								var ipString = atob($(this).val())
								$('.server_message').show()
								$('#server_message').val(JSON.parse(ipString).D)
							} catch (error) {
								layer.msg('密钥解析失败')
								$('#server_message').val('')
								$('.server_message').hide()
							}
						})
					
						// 连接方式事件 
						$("select[name='conn_type']").change(function () {
							var _isRsync = $('select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							if ($(this).val() == 'key') {
								$(".conn-user").hide();
								$(".conn-key").show();
							} else {
								$(".conn-user").show();
								$(".conn-key").hide();
								$(".server_message").hide()
							}
							if (!_isRsync) $('[name=u_port]').parents('.conn-user').show()
						});

						$('[name=conn_type]').change(); // 默认触发一次
						$('.synchronization').click(function (event) {
							var selVal = $('.synchronization option:selected').val();
							if (selVal == "false") {
								$('#period').show();
							} else {
								$('#period').hide();
								$('.hour input,.minute input').val('0');
								$('.minute-n input').val('1');
							}
						});
						$('#period select').click(function (event) {
							var selVal = $('#period select option:selected').val();
							if (selVal == 'day') {
								$('.hour,.minute').show();
								if ($('.hour input').val() == '') {
									$('.hour input,.minute input').val('0');
								}
								$('.minute-n').hide();
							} else {
								$('.hour,.minute').hide();
								$('.minute-n').show();
								if ($('.minute-n input').val() == '') {
									$('.minute-n input').val('1');
								}
							}
						});

						if(!data || (data.target_list && data.target_list.length === 0)){
							// 如果是创建模式，直接打开创建弹窗
							// tsync.open_own_rsync()
							// $('button [title="添加接收端配置"]').click()
						}
					},
					yes:function(index){
						// 一对1的判断？
						var _model = $('select[name="model"] option:selected').val(); //rsync ,ssh
						var _isRsync = _model == 'default.rsync' ? true : false
						var workType = _isRsync?1:2
						if($('.loacal_or_receive .cur').text() === '本地同步'){
							workType = 0
						}
						// ？
						var rsync_item = {
								work_type: workType, // 0:本地 1:rsync 2ssh
								target: '', // ssh 目标文件夹
								name: '', // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
								password_file: '',
								ip: '',
								port: 873,
								id: null, // 具体数值
								title: '', // 有的话用户名 
								bwlimit: Number($('input[name="bwlimit"]').val()),
								delete: true, // 增量同步 true:非增量
								archive: true, // 
								compress: true, // 压缩
								verbose: true,
								password: '', // 密码
								realtime: true, // 实时同步
								cron: {
									type: 'minute-n',
									where1: '5',
									hour: '',
									minute: '',
									seconds: '',
								},
							},
							// _isMoreRsync = ($('.demo-class .tab-nav').find('.on').text() == '一对一同步'?true:false),
							_isMoreRsync = true,
							server = {
									source: '',// 同步目录
									secret_key: '', // 密钥
									delete: 'true', // 是否完全
									realtime: ($('input[name="realtime"]')=='true'?true:false),// 是否实时
									archive: true,
									compress: true,
									id: null,
									title: '',
									verbose: true,
									bwlimit: Number($('input[name="bwlimit"]').val()),
									binary: '/usr/bin/rsync',
									delay: 5,
									exclude: [
										'/**.upload.tmp',
										'**/*.log',
										'**/*.tmp',
										'**/*.temp',
										'**/*.user.ini',
									],
									target_list:[],
								}
								
							if (!_isRsync) {
								// ssh
								var inputPath2 = $('#inputPath2').val(), taskName = $('[name=taskName]').val();
								if (inputPath2 == '') return layer.msg('请输入需要存放【接收数据】的远程服务器文件夹')
								if (taskName == '') return layer.msg('请输入任务名称')
								rsync_item.target = inputPath2;
								rsync_item.name = taskName;
								rsync_item.ip = $('.demo-class [name=ip]').val()
								rsync_item.port = $('[name=u_port]').val()
								rsync_item.password = $('[name=secret_key]').val()
								if(!rsync_item.ip || !rsync_item.port ) return layer.msg('请输入服务器相关信息！');
							} else {
								// 密钥接收
								rsync_item.ip = $('.demo-class [name=ip]').val()
								server.ip = $('.demo-class [name=ip]').val()
							}

							if ($('input[name="delay"]').val() > -1) {
									server.delay = Number($('input[name="delay"]').val());
							}
							if ($('input[name="bwlimit"]').val() > -1) {
								server.bwlimit = Number($('input[name="bwlimit"]').val());
							}
							if ($('.demo-class #inputPath').val() != '') {
								server.source = $('.demo-class #inputPath').val();
							} else {
								layer.msg('请输入同步目录！');
								return false;
							}

							server.is_backup = false
							server.delete = ($('select[name="delete"] option:selected').val() == 'true'?true:false);
							server.realtime = ($('select[name="realtime"] option:selected').val() == 'true' ? true : false);
							server.compress = ($('select[name="compress"] option:selected').val() == 'true'?true:false);
							server.exclude = tsync.template_data_list[$('select[name="filter_template"] option:selected').data('index')].template;
							
							if (!server.realtime) {
								rsync_item.cron.type = $('select[name="period"] option:selected').val();
								if (rsync_item.cron.type == 'day') {
									rsync_item.cron.hour = $('input[name="hour"]').val();
									rsync_item.cron.minute = $('input[name="minute"]').val();
									if (rsync_item.cron.hour == '' || rsync_item.cron.minute == '') {
										layer.msg('请输入同步时间！');
										return false;
									}
								} else {
									rsync_item.cron.where1 = $('input[name="minute-n"]').val();
									if (rsync_item.cron.where1 == '') {
										layer.msg('请输入同步时间！');
										return false;
									}
								}
							}
							var conn_type = $("select[name='conn_type']").val();
							// 当选择为密钥
							if (conn_type == 'key' && _isMoreRsync) {
								if ($('textarea[name="secret_key"]').val() != '') {
									server.secret_key = $('textarea[name="secret_key"]').val();
										try {
											var ipString = atob($('textarea[name="secret_key"]').val())
											rsync_item.ip  = JSON.parse(ipString).D
											rsync_item.name  = JSON.parse(ipString).A
											rsync_item.password  = JSON.parse(ipString).B
											rsync_item.port  = JSON.parse(ipString).C
											rsync_item.target = JSON.parse(ipString).E
										} catch (error) {
											layer.msg('密钥解析失败')
										}
								} else {
									layer.msg('请输入接收密钥！');
									return false;
								}
							} else if(conn_type == 'user' && _isMoreRsync) {
								// 选择为账号密码
								server.name = $("input[name='u_user']").val();
								server.password = $("input[name='u_pass']").val();
								server.port = $("input[name='u_port']").val();
								server.ip = $("input[name='ip']").val();
								rsync_item.name = server.name
								rsync_item.password = server.password
								rsync_item.port = server.port
								if (!server.name || !server.password || !server.port) {
									layer.msg('请输入帐号、密码、端口信息');
									return false;
								}
							}
							// 编辑模式
							if (status) {
								server.id = data.id
								rsync_item.id = data.target_list[0].id
							}
							// 一对一同步
							if(_isMoreRsync){
								rsync_item.delete = server.delete
								rsync_item.realtime = server.realtime
								rsync_item.compress = server.compress
								rsync_item.bwlimit = server.bwlimit
								rsync_item.secret_key = server.secret_key
								server.target_list.push(rsync_item)
							}else{
								server.target_list = tsync.bymore_tabledata
							}
							// 创建时先二次确认否则为编辑 status true:编辑 
							status ? that.set_rsync_task(server,false,function(rdata){
								layer.msg(rdata.msg,{icon:rdata.status?1:2})
							}) : that.add_before_ormodify(server,false,function(rdata){
							  layer.close(index)
								tsync.getClientInfo()
								layer.msg(rdata.msg,{icon:rdata.status?1:2})
							})
					}
				});
		},
		// 渲染一对多接收端表格
		render_ownrsync_table:function(isEdit){
			var that = this,column = [
						{
							fid: 'ip',
							title: '接收端IP',
							template:function(row){
								return '<span>'+(row.ip?row.ip:(!row.work_type?'本机ip':'--'))+'</span>'
							}
						},{
							fid:'name',
							title: '名称',
							type:'text',
							template:function(row){
								return (
									'<span style="text-overflow: ellipsis;overflow: hidden;width: 52px;display:inline-block"\
									 	title="'+row.name+'">'+row.name+'</span>'
								)
							}
							
						},{
							fid:'target',
							title: '接收目录',
							template:function(row){
								return (
									'<span style="text-overflow: ellipsis;overflow: hidden;width: 160px;display:inline-block"\
									 	title="'+row.target+'">'+row.target+'</span>'
								)
							}
						},{
							fid: 'isOwn',
							title: '配置',
							hide:true,
							type:'text',
							template:function(row){
								return row.isOwn?'自定义':'默认'
							}
						},{
							title: '类型',
							type:'text',
							template:function(row){
								var workType = (row.work_type?(row.work_type === 1?'rsync':'ssh'):'本地')
								 return '<span>'+workType+ '/' +(row.delete?'完全':'增量')+'</span>'
							}
						},
						{
							title: '操作',
							type: 'group',
							align: 'right',
							group: [{
							title: '编辑',
							event: function (row, index, ev, key, that) {
								tsync.open_own_rsync(row)
							}
						},{
							title: '删除',
							event:function(row,index){
								var message = '接收端配置';
								SafeMessage('删除'+message, '即将删除【'+row.name+'】,是否继续操作？', function () {
									tsync.bymore_tabledata.splice(index,1)
									tsync.render_ownrsync_table()
								});
							}
						}]
						},
				]
				if(isEdit){
					for (var i = 0; i < column.length; i++) {
						if (column[i].fid == 'isOwn') {
							column.splice(i,1)
						}
					}
				}
			// 表格部分
			bt_tools.table({
				el:'#bymore_rsync_table',
				data:tsync.bymore_tabledata,
				default:'暂无数据',
				height: 200,
				param:{}, 
				column:column,
				tootls:[
					{
							type: 'group',
							positon: ['left', 'top'],
							list: [{
									title: '添加接收端配置',
									active: true,
									event: function (ev) {
										tsync.open_own_rsync()
									}
							}]
					},]
			})
		},
		// 展开自定义接收端配置设置项
		open_own_rsync:function(row){
			var rsync_server = {}
			layer.open({
					title:'添加接收端配置',
					skin:'open_own_rsync',
					area:'520px',
					closeBtn:2,
					type:1,
					btn:['确定','取消'], 
					content:"<div style='font-size:12px;padding:20px'>\
						<div class='line rsync_type "+(row?'hide':'')+"'>\
							<span class='tname'>同步类型</span>\
							<div class='c4 loacal_or_receive'>\
								<span class='cur' data-name='receive'>接收端同步</span>\
								<span data-name='local'>本地同步</span>\
							</div>\
						</div>\
						<div class='receive_rsync'>\
						<div class='line'>\
							<span class='tname'>连接方式</span>\
							<div class='info-r c4'>\
								<select class='bt-input-text' name='model' "+(row?'disabled':'')+" style='width:100px'>\
									<option value='default.rsync' "+(row?(row.work_type==1?'selected="selected"':''):'selected="selected"')+">推荐(rsync)</option>\
									<option value='default.rsyncssh' "+(row?(row.work_type==2 ?'selected="selected"':''):'')+">SSH</option>\
								</select>\
								<div class='verify_method_line'  style='display:inline-block'>\
									<span style='margin-left: 45px;margin-right: 10px;'>验证方式</span>\
									<select class='bt-input-text' "+(row?'disabled':'')+" name='conn_type' style='width:100px'>\
										<option value='key' "+(row?(row.secret_key ?'selected="selected"':''):'selected="selected"')+">密钥</option>\
										<option value='user' "+(row?(row.secret_key ?'':'selected="selected"'):'')+">帐号</option>\
									</select>\
								</div>\
							</div>\
						</div>\
						<div class='line ssh_dir_box hide'>\
							<span class='tname'>名称</span>\
							<div class='info-r c4'>\
								<input class='bt-input-text' "+(row?'disabled':'')+" value='"+(row?row.name:'')+"' type='text' name='taskName' placeholder='请输入任务名称' value='' style='width:310px' />\
							</div>\
						</div>\
						<div class='line conn-ip'>\
							<span class='tname'>服务器IP</span>\
							<div class='info-r c4'>\
								<input class='bt-input-text' type='text' name='ip' placeholder='请输入接收服务器IP' value='"+(row?row.ip:'')+"' style='width:156px' />\
								<div class='ssh_dir_box hide' style='display:inline-block'>\
									<span style='width:56px' class='tname'>端口</span>\
									<input class='bt-input-text' type='number' style='width: 95px;' name='u_port' min='0'  value='"+(row?row.port:'22')+"'/>\
								</div>\
							</div>\
						</div>\
						<div class='line conn-key'>\
							<span class='tname'>接收密钥</span>\
							<div class='info-r c4'>\
								<textarea "+(row?'disabled':'')+" id='mainDomain_popup' class='bt-input-text' name='secret_key' style='width:310px;height:75px;line-height:22px' placeholder='此密钥为 接收配置[接收账号] 的密钥'></textarea>\
							</div>\
						</div>\
						<div class='line verify_method_line server_message_popup'>\
							<span class='tname'>服务器信息</span>\
							<div class='info-r c4'>\
								<textarea disabled  id='server_message_popup' class='bt-input-text' style='width:310px;height:75px' value='' placeholder='输入密钥后显示'/>\
							</div>\
						</div>\
						<div class='line ssh_dir_box hide'>\
							<span class='tname'>接收目录</span>\
							<div class='info-r c4'>\
								<input id='inputPath2_popup' value='"+(row?row.target:'')+"' class='bt-input-text mr5' type='text' name='path' value='' placeholder='请输入需要存放【接收数据】的远程服务器文件夹' style='width:310px' />\
							</div>\
						</div>\
						<div class='line conn-user'>\
							<span class='tname'>服务器IP</span>\
							<div class='info-r c4'>\
								<input class='bt-input-text' type='text' name='ip' placeholder='请输入接收服务器IP' "+(row?'disabled':'')+"  value='"+(row?row.ip:'')+"' style='width:160px' />\
								<div class='conn-user' style='display:inline-block'>\
										<span style='width:52px' class='tname'>端口</span>\
										<input class='bt-input-text' type='number' name='u_port' min='0'  value='"+(row?row.port:'873')+"' style='width:95px'/>\
								</div>\
							</div>\
						</div>\
						<div class='line conn-user'>\
							<span class='tname'>用户名</span>\
							<div class='info-r c4'>\
								<input "+(row?'disabled':'')+" class='bt-input-text' type='text' name='u_user' min='0'  value='' style='width:310px' />\
							</div>\
						</div>\
						<div class='line conn-user'>\
							<span class='tname'>密码</span>\
							<div class='info-r c4'>\
								<input class='bt-input-text' type='text' name='u_pass' min='0'  value='' style='width:310px' />\
							</div>\
						</div>\
				</div>\
						<div class='demo_hr_div' style='display:none;'>\
							<span class='btlink form-check-lable other_disposition active'>点击查看，更多配置<span class='select-icon'></span></span>\
						</div>\
						<div class='local_rsync hide'>\
							<form class='bt-form' id='fromServerPath' accept-charset='utf-8'>\
							<div class='line'>\
								<span class='tname'>名称</span>\
								<div class='info-r c4'>\
									<input class='bt-input-text' "+(row && !row.work_type ? 'disabled':'')+"  type='text' name='mName' placeholder='请填写名称,不能有中文或特殊符号'  style='width:300px;' />\
								</div>\
							</div>\
							<div class='line'>\
								<span class='tname'>同步到</span>\
								<div class='info-r c4'>\
									<input id='inputPath2_loacal' class='bt-input-text mr5' type='text' name='path'  placeholder='请选择目标文件夹，请确保目标文件夹没有重要文件' style='width:300px' />\
									<span class='glyphicon glyphicon-folder-open cursor press' onclick='bt.select_path(\"inputPath2_loacal\",\"dir\")'></span>\
								</div>\
							</div>\
						</div>\
						<div></div>\
						<div class='demo_hr_div ' style='display:none;'>\
							<span class='btlink form-check-lable other_disposition active'>点击查看，更多配置<span class='select-icon'></span></span>\
						</div>\
						<div class='session_clear'>\
							<div class='line rsync_stype'>\
								<span class='tname'>同步方式</span>\
								<div class='info-r c4' style='display: flex;align-items: center;'>\
									<select class='bt-input-text' name='delete' style='width:100px'>\
										<option value='false' "+(row?(row.delete ?'':'selected="selected"'):'selected="selected"')+">增量(推荐)</option>\
										<option value='true' "+(row?(row.delete ?'selected="selected"':''):'')+">完全</option>\
									</select>\
									<i class='total_tips_sync' style='margin-left:4px'>?</i>\
								<span style='margin-left: 46px;margin-right: 12px;'>限速</span>\
								<div class='plan_hms bt-input-text'>\
									<span>\
										<input type='number' name='bwlimit'  min='0' value='"+(row ?row.bwlimit:'1024')+"' style='width:58px;'/>\
									</span>\
									<span class='name' style='width:33px'>KB</span>\
								</div>\
								</div>\
							</div>\
						</div>\
						<div class='line' id='advanced'>\
							<div class='info-r c4'  style='margin-left:0'>\
								<span  style='margin-left: 32px;margin-right: 16px;'>同步周期</span>\
								<div class='c4' style='display:inline-block'>\
									<select class='bt-input-text synchronization' name='realtime' style='width:100px'>\
										<option value='true' "+(row?(row.realtime ?'selected="selected"':''):'selected="selected"')+">实时同步</option>\
										<option value='false' "+(row?(row.realtime ?'':'selected="selected"'):'')+">定时同步</option>\
									</select>\
								</div>\
								<span style='margin-left:41px;margin-right:10px;'>压缩传输</span>\
								<select class='bt-input-text' name='compress' style='width:100px'>\
									<option value='true' "+(row?(row.compress ?'selected="selected"':''):'selected="selected"')+">开启</option>\
									<option value='false' "+(row?(row.compress ?'':'selected="selected"'):'')+">关闭</option>\
								</select>\
								<i class='total_tips'>?</i>\
							</div>\
						</div>\
						<div class='line' id='period_own' style='height:45px;'>\
							<span class='tname'>定时周期</span>\
							<div class='info-r c4'>\
								<select class='bt-input-text pull-left mr20' name='period' style='width:100px;'>\
									<option value='day' "+(row?(row.cron.type == 'day'?'selected="selected"':''):'selected="selected"')+">每天</option>\
									<option value='minute-n' "+(row?(row.cron.type == 'minute-n'?'selected="selected"':''):'')+">N分钟</option>\
								</select>\
								<div class='plan_hms pull-left mr10 bt-input-text hour'>\
									<span><input style='width:36px' type='number' value='"+(row?row.cron.hour:'0')+"' name='hour' maxlength='2' max='23' min='0' /></span>\
									<span class='name'>小时</span>\
								</div>\
								<div class='plan_hms pull-left mr10 bt-input-text minute'>\
									<span><input style='width:36px' type='number' name='minute' value='"+(row?row.cron.minute:'0')+"' maxlength='2' max='59' min='0' /></span>\
									<span class='name'>分钟</span>\
								</div>\
								<div class='plan_hms pull-left bt-input-text minute-n'>\
									<span><input style='width:36px' type='number' name='minute-n' value='"+(row?row.cron.where1:'0')+"' maxlength='2' max='59' min='0' /></span>\
									<span class='name'>分钟</span>\
								</div>\
							</div>\
						</div>\
						<ul class=\"help-info-text c9\">\
								<li>【同步目录】：若不以<code>/</code>结尾，则表示将数据同步到二级目录</li>\
									<li>【注意】： 此处为服务器内部目录的同步，添加后两个目录即保持实时同步!</li>\
									<li style='color:red'>【警告】： 目标文件夹将被清空，请仔细检查目标文件夹是否有重要文件!</li>\
							</ul>\
						<div style='height:20px;'></div>\
					</div>",
					success:function(){
						$('#period_own,.conn-ip,.open_own_rsync .minute-n,.open_own_rsync .conn-user').hide()
						$('#mainDomain_popup').focus()
						// 编辑模式
						if(row){
							// 密钥模式
							if(row.ip) {
								// $('.conn-ip').show().find('[name=ip]').attr('disabled','disabled')
								$('.conn-ip .ssh_dir_box').removeClass('hide')
							}
							if(row.secret_key){
								// $('.conn-ip').hide()
								$('#mainDomain_popup').val(row.secret_key)
								$('#server_message_popup').val('服务器ip：'+ row.ip +'\n接收端目录：'+ row.target)
							} else if(!row.secret_key){
								$('.open_own_rsync .conn-user').show()
								// $('.conn-ip').hide()
								$('.open_own_rsync .conn-key,.server_message_popup').hide()
								$('.open_own_rsync [name="u_user"]').val(row.name)
								$('.open_own_rsync [name="u_pass"]').val(row.password)
								$('.open_own_rsync [name="ip"]').val(row.ip)
							}
							// ssh 模式
							if(row.work_type == 2){
								$('.open_own_rsync .ssh_dir_box').removeClass('hide')
								$('.open_own_rsync .verify_method_line').addClass('hide')
							} 
							// 本地模式
							if(!row.work_type){
								$('.loacal_or_receive span').eq(1).addClass('cur').siblings().removeClass('cur')
								$('.open_own_rsync .local_rsync').show().removeClass('hide')
								$('.open_own_rsync [name="mName"]').val(row.name)
								$('#inputPath2_loacal').val(row.target)
								$('.open_own_rsync .session_clear').removeClass('hide')
								$('.local_rsync .demo_hr_div,.local_rsync .help-info-text,.open_own_rsync .receive_rsync').hide()
							}	
							// 接收端开启定时模式
							if(!row.realtime){
								$('#period_own').show()
								if(row.cron.type==='minute-n'){
									$('.open_own_rsync .minute-n').show()
									$('.open_own_rsync .hour,.open_own_rsync .minute').hide()
								}
							}else {
								$('#period_own select').val('day')
							}	
							
						}
						$('.server_message_popup').hide()
						// 连接方式事件
						$('.open_own_rsync select[name="model"]').change(function () {
							var _isRsync = $('.open_own_rsync select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							$('.open_own_rsync [name="u_port"]').val(_isRsync ? 873 : 22)
							$('#mainDomain_popup').attr('placeholder', _isRsync ? '此密钥为 接收配置[接收账号] 的密钥' : '此密钥为登录SSH终端的密钥')
							if (_isRsync) {
								$('.open_own_rsync .conn-user,.conn-ip').hide()
								$('.open_own_rsync .ssh_dir_box').addClass('hide');
								$('.open_own_rsync .verify_method_line').removeClass('hide');
								$('.open_own_rsync [name="secret_key"]').val(row?row.secret_key:'');
							} else {
								$('.open_own_rsync .ssh_dir_box').removeClass('hide')
								$('.open_own_rsync .verify_method_line').addClass('hide');
								$('.open_own_rsync [name="secret_key"],.open_own_rsync [name="taskName"],.open_own_rsync [name="path"]').val('');
								$('.open_own_rsync [name="u_user"]').val('root')
								$('.conn-ip').show()
								if (!status) $(".open_own_rsync select[name='conn_type']").val('key').change()
							}
						});

						// 本地同步自动填充名称
						$('#inputPath2_loacal').change(function(){
							var split_data = $(this).val().split('/')
							var file_name = (split_data[split_data.length-1] == ''?split_data[split_data.length-2]:split_data[split_data.length-1])
							var regExp_chinese = new RegExp('[\u4E00-\u9FA5\uFE30-\uFFA0]');
							var regExp_symbol = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>《》/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]");
							if ( !regExp_chinese.test(file_name) && !regExp_symbol.test(file_name) ) {
								$('.open_own_rsync [name="mName"]').val(file_name)
								return 
							}
						})
						// 验证方式事件 
						$(".open_own_rsync select[name='conn_type']").change(function () {
							var _isRsync = $('select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							if ($(this).val() == 'key') {
								$(".open_own_rsync .conn-user").hide();
								$(".open_own_rsync .conn-key,.server_message_popup").show();
							} else {
								$(".open_own_rsync .conn-user").show();
								$(".open_own_rsync .conn-key,.server_message_popup").hide();
							}
						});
						// 高级配置事件
						$('.open_own_rsync .form-check-lable').click(function () {
							if ($(this).hasClass('active')) {
								$(this).removeClass('active');
								$(this).html('点击收起，更多配置<span class="select-icon-roate"></span>')
								$('.open_own_rsync .session_clear').removeClass('hide')
							} else {
								$(this).addClass('active');
								$(this).html('点击查看，更多配置<span class="select-icon"></span>')
								$('.open_own_rsync .session_clear').addClass('hide')
							}
						});
						// 点击本地配置
						$('.loacal_or_receive span').click(function(){
							$(this).addClass('cur').siblings().removeClass('cur')
							var name = $(this).data('name')
							if(name === 'local'){
								$('.open_own_rsync .receive_rsync').hide()
								$('.open_own_rsync .local_rsync').removeClass('hide')
								$('.open_own_rsync .form-check-lable').html('点击查看，更多配置<span class="select-icon"></span>').addClass('active')
							}else{
								$('.open_own_rsync .receive_rsync').show()
								$('.open_own_rsync .local_rsync').addClass('hide')
								$('.open_own_rsync .form-check-lable').html('点击查看，更多配置<span class="select-icon"></span>').addClass('active')
							}
						})
						// 同步周期
						$('.open_own_rsync .synchronization').click(function (event) {
							var selVal = $('.open_own_rsync .synchronization option:selected').val();
							if (selVal == "false") {
								$('#period_own').show();
							} else {
								$('#period_own').hide();
								$('.open_own_rsync .hour input,.open_own_rsync .minute input').val('0');
								$('.open_own_rsync .minute-n input').val('1');
							}
						});
						// 定时
						$('#period_own select').change(function (event) {
							var selVal = $('#period_own select option:selected').val();
							if (selVal == 'day') {
								$('.open_own_rsync .hour, .open_own_rsync .minute').show();
								if ($('.open_own_rsync .hour input').val() == '') $('.open_own_rsync .hour input,.open_own_rsync .minute input').val('0');
								$('.open_own_rsync .minute-n').hide();
							} else {
								$('.open_own_rsync .hour,.open_own_rsync .minute').hide();
								$('.open_own_rsync .minute-n').show();
								if ($('.open_own_rsync .minute-n input').val() == '') $('.open_own_rsync .minute-n input').val('1');
							}
						});
						// 密钥
						$('.open_own_rsync [name=secret_key]').on('change', function (e) {
							var _isRsync = $('.open_own_rsync select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							if (!_isRsync) return
							try {
								var ipString = atob($(this).val())
								$('.server_message_popup').show()
								$('#server_message_popup').val('服务器信息:'+JSON.parse(ipString).D+'\n接收端目录:'+JSON.parse(ipString).E)
							} catch (error) {
								layer.msg('密钥解析失败!')
								$('.server_message_popup').hide()
								$('#server_message_popup').val('')
							}
						})

						// 显示提示 -增量
						var showTips_sync = ''
						$('.open_own_rsync .total_tips_sync').hover(function () {
							showTips_sync = setTimeout(function () {
								layer.tips('【增量】：数据更改/增加时同步，且只追加和替换文件，接收目录可不为空<br/>\
											【新建增量同步前】：目标服务器已存在同名文件在新建增量同步后会被重命名<br/>\
											【新建增量同步后】：目标服务器新建的同名文件（发送服务器存在此文件）会被覆盖<br/>\
											【完全】：保持两端的数据与目录结构的一致性，会同步删除、追加和替换文件和目录，接收目录必须为空', 
											$('.open_own_rsync .total_tips_sync'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTips_sync)
							layer.closeAll('tips');
						})

						// 显示提示 -压缩
						var showTips = ''
						$('.open_own_rsync #advanced .total_tips').hover(function () {
							showTips = setTimeout(function () {
								var tip = layer.tips('开启后可减少带宽开销，但会增加CPU开销，如带宽充足，建议关闭此选项', $('.open_own_rsync #advanced .total_tips'), {
									tips: [1, '#20a53a'],
									time: 0,
								})
							}, 200)
						}, function () {
							clearTimeout(showTips)
							layer.closeAll('tips');
						})
					},
					yes:function(index){
						// 判定重名方法
						function findObject(arr, obj) {
								for (var i = 0; i < arr.length; i++) {
									if (arr[i].name === obj.name) return true;
								}
								return false;
							}
						// 本地
						if($('.open_own_rsync .rsync_type').find('.cur').text() == '本地同步'){
							var mName = $('.open_own_rsync [name="mName"]').val(),
							inputPath2_loacal = $('.open_own_rsync #inputPath2_loacal').val()
							if(!mName || !inputPath2_loacal ){
								return layer.msg('请输入任务名称与同步目录！')
							}else{
								if($('.open_own_rsync [name="period"]').val() === 'minute-n' && $('.open_own_rsync [name="minute-n"]').val()*1 > 60){
									return layer.msg('大于60分钟的定时任务请使用【每天】')
								}
								rsync_server = {
									secret_key:'',
									isOwn:true,
									work_type: 0, // 0:本地 1:rsync 2:ssh
									target: inputPath2_loacal, // ssh 目标文件夹
									name: mName, // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
									password_file: '', // ignore
									ip: '本地同步', // 服务器ip
									port: $('.open_own_rsync [name="u_port"]').val(), // 端口
									id: null, 
									title: '', // 有的话用户名 
									bwlimit: $('.open_own_rsync [name="bwlimit"]').val(), // 限速
									delete: $('.open_own_rsync [name="delete"]').val() == 'true'?true:false, // true:完全 false：增量
									archive: true, // ignore
									compress: $('.open_own_rsync [name="compress"]').val() == 'true'?true:false, // 压缩
									conning:false,
									verbose: true, // ignore
									password: '', // 密码
									realtime: $('.open_own_rsync [name="realtime"]').val() == 'true'?true:false, // 实时同步
									cron: { // 实时定时
										type: $('.open_own_rsync [name="period"]').val(),
										where1: $('.open_own_rsync [name="minute-n"]').val(),
										hour: $('.open_own_rsync [name="hour"]').val(),
										minute: $('.open_own_rsync [name="minute"]').val(),
										seconds:''
									},
								}
								// 编辑接受端数据
								if(row){
									for (var o = 0; o < tsync.bymore_tabledata.length; o++) {
										if (tsync.bymore_tabledata[o].name === row.name) {
											rsync_server.id = tsync.bymore_tabledata[o].id
											tsync.bymore_tabledata[o] = rsync_server
										}
									}
								}else{
									// 新增
									if(findObject(tsync.bymore_tabledata,rsync_server)) return layer.msg('已存在当前接收端密钥相关配置，请将接收数据方【接收配置】的用户名修改后再添加任务!')
								}
								tsync.check_status_rsync(rsync_server,true,function(){
										if(!row) tsync.bymore_tabledata.push(rsync_server)
										// tsync.render_ownrsync_table()
										layer.close(index)
								})
								return
								// bt_tools.send({url:'/plugin?action=a&name=rsync&s=check_receiver_conn',data:{sender_data:JSON.stringify(rsync_server)}},function(rdata){
								// 	if(!row) tsync.bymore_tabledata.push(rsync_server)
								// 	tsync.render_ownrsync_table()
								// },'检测状态')
								// return layer.close(index)
							}
						}
							// 非本地同步部分
							
							var isRsync =  $('.open_own_rsync select[name="model"] option:selected').val() == 'default.rsync' ? true : false
							var isUser = $('.open_own_rsync select[name="conn_type"] option:selected').val()
							var ipString_server = (isRsync && isUser != 'user'?atob($('.open_own_rsync [name=secret_key]').val()):'')
							var model_select = $('.open_own_rsync select[name="model"] option:selected').val(),work_type = (isRsync?1:2),
									delete_select = ($('.open_own_rsync select[name="delete"] option:selected').val() == 'false'?false:true),
									compress_select = ($('.open_own_rsync select[name="compress"] option:selected').val() == 'false'?false:true),
									realtime_select = ($('.open_own_rsync select[name="realtime"] option:selected').val() == 'false'?false:true),
									period_select = $('.open_own_rsync select[name="period"] option:selected').val(),
									dir_name = (!work_type?$('.open_own_rsync #inputPath'):(work_type == 1 && ipString_server?JSON.parse(ipString_server).A:$('.open_own_rsync [name="u_user"]').val()))
							if(work_type == 2){
								dir_name = $('.open_own_rsync [name="taskName"]').val()
								if(dir_name == '') return layer.msg('任务名称不可为空')
							}

							if($('#mainDomain_popup').val() == '' && isUser != 'user') return layer.msg('请输入接收端密钥信息')

							// 当验证方式为账号时
							if ($('.open_own_rsync select[name="conn_type"]').val() !== 'key') {
								if($('.open_own_rsync [name="u_user"]').val() == '' || $('.open_own_rsync [name="u_pass"]').val() == '') return layer.msg('请填写接收端服务器信息')
								if($('.open_own_rsync .conn-user [name="ip"]').val() == ''){
									return layer.msg('请填写目标IP信息')
								}
							} 
							
							if($('.open_own_rsync [name="period"]').val() === 'minute-n' && $('.open_own_rsync [name="minute-n"]').val()*1 > 60){
								return layer.msg('大于60分钟的定时任务请使用【每天】')
							}
							
							rsync_server = {
								secret_key:$('.open_own_rsync [name=secret_key]').val(),
								isOwn:true,
								work_type: work_type, // 0:本地 1:rsync 2:ssh
								target: (work_type==2?$('#inputPath2_popup').val():(ipString_server?JSON.parse(ipString_server).E:'--')), // ssh 目标文件夹
								name: dir_name, // 用户名（用户名） 本地（文件夹名） ssh（任务名称）
								password_file: '', // ignore
								ip: ipString_server?JSON.parse(ipString_server).D:(isRsync?$('.open_own_rsync .conn-user [name="ip"]').val():$('.open_own_rsync .conn-ip [name="ip"]').val()), // 服务器ip
								port:Number(ipString_server?JSON.parse(ipString_server).E:(isRsync?$('.open_own_rsync .conn-user [name="u_port"]').val():$('.open_own_rsync .ssh_dir_box [name="u_port"]').val())), // 端口
								id: null, 
								title: '', // 有的话用户名 
								bwlimit: $('.open_own_rsync [name="bwlimit"]').val(), // 限速
								delete: delete_select, // true:完全 false：增量
								archive: true, // ignore
								compress: compress_select, // 压缩
								conning:false,
								verbose: true, // ignore
								password: ipString_server?JSON.parse(ipString_server).B:$('.open_own_rsync [name="u_pass"]').val(), // 密码
								realtime: realtime_select, // 实时同步
								cron: { // 实时定时
									type: period_select,
									where1: $('.open_own_rsync [name="minute-n"]').val(),
									hour: $('.open_own_rsync [name="hour"]').val(),
									minute: period_select == 'day' ? $('.open_own_rsync [name="minute"]').val() : $('.open_own_rsync [name="minute-n"]').val(),
									seconds: '',
								},
							}
							// 编辑接受端数据
							if(row){
								for (var o = 0; o < tsync.bymore_tabledata.length; o++) {
									if (tsync.bymore_tabledata[o].name === row.name) {
										rsync_server.id = tsync.bymore_tabledata[o].id
										tsync.bymore_tabledata[o] = rsync_server
										layer.close(index)
									}
								}
								// tsync.render_ownrsync_table()
								layer.close(index)
							}else{
								// 新增接受端数据
								if(findObject(tsync.bymore_tabledata,rsync_server)) return layer.msg('已存在当前接收端密钥相关配置，请将接收数据方【接收配置】的用户名修改后再添加任务!')
							}
							// 检查链接
							if(rsync_server.delete){
								if ($('.open_own_rsync select[name="conn_type"]').val() !== 'key') {
									rsync_server.target = rsync_server.ip +'::'+rsync_server.name+'/'
								}
								tsync.check_status_rsync(rsync_server,true,function(){
									if(!row) tsync.bymore_tabledata.push(rsync_server)
										// tsync.render_ownrsync_table()
										layer.close(index)
								})
							}else{
								bt_tools.send({url:'/plugin?action=a&name=rsync&s=check_receiver_conn',data:{sender_data:JSON.stringify(rsync_server)}},function(rdata){
									if(rdata.status){
										if(!row) tsync.bymore_tabledata.push(rsync_server)
										// tsync.render_ownrsync_table()
										layer.close(index)
									}
								},'检测状态')
							}
						// layer.close(index)
					},
			})
		},
 
		// 发送端 - 删除配置信息 
		delClientInfo: function (id,receiver_name) {
			var _this = this,url_data = 'send',message = '同步任务';
			if(receiver_name){
				url_data = 'recv' 
				message = '接收端'
			}
		
			SafeMessage('删除'+message, '即将删除该'+message+',是否继续操作？', function () {
				var loadT = layer.msg('正在删除中...',{icon:16,time:0,shade: [0.3, '#000']});
				$.post('/plugin?action=a&name=rsync&s=remove_'+url_data+'_task',{ send_id: id,receiver_name:receiver_name },function(res){
					layer.close(loadT);
					_this.getClientInfo();
					layer.msg(res.msg,{icon:res.status?1:2})	
				})
			});
		},
		// 发送端 - 获取日志
		methodLogs: function (id,name,type) {
			var that = this,tab_nav = '',
			params = {
				log_type:type,
				send_id:id?id:'',
				receiver_name:name?name:''
			};
			bt_tools.send({url:'/plugin?action=a&name=rsync&s=get_log',data:params},function(ress){
				for(var i = 0;i<ress.length;i++){
					if(!i){
						tab_nav = '<span class="on tab-item" data-name="'+ress[i].name+'">'+ress[i].name+'</span>'
						continue;
					} 
					tab_nav += '<span class="tab-item" data-name="'+ress[i].name+'">'+ress[i].name+'</span>'
				}
				layer.open({
					type:1,
					title:(name?'【'+name+'】':'')+'日志',
					area: ['960px'],
					shadeClose: false,
					skin:'log_demo',
					closeBtn: 2,
					content:'<div class="'+(ress.length <=1 || name?'':'pd20' )+'" >\
							<div class="setchmod bt-form '+(type == 'service'?'hide':'')+'">\
								<div class="tab-group '+(ress.length == 1?'hide':'')+'">\
									'+tab_nav+'\
								</div>\
								<div class="tab-content" style="'+(ress.length == 1?'padding:20px':'margin-left:15px')+'">\
									<div class="tab-nav-border">\
										<span class="on" data-type="watch">同步日志</span>\
										<span data-type="exec">手动执行日志</span>\
									</div>\
									<div class="tab-con" style="padding: 10px 0 0;">\
										<button class="bt-btn btn-sm btn-success refresh_log">刷新日志</button><button class="btn btn-default btn-sm va0 clear_log" style="margin:0 0 10px 10px">清空当前日志</button>\
											<pre id="preLogs" style="margin-bottom: 0;"></pre>\
									</div>\
								</div>\
							</div>\
							<div class="'+(type == 'service'?'':'hide')+'" style="padding:10px;padding-bottom:20px">\
								<button class="bt-btn btn-sm btn-success refresh_log service" style="margin-left:10px">刷新日志</button><button class="btn btn-default btn-sm va0 clear_log" style="margin:10px;">清空当前日志</button>\
								<pre id="preLogs_service" style="margin:0 10px;">'+ress[0].log+'</pre>\
							</div>\
						</div>',
					success:function(index){
						// 获取日志方法
						function get_log_content(name,type,callback){
							params.log_type = type
							params.receiver_name = name
							bt_tools.send({url:'/plugin?action=a&name=rsync&s=get_log',data:params},function(rdata){
								if(callback) callback(rdata)
							},'获取日志')
							// 保持滚动条出现在最底部
							$('#preLogs').scrollTop( $('#preLogs')[0].scrollHeight )
							$('#preLogs_service').scrollTop( $('#preLogs_service')[0].scrollHeight )
						}
						// 点击右侧日志种类
						$('.tab-content .tab-nav-border span').click(function(){
							$(this).addClass('on').siblings().removeClass('on')
							get_log_content($('.tab-group').find('.on').data('name'),$(this).data('type'),function(rdata){
								$('#preLogs').html(rdata[0].log == ''?'当前暂无日志数据':rdata[0].log)
							})
						})
						// 点击左侧菜单
						$('.tab-group .tab-item').click(function(){
							$(this).addClass('on').siblings().removeClass('on')
							var type = $('.tab-content .tab-nav-border').find('.on').data('type')
							get_log_content($(this).data('name'),type,function(rdata){
								$('#preLogs').html(rdata[0].log == ''?'当前暂无日志数据':rdata[0].log)
							})
						})
						if(id){
							$('#preLogs').html(ress[0].log == ''?'当前暂无日志数据':ress[0].log)
						}
						// 清除日志数据
						$('.clear_log').click(function(){
							var log_name = $('.tab-content .tab-nav-border').find('.on').text()
							var re_name = $('.tab-group').find('.on').data('name')
							params.receiver_name = (ress.length > 1?re_name:params.receiver_name)
							layer.confirm('确定删除'+(name?'【'+name+'】':'')+log_name+'日志吗？', { title: '删除日志', icon: 3 }, function () {
								$.post('/plugin?action=a&name=rsync&s=remove_log', params, function (res) {
									if (res.status) {
										$('#preLogs,#preLogs_service').html('当前暂无日志');
										layer.msg(res.msg, { icon: 1 });
									} else {
										layer.msg(res.msg, { icon: 2 });
									}
								});
							});
						})
						// 点击刷新日志
						$(".refresh_log").click(function(){
							var type = $('.tab-content .tab-nav-border').find('.on').data('type'),re_name = $('.tab-group').find('.on').data('name')
							if($(this).hasClass('service')){
								type = 'service'
								re_name = ''
							}
							get_log_content(re_name,type,function(rdata){
								if($(this).hasClass('service')){
									$('#preLogs_service').html(rdata[0].log == ''?'当前暂无日志数据':rdata[0].log)
								}else{
									$('#preLogs').html(rdata[0].log == ''?'当前暂无日志数据':rdata[0].log)
								}
								layer.msg('日志已刷新',{icon:1})
							})
						})
						// 保持滚动条出现在最底部
						$('#preLogs').scrollTop( $('#preLogs')[0].scrollHeight )
						$('#preLogs_service').scrollTop( $('#preLogs_service')[0].scrollHeight )
					},
				})
			},'获取日志')
		},
		// 发送端 - 过滤器模板
		getfilterModel:function(isFromAsynctask){
			var that = this
			bt_tools.table({
					el:'#filter_model',
					url:'/plugin?action=a&name=rsync&s=get_filters',
					default:'暂无数据',
					height: '',
					param:{}, 
					tootls: [
						{ // 按钮组
							type: 'group',
							list: [{
								title: '创建过滤模板',
								active: true,
								event: function (ev) {
									that.addFilterTemplate()
								}
							}]
						},
						{ //分页显示
							type: 'page',
							numberStatus: true, //　是否支持分页数量选择,默认禁用
							jump: true, //是否支持跳转分页,默认禁用
						}],
					column:[
							{
								fid: 'name',
								title: '模板名称',
								type: 'text',
							},
							{
								fid:'template',
								title: '过滤规则',
								type: 'text',
								template:function(row){
									return '<span>'+row.template.join(',')+'</span>'
								}
							},
							{
								title: '操作',
								type: 'group',
								width: 90,
								align: 'right',
								group: [{
									title: '修改',
									event: function (row, index) {
										that.addFilterTemplate(row)
									}
								}, {
									title: '删除',
									event: function (row, index) {
										that.removePortRule(row)
									}
								}]
							},
					],
					success:function(res){
						if(isFromAsynctask&&res&&res.data){
							var ress = res.data
							// var exclude = $('select[name="filter_template"] option:selected').text()
							var option_data = ''
							tsync.template_data_list = ress
							for(var i = 0;i<ress.length;i++){
								option_data += '<option data-index="'+i+'" '+(i==ress.length-1?'selected':'')+'  value="'+ress[i].name+'">'+ress[i].name+'</option>'
							}
							$('.bt-input-text[name="filter_template"]').html(option_data)
						}
						$('#filter_model tbody').find('tr').eq(0).find('td').eq(2).remove()
					}
			})			
		},
		// 删除过滤模板
		removePortRule:function(data){
			var that = this
			bt_tools.send({url:'/plugin?action=a&name=rsync&s=remove_filter_template',data:{template:data.name}},function(rdata){
				layer.msg(rdata.msg,{icon:(rdata.status?1:2)})
				that.getfilterModel()
			},'删除模板')
		},
		// 增加过滤模板
		addFilterTemplate:function(data,exculde,isFromAsynctask){
			var that = this,ruleData = [],copData = []		// 渲染模板规则
			layer.open({
				type: 1,
				title: !data?'创建过滤模板':'修改模板',
				area: ['400px'],
				btn:['保存','取消'],
				shadeClose: false,
				closeBtn: 2,
				content: '<div id="create_pop_data_table">\
                <div style="padding: 17px">\
									<div class="'+(exculde?'hide':'')+' " style="display:flex;align-items:center;">\
										<span class="">模板名称：</span>\
										<input style="width:250px;" class="bt-input-text mr5" type="text" name="template_name" value="" placeholder="请输入模板名称" />\
									</div>\
									<hr/>\
                  <div class="choose">\
                    <div class="left_table">\
                      <div class="choose_database">\
												<div class="wafConf" style="margin: 0 0;">\
													<div style="overflow:hidden;">\
															<input type="text" class="bt-input-text mr5" data-type="exclude" title="例如：/home/www/" placeholder="例如：*.log" style="width:310px;">\
															<button data-type="exclude" class="addRule btn btn-default btn-sm">添加</button>\
															<div class="table-overflow" style="height:200px">\
																<table style="margin-top:10px;width:98%" class="table table-hover BlockList"><tbody></tbody></table>\
															</div>\
													</div>\
													<div>\
														<ul class="help-info-text c9" style="list-style-type:decimal;">\
															<li>排除的文件和目录是指当前目录下不需要同步的目录或者文件</li>\
															<li>如果规则以斜线 <code>/</code>开头，则从头开始要匹配全部</li>\
															<li>如果规则以 <code>/</code>结尾，则要匹配监控路径的末尾</li>\
															<li><code>?</code> 匹配任何字符，但不包括<code>/</code></li>\
															<li><code>*</code> 匹配0或多个字符，但不包括<code>/</code></li>\
															<li><code>**</code> 匹配0或多个字符，可以是<code>/</code></li>\
														</ul>\
													</div>\
												</div>\
                      </div>\
                    </div>\
                    <div></div>\
                  </div>\
                </div>\
            </div>',
				success:function(layero,index){
					if(data && !exculde){
						ruleData = data.template
						copData = JSON.parse(JSON.stringify(data.template))
						$('#create_pop_data_table input[name=template_name]').val(data.name)
						$('input[name=template_name]').attr('disabled',true)
						render_rule(copData)
					}else if(data && exculde){
						ruleData = JSON.parse(JSON.parse(data.exclude))
						copData = JSON.parse(JSON.stringify(JSON.parse(JSON.parse(data.exclude))))
						render_rule(copData)
					}
					// 渲染规则
					function render_rule(rule_arr){
						var rule_html = '';
						for(var i=0;i<rule_arr.length;i++){
							rule_html += '<tr><td width="70%">'+rule_arr[i]+'</td><td style="position:relative" align="right"><a class="btlink delRule">删除</a></td></tr>'
						}
						$('.BlockList tbody').html(rule_html)
						// 点击删除规则
						$('.delRule').click(function(){
							var val = $(this).parent().prev().text();
							copData.splice(copData.indexOf(val),1)
							render_rule(copData)
						})
					}

					// 添加模板规则
					function addRule(val){
							if(copData.indexOf(val) === -1){
								copData.push(val)
							}else{
								layer.msg('此规则已在列表中',{icon:2})
						}
						render_rule(copData)
						$('.addRule').prev().val('')
					}
					// 点击添加规则
					$('.addRule').click(function(){
						var val = $(this).prev().val();
						if(val == ''){
							layer.msg('规则不能为空',{icon:2})
							return false;
						}
						addRule(val)
					})
					// 输入规则判断 
					$('.wafConf input').keyup(function (event) {
						if (event.which == 13) {
							var val = $(this).val();
							if (val == '') {
								layer.msg('当前输入内容为空,请输入');
								return false;
							}
							addRule(val);
						}
					});
				},
				yes:function(index){
					var template_name = $('#create_pop_data_table input[name=template_name]').val();
					if(template_name === '') return layer.msg('请输入模板名称！',{icon:2})
					ruleData = copData
					bt_tools.send({url:'/plugin?action=a&name=rsync&s=add_filter_template',data:{template:template_name,excludes:JSON.stringify(ruleData)}},function(res){
						layer.msg(res.msg,{icon:(res.status)?1:2}) 
						that.getfilterModel(isFromAsynctask)
					},'添加模板')
					layer.close(index)
				},
				cancel:function(){
					ruleData = copData
				},
				btn2:function(){
					ruleData = copData
				}
			});
		},
		/**
		 * @description 渲染文件路径
		 * @param {String} path 路径
		 */
		 renderFilesPath: function (path,$el,callback) {
			if(path[path.length-1]==='/') path = path.slice(0,path.length-1)
			var that = this;
			var html = '';
			var newPath = '';
			var pathArr = [];
			var isLevel = false;
			var isInit = true;
			that.cutPath = path;
			pathArr = path.split('/');
			if (pathArr.length >= 1 && pathArr[0] !== '') pathArr.unshift('');
			if (pathArr.length > 1 && pathArr[1] !== '') {
				var upperPath = (getDirPath(path, false) + '/').replace(/(\/\/)+/g, '/');
				if (pathArr.length > 1) upperPath = upperPath.replace(/\/$/g, '');
				isLevel = true;
				html += '<a class="filescan-nav-item btlink return-btn cut-path" data-path="' + upperPath + '" title="点击返回上一级目录">返回上一级</a>';
			}
			if (pathArr.length > 3) isInit = true;
			for (var i = 0; i < pathArr.length; i++) {
				var element = pathArr[i];
				newPath += '/' + element;
				if (element === '' && i > 0) continue;
				if (i > 1 && i < pathArr.length - 2 && pathArr.length > 3) {
					// if (isInit) html += '<a class="filescan-nav-item" title="部分目录已经省略">...</a><span class="divider">></span>';
					isInit = false;
				} else {
					var isLast = pathArr.length - 1 === i;
					var isFirst = i === 0;
					var currentPath = isFirst ? path : path + newPath;
					var divider = !isLast ? '<span class="divider">></span>' : '';
					var menuPath = isFirst ? '当前目录(' + path + ')' : element;
					currentPath = currentPath.replace(/\/\//g, '/');
					// html +=
					// 	'<a class="filescan-nav-item nowrap ' + (isLevel && !isLast ? 'btlink cut-path' : '') + (isFirst ? ' present' : '') + '" data-path="' + currentPath + '" title="' + currentPath.replaceAll('//','/') + '"></a>' + divider;
				}
			}
			// 获取文件路径
			function getDirPath(path, param) {
				path.replace(/\/$/, '');
				var pathArr = path.split('/');
				if (pathArr.length === 1) return path;
				if (param === -1) pathArr.push(status);
				if (typeof param === 'boolean') pathArr.pop();
				return pathArr.join('/').replace(/(\/)$/, '');
			}
			$el.html(html);
			if(callback) callback()
		},
		// 规则验证
		createRegExpFromRule:function(rule, file) {
			rule = rule.replace(/\./g, '\\.')
			if (rule.startsWith('/')) {
				rule = '^' + rule;
			}
			// 如果规则以 /结尾，则要匹配到的末尾
			if (rule.endsWith('/')) {
				rule = rule + '$';
			}
			// 将规则字符串中的 ? 和 * 转换为正则表达式
			rule = rule.replace(/\?/g, '[^/]').replace(/\*{2}/g, '.*').replace(/\*/g, '[^/]*');
			// 创建正则表达式对象，并应用于待匹配字符串
			var regex = new RegExp(rule);
			return new RegExp(rule)
		},
		match:function(rule, fileStructure) {
			var arr2 = JSON.parse(JSON.stringify(fileStructure))
			var regExp = this.createRegExpFromRule(rule);
			function process(structure, path) {
				path = path || '/';
				for (var i = 0; i < structure.length; i++) {
					var item = structure[i];
					var newPath = path + item.name + (item.isDir ? '/' : '');
					if (item.isDir && item.children) {
						process(item.children, newPath);
					}
					if (regExp.test(newPath)) {
						item.filter = true;
					}
				}
			}
			process(arr2);
			return arr2
		},
		// 全局告警
		setRsyncAlert:function(){
			var alert_message = {},that = this
			bt_tools.send({url:'/push?action=get_push_list'},function(ress){
				// 判定是否为首次
				if(ress.rsync_push){
			     that.alert_message = ress.rsync_push[Object.keys(ress.rsync_push)[0]]
				}else{
					var rsync_data = {
							count: 0,
							cycle: 0,
							id: "",
							index: 0,
							interval: 80,
							key: "",
							module: "",
							module_type: "rsync_push",
							project: "rsync_push",
							push_count: 3,
							status: false,
							tips_list: [],
							title: "文件同步",
							user_info:{},
							type: " ",
							to_user:''
					}
					that.alert_message = rsync_data
				}
					bt_tools.open({
						type: 1,
						title: '设置全局告警',
						area: '520px',
						skin:'tamper-alert-task',
						btn: ['保存', '取消'],
						content: {
								class:'pd15',
								data: alert_message,
								form: [{
										label: '异常告警',
										group: {
											type: 'other',
											name: 'alert_status',
											boxcontent:'<div class="mr10 alert_status_input"  style="vertical-align: middle;display: inline-block;">\
												<input class="btswitch btswitch-ios" type="checkbox"  '+(that.alert_message.status?'checked="true"':'')+'>\
												<label class="btswitch-btn"></label>\
											</div>',
											event:function(){
												that.setAlertStatus()
											}
										}
								},{
										label: '间隔时间',
										group: {
												type: 'number',
												name: 'interval',
												width: '70px',
												value: that.alert_message.interval,
												unit: '秒后再次监控触发条件'
										}
								}, {
										label: '每日推送',
										group: {
												type: 'number',
												name: 'push_count',
												width: '70px',
												value: that.alert_message.push_count,
												unit: '次后停止推送，次日再次监控'
										}
								}, {
										label:'告警方式',
										group: that.switchPushType(that.alert_message)
								},{
										group:{
												type:'help',
												class:'help-line-ul',
												list:[
														'开启异常告警后,文件同步出现异常时将按照上述设置发送告警通知',
												],
												style:{'margin-left':'50px'},
										}
								}]
						},
						success: function(layers) {
							$('.tamper-alert-task .alert_status_input input').prop('checked',that.alert_message.status)
								// 点击安装
								$('.alertInstall').click(function(ev) {
										var type = $(ev.currentTarget).parent('span').siblings('input').attr('name'),
												_config = that.alertListModule.find(function(item) {
														return item.name == type
												})
										switch (type) {
												case 'mail':
														renderMailConfigView(_config)
														break;
												case 'dingding':
												case 'feishu':
												case 'weixin':
														renderAlertUrlTypeChannelView(_config)
														break;
												case 'wx_account':
												case 'sms':
														alertOtherTypeInstall(_config)
														break;
										}
								})
								// 点击切换告警状态
								$('.tamper-alert-task .alert_status_input').click(function(){
									var input = $('.tamper-alert-task .alert_status_input input')
									input.prop('checked',!input.prop('checked'))
								})
						},
						yes:function(formData,indexs){
								if(formData.interval == '' || formData.interval <= 0) return layer.msg('间隔时间不能小于1',{icon:2})
								if(formData.push_count == '' || formData.push_count <= 0) return layer.msg('发送次数不能小于1',{icon:2})
								var eData = $.extend(true,{},{
										interval:Number(formData.interval),
										push_count:Number(formData.push_count)
								}),
								isCheck = []
								$('.tamper-alert-task .module-check').not('.check_disabled').each(function(){
										if($(this).find('input').prop('checked')){
												isCheck.push($(this).find('input').prop('name'))
										}
								})
								eData['module'] = isCheck.join();
								eData['type'] = ' '
								if(!eData['module']){
										layer.msg('请选择一种告警方式。',{icon:2})
										return false
								}
								that.setAlertStatus(that.alert_message)
								bt_tools.send({url:'/push?action=set_push_config',data:{id:Number(Date.now ()),name:'rsync_push',data:JSON.stringify(eData)}},function(res){
										bt_tools.msg(res)
										if (res.status) {
												layer.close(indexs)
										}
								})
						}
				})
			},'获取')
		},
		// 设置告警状态
		setAlertStatus:function(data){
			var that = this
			var status = $('.tamper-alert-task .alert_status_input input').prop('checked')
			bt_tools.send({url:'/push?action=set_push_status',data:{name:'rsync_push',status:status?1:0,id:data.id}},function(res){
				//请求回调
				if(res.status) $('.tamper-alert-task .alert_status_input input').prop('checked',!status)
				layer.msg(res.msg,{icon:res.status?'1':'2'})
			},'设置告警状态')
		},
		/**
		 * @description 告警类型展示内容
		 * @param {Object} formData  表单数据
		 */
			switchPushType:function(formData){
				var _checklist = [],isCheckType = [],accountConfigStatus = false;
				this.alertListModule.forEach(function(mod, i) {
						if(formData.module){
								isCheckType = formData.module.split(',')
						}
						if(mod.name === 'wx_account'){
								if(!$.isEmptyObject(mod.data) && mod.data.res.is_subscribe && mod.data.res.is_bound){
										accountConfigStatus = true   //安装微信公众号模块且绑定
								}    
						} 
						_checklist.push({
								type: 'checkbox',
								name:mod.name,
								class:'module-check '+((!mod.setup || $.isEmptyObject(mod.data))?'check_disabled':((mod.name == 'wx_account' && !accountConfigStatus)?'check_disabled':''))+'',
								style:{'margin-right': '10px'},
								disabled:(!mod.setup || $.isEmptyObject(mod.data))?true:((mod.name == 'wx_account' && !accountConfigStatus)?true:false),
								value:$.inArray(mod.name,isCheckType) >= 0 ?1:0,
								title:(mod.name == 'wx_account'?'<b style="color: #fc6d26;">[推荐]</b>':'')+mod.title+((!mod.setup || $.isEmptyObject(mod.data))?'<span style="color:red;cursor: pointer;" class="alertInstall">[点击安装]</span>':(((mod.name == 'wx_account' && !accountConfigStatus)?'[<a target="_blank" class="bterror alertInstall">未配置</a>]':''))),
								event: function(formData, element, thatE) {
										// thatE.config.form[4].group[i].value = !formData[mod.name]?0:1;
								}
						})
				})
				return _checklist
		},
		// 发送端 - 黑白名单
		blackWhiteList: function (id,index) {
			var _this = this,that = this;
			layer.open({
				type: 1,
				title: '过滤器',
				area: '400px',
				shadeClose: false,
				closeBtn: 2,
				content: '<div class="wafConf">\
									<div style="overflow:hidden;">\
										<fieldset>\
											<legend>排除的文件和目录</legend>\
											<input type="text" class="bt-input-text mr5" data-type="exclude" title="例如：/home/www/" placeholder="例如：*.log" style="width:305px;">\
											<button data-type="exclude" class=" addList btn btn-default btn-sm">添加</button>\
											<div class="table-overflow">\
												<table class="table table-hover BlockList"><tbody></tbody></table>\
											</div>\
										</fieldset>\
									</div>\
									<div>\
										<ul class="help-info-text c9" style="list-style-type:decimal;">\
											<li>排除的文件和目录是指当前目录下不需要同步的目录或者文件</li>\
											<li>如果规则以斜线 <code>/</code>开头，则从头开始要匹配全部</li>\
											<li>如果规则以 <code>/</code>结尾，则要匹配监控路径的末尾</li>\
											<li><code>?</code> 匹配任何字符，但不包括<code>/</code></li>\
											<li><code>*</code> 匹配0或多个字符，但不包括<code>/</code></li>\
											<li><code>**</code> 匹配0或多个字符，可以是<code>/</code></li>\
										</ul>\
									</div>\
								</div>',
			});
			function getIncludeExclude(id) {
				loadT = layer.msg('正在获取数据...', { icon: 16, time: 0, shade: [0.3, '#000'] });
				$.post('/plugin?action=a&name=rsync&s=get_send_conf', function (res) {
					layer.close(loadT);
					var res_data = res[index].exclude
					var list = ''
					for (var i = 0; i < res_data.length; i++) {
						list += '<tr><td width="70%">' + res_data[i] + '</td><td align="right"><a href="javascript:;" class="delList btlink">删除</a></td></tr>';
					}
					$('.wafConf .BlockList tbody').empty().append(list);
				});
			}
			// 获取过滤数据
			getIncludeExclude(id);
			// 增加规则
			function addArgs(id, exclude) {
				loadT = layer.msg('正在添加...', { icon: 16, time: 0, shade: [0.3, '#000'] });
				$.post('/plugin?action=a&name=rsync&s=add_exclude', { send_id: id, exclude: exclude }, function (res) {
					layer.close(loadT);
					if (res.status) {
						getIncludeExclude(id);
						$('.wafConf input').val('');
						layer.msg(res.msg);
					} else {
						layer.msg(res.msg);
					}
				});
			}
			$('.addList').click(function (event) {
				var val = $(this).prev().val();
				if (val == '') {
					layer.msg('当前输入内容为空,请输入');
					return false;
				}
				addArgs(id, val);
			});

			
			$('.wafConf input').keyup(function (event) {
				if (event.which == 13) {
					var val = $(this).val();
					if (val == '') {
						layer.msg('当前输入内容为空,请输入');
						return false;
					}
					addArgs(id, val);
				}
			});

			// 点击删除过滤规则
			$('.wafConf').on('click', '.delList', function (event) {
				var val = $(this).parent().prev().text();
				loadT = layer.msg('正在删除...', { icon: 16, time: 0, shade: [0.3, '#000'] });
				$.post('/plugin?action=a&name=rsync&s=remove_exclude', { send_id: id, exclude: val }, function (res) {
					layer.close(loadT)
					if (res.status) {
						getIncludeExclude(id);
						layer.msg(res.msg);
					} else {
						layer.msg(res.msg);
					}
				});
			});

			// 点击测试规则
			$('.wafConf').on('click', '.testRule', function (event) {
				$(this).parent().parent().css({
					'background-color': 'rgb(241, 249, 243)',
					'box-shadow': 'rgba(201, 201, 201, 0.44) 0px 0px 11px 2px'
				})
				$(this).parent().parent().siblings().css({
					'background-color': '#fff',
					'box-shadow': 'none'
				})
				$('.empty_box_detail').remove()
				$('#result_table').empty()
				// 规则与目录
				var val = $(this).parent().prev().text(),catalogue_file = $('#inputPath_test2').val();
				var params = {
					p: 1,
					showRow: 500,
					path: catalogue_file,
					is_operating: true,
					search: '',
				}
				post_file(val,params)
				// 文件测试栏目
				function post_file(val,params){
					if($('#inputPath_test2').val()[$('#inputPath_test2').val().length-1] == '/')$('#inputPath_test2').val(params.path)
					$.post('/files?action=GetDir',params,function(rdata){
						var allFiles = [],test_result = []
						for(var i=0;i<rdata.DIR.length;i++) allFiles.push({name:rdata.DIR[i].split(';')[0],isDir:true})
						for(var j=0;j<rdata.FILES.length;j++) allFiles.push({name:rdata.FILES[j].split(';')[0],isDir:false})
						
						for(var k = 0;k<allFiles.length;k++){
							if(!that.matchRule(val,allFiles[k].name)){
								test_result.push(allFiles[k])
							}else{
								allFiles[k].ignore = true
								test_result.push(allFiles[k])
							}
						}
						// 渲染 result_table_filter
						bt_tools.table({
							el:'#result_table_filter',
							default:'暂无数据',
							data:test_result,
							height:'364px',
							column:[{
								fid: 'name',
								title: '文件名称',
								align:'left',
								template: function (row, index, ev) {
									return '<span class="'+(row.ignore?'ignore':'')+'"><span class="file-type-icon file_' +(row.isDir ? 'folder' : 'icon') +'"></span>'+row.name+'</span>'
								}
							},{
								title: '操作',
								align:'right',
								template: function (row, index, ev) {
									if(row.isDir && !row.ignore) {
										return '<span class="btlink open_test_file">打开</span>'
									}else if(row.ignore){
										return '<span style="color:red">不同步文件</span>'
									}
									return '<span>不可操作</span>'
								},
								event:function(row){
									var path = $('#inputPath_test2').val() + row.name +'/'
									params.path = path
									post_file(val,params)
									that.renderFilesPath(params.path,$('#fileScanPath2'))
								}
							}],
							success:function(layero,index){
								that.renderFilesPath(params.path,$('#fileScanPath2'))
								$('.return-btn').click(function(){
									params.path = $(this).data('path') +'/'
									post_file(val,params)
								})
							}
						})
					})
				}
			})
		},
		// 发送任务二次确认
		/**
		 * localDeleteStatus 本地任务创建（完全同步）
		 **/
		add_before_ormodify: function (data, localDeleteStatus,callback) {
			var that = this;
			if(localDeleteStatus){
				tsync.check_status_rsync(data)
			}else{
				data.target_list[0].source = data.source
				tsync.check_status_rsync(data.target_list[0],true,function(){
					bt_tools.send({url:'/plugin?action=a&name=rsync&s=add_send_task',data:{data:JSON.stringify({sender_data:data,check_connection:true})}},function(ress){
						if(callback) callback(ress)
					},'添加')
				})
			}
		},
		
		// 检查本地链接
		check_status_rsync:function(data,unlocal,callback){
			var load = layer.msg('正在检查中...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			var that = this
			if(data.target[data.target.length-1] != '/') data.target = data.target + '/'
			$.post('/plugin?action=a&name=rsync&s=check_receiver_conn', {sender_data:JSON.stringify(data)}, function (res) {
				if(!res.status) return layer.msg(res.msg,{icon:2})
				var isDelete = data.delete ?true:false // 判断是否为完全模式
				var Executable = isDelete && res.have_file; // 为收完全同步且接端有文件  不可以同步
				var dirString = $('#inputPath2').val(),send_path = $('#inputPath').val()
				if(data.target.indexOf('::')>0) dirString = data.target
				if(typeof res.have_file == 'undefined'){
					Executable = isDelete && !res.status
				}
				var mysql = '', params = {
					isDelete:isDelete,
					Executable:Executable,
					dirString:dirString,
					send_path:send_path,
					target:data.target
				}
				if(unlocal){
					$.post('/plugin?action=a&name=rsync&s=check_dir_status', { path: data.source }, function (sdata) {
						if (sdata.isMysqlData) mysql = 'mysql'
						params.mysql = mysql
						params.Executable = false
						layer.close(load)
						tsync.open_check_popup(params,data,unlocal,callback)
					})
				}else{
					$.post('/plugin?action=a&name=rsync&s=check_dir_status', { path: data.target }, function (rdata) {
						var mysql = ''
						$.post('/plugin?action=a&name=rsync&s=check_dir_status', { path: data.source }, function (ddata) {
							layer.close(load)
							if (ddata.isMysqlData) mysql = 'mysql'
							params.mysql = mysql
							tsync.open_check_popup(params,data,unlocal,callback)
						})
						// <span class="click-link '+(unlocal?'hide':'')+'" id="change_send" >修改</span>
					})
				}
				
			})
		},
		// 打开链接弹窗
		open_check_popup:function(params,data,unlocal,callback){
			var isDelete,Executable,mysql,send_path,dirString,target;
			isDelete = params.isDelete
			Executable = params.Executable
			send_path = params.send_path
			mysql = params.mysql
			dirString = params.dirString
			target = params.target
			layer.open({
						type: 1,
						title: '【' + (isDelete ? '完全' : '增量') + '同步】方向确认',
						closeBtn: 2,
						area: '746px',
						shadeClose: false,
						btn: Executable ? false : mysql == 'mysql'?false:['执行同步'],
						content: '\
						<div class="sync-direction-box">\
							<div class="sync-info">\
								<div class="send-info info-box">\
									<div class="info-tit">发送数据方</div>\
									<div class="info-body">\
										<div class="head">\
											<div class="icon"></div>\
											<div class="info">\
												<div style="display:flex;align-items:center"><p title="'+ send_path +'">目录:' + send_path + '</p></div>\
											</div>\
										</div>\
										<div class="status">\
											<div class="success">配置正常</div>\
										</div>\
									</div>\
								</div>\
								<div class="info-icon success">\
									<div class="icon"></div>\
									<div class="name"><div class="icon_waring"></div>' + (isDelete ? '完全' : '增量') + '同步</div>\
								</div>\
								<div class="receive-info info-box">\
									<div class="info-tit">接收数据方</div>\
									<div class="info-body">\
										<div class="head">\
											<div class="icon"></div>\
											<div class="info">\
												<div style="display:flex;align-items:center"><p title="'+ dirString +'">目录:' + (dirString?dirString:target) + '</p></div>\
											</div>\
										</div>\
										<div class="status">\
											<div class="success">配置正常</div>\
										</div>\
									</div>\
								</div>\
							</div>\
						</div>',
						success: function ($layer, index) {
							// 完全同步
							if (Executable || mysql == 'mysql') {
								$('.sync-direction-box .sync-info .info-icon').removeClass('success').addClass('error');
								if(Executable) $('.receive-info .status').html('<div class="error">完全同步模式下，接收目录必须为空，否则会导致目录下已有数据丢失</div>');
								if(mysql == 'mysql') $('.send-info .status').html('<div class="error">当前发送目录为mysql数据存储目录，同步会导致数据库出现异常</div>');
								$('.sync-direction-box').append('<div class="package-list">\
									<div class="tip_problem">\
									<p style="margin-bottom:10px"><span style="color:#333;font-weight: bold">请手动解决以下问题后</span></p>\
									</div>\
									<button class="link-button">点击重新检测同步状态</button>\
								</div>');
							}
							if(Executable && mysql == ''){
								$('.sync-direction-box .tip_problem').append('<p>问题一：请备份当前接收数据目录数据然后清空接收目录，或重新选择接收数据目录</p>')
							}else if(!Executable && mysql == 'mysql'){
								$('.sync-direction-box .tip_problem').append('<p>问题一：mysql数据库存储目录为特殊目录，无法使用文件同步的方式进行同步，请使用mysql主从同步插件或其他方式</p>')
							}else if(Executable && mysql == 'mysql'){
								$('.sync-direction-box .tip_problem').append('<p>问题一：mysql数据库存储目录为特殊目录，无法使用文件同步的方式进行同步，请使用mysql主从同步插件或其他方式</p><p>问题二：请备份当前接收数据目录数据然后清空接收目录，或重新选择接收数据目录</p>')
							}

							$('#change_receive').click(function () {
								ChangePath("inputPath2")
								layer.close(index)
							})
							$('#change_send').click(function () {
								ChangePath("inputPath")
								layer.close(index)
							})
							$('.link-button').click(function () {
								layer.close(index)
								if(unlocal){
									tsync.check_status_rsync(data,unlocal,callback)
								}else{
									tsync.add_before_ormodify(data, true)
								}
								
							})
						},
						yes: function (layers) {
							// 创建任务（后端自动同步）
							if(unlocal){
								layer.close(layers)
								if(callback) callback()
								return
							}
							var params_data = {
								source: $('.local_rsync_demo #inputPath').val(), // 1 同步目录
								binary: '/usr/bin/rsync',
								delay: 5,
								exclude: [
									'/**.upload.tmp',
									'**/*.log',
									'**/*.tmp',
									'**/*.temp',
									'**/*.user.ini',
								],
								bwlimit: 1024,
								delete: true,
								archive: true,
								compress: true,
								id: null,
								title: '',
								verbose: true,
								target_list: []
							}
							params_data.target_list.push(data)
							tsync.set_rsync_task(params_data,true, function (task) {
								if (task.status) {
									layer.msg(task.msg,{icon:task.status?'1':'2'})
									layer.close(layers)
									layer.close(tsync.set_layer_View)
								}
							})
						}
					})
		},
		// 发送任务编辑保存
		set_rsync_task: function (data,localDeleteStatus, callback) {
			var params = {
				sender_data:data,
				check_connection:true
			},url = '/plugin?action=a&name=rsync&s=modify_send_task'
			if(localDeleteStatus) {
				url = '/plugin?action=a&name=rsync&s=add_send_task'
			}
			var loading = layer.msg('如同步文件数量众多或网络不稳定，可能需要几分钟时间，请稍侯...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.post(url, {data:JSON.stringify(params)}, function (rdata) {
				layer.close(loading);
				layer.msg(rdata.msg, { icon: rdata.status ? 1 : 2 });
				if (rdata.status) {
					tsync.getClientInfo();
				}
				if (callback) callback(rdata)
			});
		},
		// 打开接收方密钥
		set_task_key: function (name) {
			$.post('/plugin?action=a&name=rsync&s=get_secretkey', { mName: name }, function (res) {
				this.set_layer_View = layer.open({
					type: 1,
					area: '500px',
					title: '接收密钥',
					closeBtn: 2,
					shift: 0,
					shadeClose: false,
					content: "<div class='pd20'>\
							<textarea class='form-control' rows='4' readonly='readonly'>"+ res + "</textarea>\
							<button type='submit' class='btn btn-success btn-sm btn-copy-key mtb15' data-clipboard-text='"+ res + "'>复制密钥</button>\
							<ul class='c7' style='line-height:22px;'>\
								<li>复制当前密钥前往【发送数据】的机器中创建发送任务，粘贴至【接收密钥】中。</li>\
							</ul>\
							</div>",
					success: function () {
						var clipboard = new ClipboardJS('.btn-copy-key');
						clipboard.on('success', function (e) {
							bt.msg({
								status: true,
								msg: '复制成功！'
							});
							e.clearSelection();
						});
						clipboard.on('error', function (e) {
							bt.msg({
								status: false,
								msg: '复制失败，请手动复制地址'
							});
						});
					}
				});
			});
		},
		// 同步任务状态开启关闭 isitem:是否是子任务 true 是
		rsync_task_status: function (index,isItem) {
			var ev = $('#enable_switch_' + index), _check = ev.prop('checked'), _id = ev.data('id'),_name = ev.data('name');
			var loading = layer.msg('正在' + (_check ? '开启' : '暂停') + '同步任务中,请稍侯...', { icon: 16, time: 0, shade: [0.3, '#000'] });
			$.post('/plugin?action=a&name=rsync&s=start_stop_task', { exec_action: _check ? 'start' : 'stop', send_id: _id,receiver_name:isItem?_name:'' }, function (res) {
				layer.close(loading);
				layer.msg(res.msg, { icon: res.status ? 1 : 2 });
				
				if (!res.status) {
					$('#enable_switch_' + index).prop('checked', !_check)
					return
				}
				// 是主任务且子任务大于1时
				if(!isItem){
					// 循环任务列表 找到当前点击对象
					for (var i = 0; i < tsync.conf_data.length; i++) {
						if (tsync.conf_data[i].id === _id) {
							if(tsync.conf_data[i].target_list.length>1){
								// 循环改变子任务状态
								for(var j = 0;j<tsync.conf_data[i].target_list.length;j++){
									var item = tsync.conf_data[i].target_list[j]
									item.status = Boolean(_check)
									$('#enable_switch_' + item.name).prop('checked', _check)
								}
							}
							break;
						}
					}
				}else{
					// 是子任务时，改变子任务的父任务状态
					// 开启关闭时都判断父任务的其他子元素状态
					for (var i = 0; i < tsync.conf_data.length; i++) {
						if (tsync.conf_data[i].id === _id) {
							// 循环子元素 当开关开启时改变父元素状态
							if(_check){
								$('#enable_switch_' + tsync.conf_data[i].id).prop('checked', _check)
								break
							}
						}
					}
				}
			})
		},
	}
	tsync.initial();
</script>